Metadata-Version: 2.4
Name: waha
Version: 1.0.5
Summary: Python package for WAHA (WhatsApp HTTP API)
Project-URL: Homepage, https://github.com/devlikeapro/waha-python
Project-URL: Documentation, https://waha.devlike.pro
Project-URL: Repository, https://github.com/devlikeapro/waha-python
Project-URL: Bug Tracker, https://github.com/devlikeapro/waha-python/issues
Project-URL: Changelog, https://github.com/devlikeapro/waha-python/blob/main/CHANGELOG.md
Author-email: Majid Al-Raimi <majidsraimi@gmail.com>
License-Expression: MIT
License-File: LICENSE
Keywords: api,chatbot,messaging,sdk,waha,whatsapp
Classifier: Development Status :: 4 - Beta
Classifier: Intended Audience :: Developers
Classifier: License :: OSI Approved :: MIT License
Classifier: Operating System :: OS Independent
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.8
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Classifier: Topic :: Communications :: Chat
Classifier: Topic :: Internet :: WWW/HTTP
Classifier: Topic :: Software Development :: Libraries :: Python Modules
Classifier: Typing :: Typed
Requires-Python: >=3.8
Requires-Dist: httpx<1.0.0,>=0.24.0
Requires-Dist: pydantic<3.0.0,>=2.0.0
Provides-Extra: dev
Requires-Dist: black>=23.0.0; extra == 'dev'
Requires-Dist: flake8>=6.0.0; extra == 'dev'
Requires-Dist: isort>=5.12.0; extra == 'dev'
Requires-Dist: mypy>=1.0.0; extra == 'dev'
Requires-Dist: pre-commit>=3.0.0; extra == 'dev'
Requires-Dist: pytest-asyncio>=0.20.0; extra == 'dev'
Requires-Dist: pytest-cov>=4.0.0; extra == 'dev'
Requires-Dist: pytest>=7.0.0; extra == 'dev'
Provides-Extra: docs
Requires-Dist: mkdocs-material>=8.0.0; extra == 'docs'
Requires-Dist: mkdocs>=1.4.0; extra == 'docs'
Requires-Dist: mkdocstrings[python]>=0.20.0; extra == 'docs'
Provides-Extra: examples
Requires-Dist: pillow>=9.0.0; extra == 'examples'
Requires-Dist: python-dotenv>=1.0.0; extra == 'examples'
Description-Content-Type: text/markdown

# WAHA - Python

[![PyPI version](https://badge.fury.io/py/waha.svg)](https://badge.fury.io/py/waha)
[![Python versions](https://img.shields.io/pypi/pyversions/waha.svg)](https://pypi.org/project/waha/)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Tests](https://github.com/devlikeapro/waha-python/workflows/tests/badge.svg)](https://github.com/devlikeapro/waha-python/actions)

A comprehensive Python package for the **WAHA (WhatsApp HTTP API)** service. This package provides a clean, type-safe, and easy-to-use interface for interacting with WhatsApp through the WAHA API.

## üåü Features

- **üîÑ Full API Coverage**: Complete implementation of all WAHA API endpoints
- **‚ö° Async & Sync Support**: Both synchronous and asynchronous operation modes
- **üõ°Ô∏è Type Safety**: Full typing with Pydantic models for request/response validation
- **üéØ Organized Namespaces**: Intuitive organization by functionality (auth, sessions, messages, etc.)
- **üìù Rich Documentation**: Comprehensive docstrings and examples
- **üß™ Well Tested**: Extensive test coverage with pytest
- **üêç Modern Python**: Support for Python 3.8+ with modern async/await patterns

## üöÄ Quick Start

### Installation

```bash
pip install waha
```

### Basic Usage

```python
from waha import WahaClient

# Initialize the client
client = WahaClient(
    base_url="http://localhost:3000",
    api_key="your-api-key"  # Optional, can use WAHA_API_KEY env var
)

# Start a session
session = client.sessions.start("default")

# Send a text message
message = client.messages.send_text(
    session="default",
    chat_id="1234567890@c.us",
    text="Hello from WAHA! üëã"
)

print(f"Message sent: {message.id}")
```

### Async Usage

```python
import asyncio
from waha import AsyncWahaClient

async def main():
    async with AsyncWahaClient(
        base_url="http://localhost:3000",
        api_key="your-api-key"
    ) as client:
        # Start a session
        session = await client.sessions.start("default")
        
        # Send a message
        message = await client.messages.send_text(
            session="default",
            chat_id="1234567890@c.us",
            text="Hello from async WAHA! üöÄ"
        )
        
        print(f"Message sent: {message.id}")

asyncio.run(main())
```

## üìö Documentation

### Core Components

The SDK is organized into several namespaces, each handling a specific area of functionality:

#### üîë Authentication (`client.auth`)

Handle QR code authentication and phone verification:

```python
# Get QR code for authentication
qr_code = client.auth.get_qr_code("default", format="raw")
print(f"QR Code: {qr_code.qr}")

# Request authentication code
client.auth.request_code("default", phone_number="+1234567890")
```

#### üñ•Ô∏è Sessions (`client.sessions`)

Manage WhatsApp sessions:

```python
# Create and start a session
session = client.sessions.create("my-session", start=True)

# List all sessions
sessions = client.sessions.list()

# Get session info
info = client.sessions.get("default")

# Stop a session
client.sessions.stop("default")

# Get authenticated account info
me = client.sessions.get_me("default")
print(f"Logged in as: {me.pushName} ({me.id})")
```

#### üì§ Messages (`client.messages`)

Send various types of messages:

```python
# Send text message
client.messages.send_text(
    chat_id="1234567890@c.us",
    text="Hello! üëã",
    reply_to="message_id_to_reply_to"  # Optional
)

# Send image
client.messages.send_image(
    chat_id="1234567890@c.us",
    file="https://example.com/image.jpg",
    caption="Check this out!"
)

# Send document
client.messages.send_file(
    chat_id="1234567890@c.us",
    file="https://example.com/document.pdf",
    caption="Important document"
)

# Send location
client.messages.send_location(
    chat_id="1234567890@c.us",
    latitude=40.7128,
    longitude=-74.0060,
    title="New York City"
)

# Send contact
from waha.types import ContactVcard

contact = ContactVcard(
    fullName="John Doe",
    phoneNumber="+1234567890",
    email="john@example.com"
)
client.messages.send_contact_vcard(
    chat_id="1234567890@c.us",
    contacts=[contact]
)

# Send poll
client.messages.send_poll(
    chat_id="1234567890@c.us",
    poll_text="What's your favorite color?",
    options=["Red", "Green", "Blue", "Yellow"]
)

# Send buttons
buttons = [
    {"id": "btn1", "title": "Option 1"},
    {"id": "btn2", "title": "Option 2"},
]
client.messages.send_buttons(
    chat_id="1234567890@c.us",
    text="Choose an option:",
    buttons=buttons
)

# React to a message
client.messages.react(
    message_id="some_message_id",
    reaction="üëç"
)

# Forward a message
client.messages.forward_message(
    message_id="source_message_id",
    chat_id="target_chat_id"
)
```

#### üí¨ Chats (`client.chats`)

Manage chats and retrieve messages:

```python
# List chats
chats = client.chats.list(limit=50)

# Get messages from a chat
messages = client.chats.get_messages(
    chat_id="1234567890@c.us",
    limit=100
)
```

#### üë§ Contacts (`client.contacts`)

Manage contacts:

```python
# Check if a number exists on WhatsApp
result = client.contacts.check_exists("+1234567890")
if result.numberExists:
    print(f"Number exists! Chat ID: {result.chatId}")
```

#### üÜî Profile (`client.profile`)

Manage your WhatsApp profile:

```python
# Get profile info
profile = client.profile.get()
print(f"Name: {profile.name}, Status: {profile.status}")

# Update profile name
client.profile.set_name("New Name")

# Update profile status
client.profile.set_status("Available")

# Set profile picture
client.profile.set_picture("https://example.com/avatar.jpg")
```

#### üë• Groups (`client.groups`)

Manage WhatsApp groups:

```python
# Create a group
group = client.groups.create(
    name="My Group",
    participants=["1234567890@c.us", "0987654321@c.us"]
)

# Add participants
client.groups.add_participants(
    group_id="group_id@g.us",
    participants=["newuser@c.us"]
)
```

### üîß Configuration

#### Environment Variables

You can configure the SDK using environment variables:

```bash
export WAHA_URL="http://localhost:3000"
export WAHA_API_KEY="your-api-key"
```

#### Client Configuration

```python
client = WahaClient(
    base_url="http://localhost:3000",
    api_key="your-api-key",
    timeout=30.0,  # Request timeout in seconds
    headers={"Custom-Header": "value"}  # Additional headers
)
```

### üìÅ File Handling

The SDK supports multiple ways to handle files:

#### Using URLs

```python
client.messages.send_image(
    chat_id="1234567890@c.us",
    file="https://example.com/image.jpg"
)
```

#### Using Base64

```python
from waha.types import Base64File

file = Base64File(
    mimetype="image/jpeg",
    filename="image.jpg",
    data="base64_encoded_data_here"
)

client.messages.send_image(
    chat_id="1234567890@c.us",
    file=file
)
```

#### Using URLFile Objects

```python
from waha.types import URLFile

file = URLFile(
    url="https://example.com/image.jpg",
    filename="custom_name.jpg"
)

client.messages.send_image(
    chat_id="1234567890@c.us",
    file=file
)
```

### üö® Error Handling

The SDK provides specific exception types for different error scenarios:

```python
from waha.exceptions import (
    WahaException,
    WahaAPIError,
    WahaTimeoutError,
    WahaAuthenticationError,
    WahaSessionError
)

try:
    message = client.messages.send_text(
        chat_id="invalid_chat_id",
        text="Hello"
    )
except WahaAuthenticationError:
    print("Authentication failed - check your API key")
except WahaAPIError as e:
    print(f"API error: {e.message} (Status: {e.status_code})")
except WahaTimeoutError:
    print("Request timed out")
except WahaException as e:
    print(f"General WAHA error: {e}")
```

## üß™ Testing

Run the test suite:

```bash
# Install development dependencies
pip install -e ".[dev]"

# Run tests
pytest

# Run tests with coverage
pytest --cov=waha_sdk

# Run specific test file
pytest tests/test_client.py
```

## üîÑ Development

### Setting up for development:

```bash
# Clone the repository
git clone https://github.com/devlikeapro/waha-python.git
cd waha-python

# Install in development mode
pip install -e ".[dev]"

# Install pre-commit hooks
pre-commit install

# Run tests
pytest

# Format code
black waha tests examples

# Type checking
mypy waha
```

### Project Structure

```
waha-python/
‚îú‚îÄ‚îÄ waha/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ client.py              # Main client classes
‚îÇ   ‚îú‚îÄ‚îÄ exceptions.py          # Custom exceptions
‚îÇ   ‚îú‚îÄ‚îÄ types.py              # Pydantic models
‚îÇ   ‚îú‚îÄ‚îÄ http_client.py        # HTTP client implementation
‚îÇ   ‚îî‚îÄ‚îÄ namespaces/           # API namespaces
‚îÇ       ‚îú‚îÄ‚îÄ auth.py
‚îÇ       ‚îú‚îÄ‚îÄ sessions.py
‚îÇ       ‚îú‚îÄ‚îÄ messages.py
‚îÇ       ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ tests/                    # Test suite
‚îú‚îÄ‚îÄ examples/                 # Usage examples
‚îú‚îÄ‚îÄ pyproject.toml           # Package configuration
‚îî‚îÄ‚îÄ README.md
```

## üìã Requirements

- Python 3.8+
- httpx >= 0.24.0
- pydantic >= 2.0.0

## ü§ù Contributing

Contributions are welcome! Please feel free to submit a Pull Request. For major changes, please open an issue first to discuss what you would like to change.

1. Fork the repository
2. Create a feature branch (`git checkout -b feature/amazing-feature`)
3. Make your changes
4. Add tests for your changes
5. Ensure all tests pass (`pytest`)
6. Commit your changes (`git commit -m 'Add some amazing feature'`)
7. Push to the branch (`git push origin feature/amazing-feature`)
8. Open a Pull Request

## üìÑ License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

## üîó Links

- **WAHA Documentation**: [https://waha.devlike.pro](https://waha.devlike.pro)
- **WAHA GitHub**: [https://github.com/devlikeapro/waha](https://github.com/devlikeapro/waha)
- **PyPI Package**: [https://pypi.org/project/waha/](https://pypi.org/project/waha/)
- **Issues**: [https://github.com/devlikeapro/waha-python/issues](https://github.com/devlikeapro/waha-python/issues)

## üÜò Support

If you encounter any issues or have questions:

1. Check the [documentation](https://waha.devlike.pro)
2. Search existing [issues](https://github.com/devlikeapro/waha-python/issues)
3. Create a new issue with detailed information about your problem

## üéØ Roadmap

- [ ] Add webhook handling utilities
- [ ] Implement retry logic with exponential backoff
- [ ] Add rate limiting support
- [ ] Create CLI tool for common operations
- [ ] Add more comprehensive examples
- [ ] Support for WhatsApp Business API features

## üôè Acknowledgments

- Thanks to the [WAHA](https://github.com/devlikeapro/waha) project for providing the WhatsApp HTTP API
- Built with [httpx](https://www.python-httpx.org/) for HTTP client functionality
- Uses [Pydantic](https://pydantic-docs.helpmanual.io/) for data validation and serialization