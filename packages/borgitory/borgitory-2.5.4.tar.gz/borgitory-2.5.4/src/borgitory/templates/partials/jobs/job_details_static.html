{# Static job details for completed jobs #}
<div class="border-t dark:border-gray-600 bg-gray-50 dark:bg-gray-700 p-4">
    <div class="space-y-3">
        <div class="flex justify-between items-start">
            <div class="grid grid-cols-2 gap-4 text-sm flex-1">
                <div>
                    <span class="font-medium text-gray-700 dark:text-gray-300">Type:</span>
                    <span class="ml-2 text-gray-900 dark:text-gray-100">{{ job.type }}</span>
                </div>
                <div>
                    <span class="font-medium text-gray-700 dark:text-gray-300">Repository:</span>
                    <span class="ml-2 text-gray-900 dark:text-gray-100">{{ repository_name }}</span>
                </div>
                <div>
                    <span class="font-medium text-gray-700 dark:text-gray-300">Started:</span>
                    <span class="ml-2 text-gray-900 dark:text-gray-100">{{ job.started_at | format_datetime_browser("%Y-%m-%d %H:%M:%S", browser_tz_offset) if job.started_at else "N/A" }}</span>
                </div>
                <div>
                    <span class="font-medium text-gray-700 dark:text-gray-300">Finished:</span>
                    <span class="ml-2 text-gray-900 dark:text-gray-100">{% if job.finished_at %}{{ job.finished_at | format_datetime_browser("%Y-%m-%d %H:%M:%S", browser_tz_offset) }}{% else %}N/A{% endif %}</span>
                </div>
            </div>
            
            {# Stop button for running jobs (in case they're shown as static) #}
            {% if job.status|string == 'running' %}
                <div class="ml-4">
                    <button 
                        class="inline-flex items-center px-3 py-2 border border-red-300 dark:border-red-600 text-sm leading-4 font-medium rounded-md text-red-700 dark:text-red-300 bg-white dark:bg-gray-800 hover:bg-red-50 dark:hover:bg-red-900/20 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition-colors duration-200"
                        hx-post="/api/jobs/{{ job.id }}/stop"
                        hx-target="#job-stop-result-{{ job.id }}"
                        hx-swap="innerHTML"
                        hx-confirm="Are you sure you want to stop this job? This will kill the current task and skip all remaining tasks."
                        title="Stop job and skip remaining tasks">
                        <svg class="w-4 h-4 mr-1.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 9h6v6H9z"></path>
                        </svg>
                        Stop Job
                    </button>
                </div>
            {% endif %}
        </div>
        
        {# Container for stop job result messages #}
        <div id="job-stop-result-{{ job.id }}"></div>
        {# Composite job with completed tasks #}
        <div class="mt-4">
            <h4 class="text-sm font-medium text-gray-900 dark:text-gray-100 mb-3">Tasks:</h4>
            <div class="space-y-2">
                {% for task in sorted_tasks %}
                    {% set task_expanded = false %}
                    {% include 'partials/jobs/task_item_static.html' %}
                {% endfor %}
            </div>
        </div>
    </div>
</div>