<!-- HTMX Path Autocomplete Component -->
<!-- Usage: Include this template with input_id, input_name, and optional input_value, placeholder -->
<div class="relative" 
     data-path-autocomplete
     hx-on:htmx:before-request="
        const dropdown = document.getElementById('{{ input_id }}-dropdown');
        dropdown.style.display = 'block';
        dropdown.innerHTML = '<div class=&quot;px-3 py-2 text-sm text-gray-600 dark:text-gray-400 flex items-center&quot;><div class=&quot;animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mr-2&quot;></div>Searching directories...</div>';
     "
     hx-on:htmx:after-request="
        const dropdown = document.getElementById('{{ input_id }}-dropdown');
        if (event.detail.target.id === '{{ input_id }}-dropdown') { 
            dropdown.style.display = 'block'; 
        }
     ">
    <!-- Input field -->
    <div class="flex items-center border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus-within:ring-blue-500 focus-within:border-blue-500 dark:bg-gray-700">
        <input type="text" 
               id="{{ input_id }}"
               name="{{ input_name }}"
               value="{{ input_value }}"
               placeholder="{{ placeholder | default('path/to/directory') }}"
               class="flex-1 px-3 py-2 border-0 rounded-r-md focus:outline-none focus:ring-0 dark:bg-gray-700 dark:text-white input-modern"
               hx-get="/api/repositories/directories/autocomplete"
               hx-trigger="input changed delay:300ms, focus delay:100ms, autocomplete-immediate"
               hx-target="#{{ input_id }}-dropdown"
               hx-include="this"
               hx-headers='{"hx-target-input": "{{ input_id }}"}'
               autocomplete="off"
               {% if required %}required{% endif %} />
    </div>
    
    <!-- Dropdown container -->
    <div id="{{ input_id }}-dropdown" 
         class="absolute z-50 w-full mt-1 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md shadow-lg max-h-80 overflow-y-auto"
         style="display: none;">
        <!-- Dropdown content will be loaded here -->
    </div>
</div>
