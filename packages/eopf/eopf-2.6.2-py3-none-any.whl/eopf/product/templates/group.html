{% extends "obj_repr.html" %}

{% set obj = group %}
{% set obj_type = "eogroup" %}
{% set flag_for_svg = prettier %}

{% block icon %}
    {% if flag_for_svg %}
        {% if class_name == "measurements" %}
            {% include "static/images/icons-svg-measurement.svg" %}
        {% elif class_name == "info" %}
            {% include "static/images/icons-svg-info.svg" %}
        {% elif class_name == "quality" %}
            {% include "static/images/icons-svg-quality.svg" %}
        {% elif class_name == "attrs" %}
            {% include "static/images/icons-svg-attributes.svg" %}
        {% else %}
            {% include "static/images/icons-svg-group.svg" %}
        {% endif %}
    {% else %}
        <span>[G]</span>
    {% endif %}
{% endblock %}

{% block sections %}
    {% if obj.attrs %}
        <li class="eopf-section-item">
            <input type="checkbox" class="eopf-section-summary-in" id="{{ obj|string }}_{{ unique_id }}_attrs" hidden checked>
            <label for="{{ obj|string }}_{{ unique_id }}_attrs" class="eopf-section-summary eopf-header" >
                {% if flag_for_svg %}
                    {% include "static/images/icons-svg-attributes.svg" %}
                {% endif %}
                Attributes
            </label>
            <div class='eopf-section-details'>
                <dl class='eopf-attrs'>
                    <dd>{{obj.attrs|human_readable_attrs}}</dd>
                </dl>
            </div>
        </li>
    {% endif %}

    {% if obj.coords %}
        <li class="eopf-section-item">
            <input type="checkbox" class="eopf-section-summary-in" id="{{ obj|string }}_{{unique_id}}_coords" hidden checked>
            <label for="{{ obj|string }}_{{unique_id}}_coords" class="eopf-section-summary eopf-header" >
                {% if flag_for_svg %}
                    {% include "static/images/icons-svg-coords.svg" %}
                {% endif %}
                Coordinates
            </label>
            <div class='eopf-section-details'>
                <dl class='eopf-attrs'>
                    {% with coordinates=obj.coordinates_dict %}
                        {% for name, value in coordinates.items() %}
                            <dt>
                                <span>{{name}}</span>
                            </dt>
                            <dd>{{value}}</dd>
                        {% endfor %}
                    {% endwith %}
                </dl>
            </div>
        </li>
    {% endif %}

    <div class="eopf-obj-type-title">Subgroups</div>

    {% set ns = namespace (count_groups = 0, count_variables = 0) %}

    {% for sgroup_name, sgroup in obj.groups %}
        <li class="eopf-section-item">
            {% with group=sgroup, class_name=sgroup_name, flag_for_svg=flag_for_svg %}
                {% include "group.html" %}
            {% endwith %}
        </li>
        {% set ns.count_groups = loop.index %}
    {% endfor %}

    {% if ns.count_groups == 0 %}
        <div class="eopf-obj-type">None</div>
    {% endif %}

    <div class="eopf-obj-type-title">Variables</div>

    {% for _, variable in obj.variables %}
        <li class="eopf-section-item">
        {% with variable=variable %}
            {% include "variable.html" %}
        {% endwith %}
        </li>
        {% set ns.count_variables = loop.index %}
    {% endfor %}

    {% if ns.count_variables == 0 %}
        <div class="eopf-obj-type">None</div>
    {% endif %}

    {% if obj.data %}
        {% with current_data = obj.data._repr_html_().replace("xarray.Dataset", '<div class="eopf-obj-type-title-dataset">Dataset</div>') %}
            {{ current_data|safe }}
        {% endwith %}
    {% endif %}

{% endblock %}
