[package]
name = "cosmol_viewer_wasm"
version.workspace = true
edition = "2024"
publish = false

[dependencies]
cosmol_viewer_core.workspace = true
serde_json.workspace = true
serde.workspace = true
log = "0.4.28"

uuid = { version = "1.18.1", features = ["v4"], optional = true }
eframe = { workspace = true, optional = true }
wasm-bindgen-futures = { version = "0.4.54", optional = true }
web-sys = { version = "0.3.81", features = ["HtmlCanvasElement"], optional = true }
wasm-bindgen = { version = "0.2.104", optional = true }
gloo-timers = { version = "0.3.0", features = ["futures-core", "futures"], optional = true }
pyo3 = { workspace = true, optional = true }
base64 = { version = "0.22.1", optional = true }

[features]
default = ["wasm"]

wasm = [
    "eframe",
    "wasm-bindgen-futures",
    "web-sys",
    "wasm-bindgen",
    "gloo-timers",
]

js_bridge = [
    "pyo3",
    "base64",
    "uuid",
]

[lib]
crate-type = ["rlib", "cdylib"]

[package.metadata.wasm-pack.profile.release]
# wasm-opt = false