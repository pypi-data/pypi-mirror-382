(function(){"use strict";var e={7520:function(e,t,o){var n=o(5130),s=o(6768);function r(e,t,o,n,r,l){const a=(0,s.g2)("GraphViewer");return(0,s.uX)(),(0,s.Wv)(a,{"websocket-url":n.wsUrl},null,8,["websocket-url"])}var l=o(4232);const a={class:"panel legend-panel"},i={id:"container",ref:"container",class:"graph-container"},c={class:"panel properties-panel"},d={id:"websocket-status"},u={id:"export-panel"},h={id:"alert-panel"},f={key:0,class:"alert-empty"},p={key:1,class:"alert-list"},g=["onMouseenter"],v={class:"alert-header"},b={class:"alert-type"},A={class:"alert-time"},C={class:"alert-description"},E={class:"alert-meta"},N={key:0},k={key:1},m={key:2},S={key:3},O={key:4},y={key:1,class:"rotate-message"};function w(e,t,o,n,r,w){const _=(0,s.g2)("LegendTable"),T=(0,s.g2)("AttributesTable"),L=(0,s.g2)("SearchComponent"),I=(0,s.g2)("NodeList");return n.isLandscape?((0,s.uX)(),(0,s.CE)("div",{key:0,class:"app-container",style:(0,l.Tr)(n.gridStyle),onMousemove:t[7]||(t[7]=(...e)=>n.onMouseMove&&n.onMouseMove(...e)),onMouseup:t[8]||(t[8]=(...e)=>n.onMouseUp&&n.onMouseUp(...e)),onMouseleave:t[9]||(t[9]=(...e)=>n.onMouseUp&&n.onMouseUp(...e)),onTouchmove:t[10]||(t[10]=(...e)=>n.onTouchMove&&n.onTouchMove(...e)),onTouchend:t[11]||(t[11]=(...e)=>n.onTouchEnd&&n.onTouchEnd(...e))},[(0,s.Lk)("div",a,[(0,s.bF)(_,{ssids:n.ssids,ssidColours:n.ssidColours,onHighlightNode:n.highlightNode,onGotoNode:n.gotoNode},null,8,["ssids","ssidColours","onHighlightNode","onGotoNode"]),(0,s.Lk)("div",{class:"resizer resizer-left",onMousedown:t[0]||(t[0]=e=>n.startResize("left",e)),onTouchstart:t[1]||(t[1]=e=>n.startResize("left",e))},null,32)]),(0,s.Lk)("main",i,null,512),t[13]||(t[13]=(0,s.Lk)("div",{id:"counter"},"Nodes: 0",-1)),(0,s.Lk)("div",c,[(0,s.bF)(T,{attributes:n.attributes},null,8,["attributes"]),(0,s.bF)(L,{updateSearch:n.updateSearch},null,8,["updateSearch"]),(0,s.bF)(I,{filteredNodes:n.filteredNodes,onHighlightNode:n.highlightNode,onGotoNode:n.gotoNode},null,8,["filteredNodes","onHighlightNode","onGotoNode"]),(0,s.Lk)("div",d,[(0,s.Lk)("span",{class:(0,l.C4)(n.websocketStatusClass)},(0,l.v_)(n.websocketStatus),3),(0,s.Lk)("span",null,"Packets per 10 seconds: "+(0,l.v_)(n.packetCount),1),"Disconnected"==n.websocketStatus?((0,s.uX)(),(0,s.CE)("button",{key:0,onClick:t[2]||(t[2]=(...e)=>n.reconnectWebSocket&&n.reconnectWebSocket(...e))},"Reconnect")):(0,s.Q3)("",!0)]),(0,s.Lk)("div",u,[(0,s.Lk)("button",{onClick:t[3]||(t[3]=e=>n.exportGraph())},"Export Graph")]),(0,s.Lk)("div",h,[t[12]||(t[12]=(0,s.Lk)("h3",null,"Alerts",-1)),0===n.alerts.length?((0,s.uX)(),(0,s.CE)("div",f,"No alerts detected")):((0,s.uX)(),(0,s.CE)("ul",p,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(n.alerts,e=>((0,s.uX)(),(0,s.CE)("li",{key:e.id,class:"alert-item",onMouseenter:t=>n.handleAlertEnter(e),onMouseleave:t[4]||(t[4]=(...e)=>n.handleAlertLeave&&n.handleAlertLeave(...e))},[(0,s.Lk)("div",v,[(0,s.Lk)("span",b,(0,l.v_)(e.type),1),(0,s.Lk)("span",{class:(0,l.C4)(["alert-severity",`severity-${e.severity}`])},(0,l.v_)(e.severity),3)]),(0,s.Lk)("div",A,(0,l.v_)(n.formatAlertTime(e.time)),1),(0,s.Lk)("div",C,(0,l.v_)(e.description),1),(0,s.Lk)("div",E,[e.source?((0,s.uX)(),(0,s.CE)("span",N,"Src: "+(0,l.v_)(e.source),1)):(0,s.Q3)("",!0),e.target?((0,s.uX)(),(0,s.CE)("span",k,"Dst: "+(0,l.v_)(e.target),1)):(0,s.Q3)("",!0),e.bssid?((0,s.uX)(),(0,s.CE)("span",m,"BSSID: "+(0,l.v_)(e.bssid),1)):(0,s.Q3)("",!0),e.ssid?((0,s.uX)(),(0,s.CE)("span",S,"SSID: "+(0,l.v_)(e.ssid),1)):(0,s.Q3)("",!0),e.count?((0,s.uX)(),(0,s.CE)("span",O,"Count: "+(0,l.v_)(e.count)+" / "+(0,l.v_)(Math.round(e.windowMs/1e3))+"s",1)):(0,s.Q3)("",!0)])],40,g))),128))]))]),(0,s.Lk)("div",{class:"resizer resizer-right",onMousedown:t[5]||(t[5]=e=>n.startResize("right",e)),onTouchstart:t[6]||(t[6]=e=>n.startResize("right",e))},null,32)])],36)):((0,s.uX)(),(0,s.CE)("div",y,[...t[14]||(t[14]=[(0,s.Lk)("p",null,"Width too small, please turn your device sideways and refresh.",-1)])]))}o(4114),o(8111),o(2489),o(3579);var _=o(144),T=o(5727),L=o(6853),I=o.n(L);const F={id:"legend-items"};function R(e,t,o,n,r,a){return(0,s.uX)(),(0,s.CE)(s.FK,null,[t[0]||(t[0]=(0,s.Lk)("h2",null,"SSIDs",-1)),(0,s.Lk)("div",F,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(a.limitedSsids,(e,t)=>((0,s.uX)(),(0,s.CE)("div",{class:"legend-item",key:t},[(0,s.Lk)("div",{class:"legend-color",style:(0,l.Tr)({backgroundColor:o.ssidColours[t]})},null,4),(0,s.Lk)("span",null,(0,l.v_)(e),1)]))),128))])],64)}var M={props:{ssids:{type:Object,required:!0},ssidColours:{type:Array,required:!0}},computed:{limitedSsids(){return Object.keys(this.ssids).slice(0,this.ssidColours.length)}}},D=o(1241);const $=(0,D.A)(M,[["render",R]]);var K=$;const U={key:0},P={key:0},X={key:1},x={key:2};function j(e,t,o,n,r,a){return(0,s.uX)(),(0,s.CE)(s.FK,null,[t[2]||(t[2]=(0,s.Lk)("h2",null,"Node/Edge Attributes",-1)),(0,s.Lk)("table",null,[t[1]||(t[1]=(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("th",null,"Attribute"),(0,s.Lk)("th",null,"Value")])],-1)),(0,s.Lk)("tbody",null,[o.attributes&&0!==Object.keys(o.attributes).length?((0,s.uX)(!0),(0,s.CE)(s.FK,{key:1},(0,s.pI)(a.filteredAttributes,(e,t)=>((0,s.uX)(),(0,s.CE)("tr",{key:t},[(0,s.Lk)("td",null,(0,l.v_)(t),1),(0,s.Lk)("td",null,["lastseen"===t?((0,s.uX)(),(0,s.CE)("span",P,(0,l.v_)(a.timeSince(e)),1)):"channels"===t?((0,s.uX)(),(0,s.CE)("span",X,(0,l.v_)(a.sortedChannels(e).join(", ")),1)):((0,s.uX)(),(0,s.CE)("span",x,(0,l.v_)(e),1))])]))),128)):((0,s.uX)(),(0,s.CE)("tr",U,[...t[0]||(t[0]=[(0,s.Lk)("td",{colspan:"2"},"No attributes",-1)])]))])])],64)}o(8237);var z={props:{attributes:{type:Object,required:!0}},computed:{filteredAttributes(){return Object.entries(this.attributes).filter(([e])=>!["x","y","size","forceLabel"].includes(e)).reduce((e,[t,o])=>(e[t]=o,e),{})}},methods:{timeSince(e){const t=new Date,o=t-new Date(e),n=Math.floor(o/1e3),s=Math.floor(n/60),r=Math.floor(s/60),l=Math.floor(r/24);return l>0?`${l} day(s) ago`:r>0?`${r} hour(s) ago`:s>0?`${s} minute(s) ago`:`${n} second(s) ago`},sortedChannels(e){return[...e].sort((e,t)=>t-e)}}};const Q=(0,D.A)(z,[["render",j]]);var B=Q;function H(e,t,o,r,l,a){return(0,s.uX)(),(0,s.CE)("div",null,[(0,s.bo)((0,s.Lk)("input",{type:"text",placeholder:"Search nodes","onUpdate:modelValue":t[0]||(t[0]=e=>l.searchTerm=e),onInput:t[1]||(t[1]=(...e)=>a.handleInput&&a.handleInput(...e)),class:"search-box"},null,544),[[n.Jo,l.searchTerm]])])}var W={props:{updateSearch:{type:Function,required:!0}},data(){return{searchTerm:""}},methods:{handleInput(){this.updateSearch(this.searchTerm)}}};const G=(0,D.A)(W,[["render",H]]);var V=G;const q={class:"node-list"},J=["onMousemove","onTouchmove","onClick"];function Y(e,t,o,n,r,a){return(0,s.uX)(),(0,s.CE)("ul",q,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(o.filteredNodes,t=>((0,s.uX)(),(0,s.CE)("li",{key:t,onMousemove:o=>e.$emit("highlightNode",t),onTouchmove:o=>e.$emit("highlightNode",t),onClick:o=>e.$emit("gotoNode",t)},(0,l.v_)(t),41,J))),128))])}var Z={props:{filteredNodes:{type:Array,required:!0}}};const ee=(0,D.A)(Z,[["render",Y]]);var te=ee;const oe=["#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#aec7e8","#ffbb78","#98df8a","#ff9896","#c5b0d5","#c49c94","#f7b6d2","#c7c7c7","#dbdb8d","#9edae5","#393b79","#637939","#8c6d31","#843c39","#7b4173","#5254a3","#9c9ede","#6b6ecf","#b5cf6b","#e7ba52","#e7969c","#d6616b","#7b6888","#c7c7c7","#e6550d","#31a354","#3182bd","#756bb1","#636363","#fd8d3c","#74c476","#6baed6","#9e9ac8","#969696","#fdae6b","#a1d99b","#9ecae1","#dadaeb","#bdbdbd","#fdd0a2","#c7e9c0"];o(7588),o(7642),o(8004),o(3853),o(5876),o(2475),o(5024),o(1698),o(116),o(1701);const ne=e=>void 0==e?"":"<MISSING>"==e||/^0+$/.test(e)?"<HIDDEN>":e.match(/.{1,2}/g).map(function(e){return String.fromCharCode(parseInt(e,16))}).join(""),se=e=>2484==e?14:e<2484?(e-2407)/5:e/5-1e3,re=Object.freeze({ASSOCIATION_REQUEST:0,ASSOCIATION_RESPONSE:1,REASSOCIATION_REQUEST:2,REASSOCIATION_RESPONSE:3,PROBE_REQUEST:4,PROBE_RESPONSE:5,BEACON:8,ATIM:9,DISASSOCIATION:10,AUTHENTICATION:11,DEAUTHENTICATION:12,ACTION:13,ACTION_NO_ACK:14,BLOCK_ACK_REQUEST:24,BLOCK_ACK:25,PS_POLL:26,RTS:27,CTS:28,ACK:29,CF_END:30,CF_END_ACK:31,DATA:32,DATA_CF_ACK:33,DATA_CF_POLL:34,DATA_CF_ACK_CF_POLL:35,NULL:36,CF_ACK:37,CF_POLL:38,CF_ACK_CF_POLL:39,QOS_DATA:40,QOS_DATA_CF_ACK:41,QOS_DATA_CF_POLL:42,QOS_DATA_CF_ACK_CF_POLL:43,QOS_NULL:44,QOS_CF_POLL:46,QOS_CF_ACK_CF_POLL:47}),le=Object.freeze({MANAGEMENT:0,CONTROL:1,DATA:2,RESERVED:3}),ae=e=>{const t=Object.entries(le).find(([t,o])=>o===parseInt(e,16));return void 0==t&&null!=e&&console.log(e),t?t[0]:"UNKNOWN ("+e+")"},ie=e=>{const t=Object.entries(re).find(([t,o])=>o===parseInt(e,16));return void 0==t&&null!=e&&console.log(e),t?t[0]:"UNKNOWN ("+e+")"};var ce=o(5797),de=o.n(ce);const ue=e=>{if(null===e||void 0===e)return null;if("number"===typeof e)return e;const t=parseInt(e,16);if(!Number.isNaN(t))return t;const o=parseInt(e,10);return Number.isNaN(o)?null:o},he=new Set([re.PROBE_REQUEST,re.PROBE_RESPONSE,re.BEACON,re.ATIM,re.ACTION,re.ACTION_NO_ACK]),fe=new Set([re.ASSOCIATION_REQUEST,re.ASSOCIATION_RESPONSE,re.REASSOCIATION_REQUEST,re.REASSOCIATION_RESPONSE,re.AUTHENTICATION,re.DEAUTHENTICATION,re.DISASSOCIATION]),pe=6e4,ge=12e4,ve=200,be={deauth:new Map,disassoc:new Map,probeFlood:new Map,authFlood:new Map},Ae=(e,t,o,n,s=null)=>{const r=JSON.parse(t.data);r.forEach(r=>{const l=r["wlan_ta"],a=r["wlan_ra"],i=r["wlan_sa"],c=r["wlan_da"],d=r["frame_len"],u=r["wlan_ssid"],h=r["wlan_bssid"],f=r["radiotap_channel_freq"],p=r["wlan_flags_str"],g=r["wlan_fc_type"],v=r["wlan_fc_type_subtype"],b=ue(g),A=ue(v),C=b===le.MANAGEMENT&&null!==A&&he.has(A),E=(()=>b===le.DATA||b===le.MANAGEMENT&&null!==A&&fe.has(A))(),N=A===re.PROBE_RESPONSE,k=Date.now();d&&""!=l&&""!=a&&("00:00:00:00:00:00"!=l?(Ne({packetTypeValue:b,packetSubtypeValue:A,ta:l,ra:a,ssidHex:u,bssid:h,now:k,alertsRef:s}),Ce(e,o,n,l,u,h,f,p,g,v),C||(Ce(e,o,n,a,u,h,f,p,g,null),N||(Ce(e,o,n,i,u,h,f,p,g,null),Ce(e,o,n,c,u,h,f,p,g,null),Ee(e,l,a,i,c,E)))):console.log("unusal client: "+t.data))})},Ce=(e,t,o,n,s,r,l,a,i,c)=>{if(""==n||"ff:ff:ff:ff:ff:ff"==n)return;const d=se(l),u=n==r||c==re.BEACON,h=ne(s),f=u?h:"",p=u?"":h;if(""!=h)if(t[h])t[h].nodes.includes(n)||t[h].nodes.push(n);else{let e="#1F77B4";Object.keys(t).length<o.length&&(e=o[Object.keys(t).length]),t[h]={nodes:[n],color:e}}if(e.hasNode(n)){const t=e.getNodeAttributes(n);if(""!=p)if(Array.isArray(t["lookingFor"])){if(!t["lookingFor"].includes(p)){const o=t["lookingFor"];o.push(p),e.setNodeAttribute(n,"lookingFor",o)}}else t["lookingFor"]!=p&&e.setNodeAttribute(n,"lookingFor",[t["lookingFor"],p]);if(u&&("true"!=t["isAP"]&&e.setNodeAttribute(n,"isAP","true"),""!=h)){if(Array.isArray(t["ssid"])){if(!t["ssid"].includes(f)){const t=e.getNodeAttribute(n,"ssid");t.push(f),e.setNodeAttribute(n,"ssid",t)}}else t["ssid"]!=f&&e.setNodeAttribute(n,"ssid",[t["ssid"],f]);t["label"].length<4&&e.setNodeAttribute(n,"label","AP: "+h)}if(Array.isArray(t["channels"])){if(!t["channels"].includes(d)){const t=e.getNodeAttribute(n,"channels");t.push(d),e.setNodeAttribute(n,"channels",t)}}else d!=t["channels"]&&e.setNodeAttribute(n,"channels",[t["channels"],d]);e.setNodeAttribute(n,"lastseen",Date.now()),t["stats"][ae(i)]=(t["stats"][ae(i)]??0)+1,null!=c&&(t["stats"][ie(c)]=(t["stats"][ie(c)]??0)+1),e.setNodeAttribute(n,"stats",t["stats"])}else{const t=["2","6","a","e"].includes(n[1])?"private MAC address":de()(n,"unknown"),o=u?"AP: "+h:t;e.addNode(n,{label:o,mac:n,vendor:t,isAP:u.toString(),x:10*Math.random(),y:10*Math.random(),ssid:""==f?[]:[f],lookingFor:[p],channels:[d],lastseen:Date.now(),forceLabel:"unknown"!=t,stats:{[i]:1,[ie(c)]:1}})}},Ee=(e,t,o,n,s,r)=>{r&&("ff:ff:ff:ff:ff:ff"==o?e.hasEdge(t,t)||e.addUndirectedEdge(t,t,{size:2,linktype:"broadcast"}):e.hasEdge(t,o)||e.addUndirectedEdge(t,o,{size:3,linktype:"physical"}),""==n||t==n&&o==s||("ff:ff:ff:ff:ff:ff"==s?e.hasEdge(n,n)||e.addUndirectedEdge(n,n,{size:2,linktype:"broadcast"}):e.hasEdge(n,s)||e.addUndirectedEdge(n,s,{size:1,linktype:"logical"})))},Ne=({packetTypeValue:e,packetSubtypeValue:t,ta:o,ra:n,ssidHex:s,bssid:r,now:l,alertsRef:a})=>{if(a&&null!==e&&null!==t&&e===le.MANAGEMENT)if(t===re.DEAUTHENTICATION){const e=`${o}->${n}`,t=ke(be.deauth,e,l);t.count>=5&&me(t,l)&&(t.lastAlert=l,Se(a,{id:`deauth-${l}-${e}`,type:"DEAUTH_FLOOD",severity:"high",time:new Date(l).toISOString(),source:o,target:n,transmitter:o,receiver:n,bssid:r,ssid:ne(s),windowMs:pe,count:t.count,description:`Detected ${t.count} deauthentication frames from ${o} to ${n} within the last ${Math.round(pe/1e3)} seconds.`}))}else if(t===re.DISASSOCIATION){const e=`${o}->${n}`,t=ke(be.disassoc,e,l);t.count>=5&&me(t,l)&&(t.lastAlert=l,Se(a,{id:`disassoc-${l}-${e}`,type:"DISASSOC_FLOOD",severity:"medium",time:new Date(l).toISOString(),source:o,target:n,transmitter:o,receiver:n,bssid:r,ssid:ne(s),windowMs:pe,count:t.count,description:`Detected ${t.count} disassociation frames from ${o} to ${n} within the last ${Math.round(pe/1e3)} seconds.`}))}else if(t===re.PROBE_REQUEST){const e=o,t=ke(be.probeFlood,e,l);t.count>=60&&me(t,l)&&(t.lastAlert=l,Se(a,{id:`probe-${l}-${e}`,type:"PROBE_FLOOD",severity:"medium",time:new Date(l).toISOString(),source:o,transmitter:o,receiver:n,bssid:r,ssid:ne(s),windowMs:pe,count:t.count,description:`Device ${o} sent ${t.count} probe requests within the last ${Math.round(pe/1e3)} seconds.`}))}else if(t===re.AUTHENTICATION){const e=`${o}->${n}`,t=ke(be.authFlood,e,l);t.count>=30&&me(t,l)&&(t.lastAlert=l,Se(a,{id:`auth-${l}-${e}`,type:"AUTH_FLOOD",severity:"medium",time:new Date(l).toISOString(),source:o,target:n,transmitter:o,receiver:n,bssid:r,ssid:ne(s),windowMs:pe,count:t.count,description:`Detected ${t.count} authentication frames from ${o} to ${n} within the last ${Math.round(pe/1e3)} seconds.`}))}},ke=(e,t,o)=>{let n=e.get(t);n||(n={timestamps:[],lastAlert:0},e.set(t,n)),n.timestamps.push(o);while(n.timestamps.length&&o-n.timestamps[0]>pe)n.timestamps.shift();return n.count=n.timestamps.length,n},me=(e,t)=>t-e.lastAlert>ge,Se=(e,t)=>{const o=Array.isArray(e.value)?e.value:[],n=[t,...o].slice(0,ve);e.value=n};o(4603),o(7566),o(8721);var Oe=o(1570),ye=o.n(Oe);const we=(e,t,o,n,s)=>(e-t)/(o-t)*(s-n)+n,_e=e=>{const t=ye().inferSettings(e);ye().assign(e,{settings:t,iterations:60})},Te=e=>{const t="wifi-graph-export.json",o=JSON.stringify(e.export()),n=new Blob([o],{type:"application/json"}),s=URL.createObjectURL(n),r=document.createElement("a");r.href=s,r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(s)};var Le={props:{websocketUrl:{type:String,required:!0}},components:{LegendTable:K,AttributesTable:B,SearchComponent:V,NodeList:te},setup(e){const t=(0,_.KR)(null);let o=null,n=new(I());const r=(0,_.KR)([]),l=(0,_.KR)([]),a=(0,_.KR)([]);let i=null;const c=(0,_.KR)(null);let d=(0,_.KR)({}),u="light";const h=(0,_.KR)(window.innerWidth>414),f=(0,_.KR)(!0),p=(0,_.KR)(!0),g=(0,_.KR)(200),v=(0,_.KR)(350),b=(0,_.KR)(null),A=(0,_.KR)(0),C=(0,_.KR)("Disconnected"),E=(0,_.KR)("disconnected"),N=(0,_.KR)(0);let k=0;function m(){window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&(u="dark"),u="light",o=new T.Ay(n,t.value,{defaultNodeColor:q[u].nodeColor,labelColor:q[u].textColor,enableEdgeHovering:!0,minEdgeSize:2,nodeReducer:K,edgeReducer:U,allowInvalidContainer:!0}),o.on("clickNode",({node:e})=>{r.value=n.getNodeAttributes(e)}),o.on("clickEdge",({edge:e})=>{r.value=n.getEdgeAttributes(e)}),o.on("clickStage",()=>{r.value=[]}),o.on("enterNode",({node:e})=>{X(e),r.value=n.getNodeAttributes(e),r.value["connections"]=n.neighbors(e)}),o.on("leaveNode",()=>{x()}),n.on("nodeAdded",function({key:e}){G(e)}),J(u)}const S=(0,s.EW)(()=>`\n        grid-template-columns: ${f.value?`${g.value}px`:"0"} 1fr ${p.value?`${v.value}px`:"0"};\n      `),O=()=>{h.value=window.innerWidth>414},y=(e,t)=>{b.value=e,A.value=t.touches?t.touches[0].clientX:t.clientX,t.preventDefault()},w=e=>{if(!b.value)return;const t=e.clientX-A.value;"left"===b.value?g.value=Math.max(150,g.value+t):"right"===b.value&&(v.value=Math.max(150,v.value-t)),A.value=e.clientX},L=e=>{if(!b.value)return;const t=e.touches[0].clientX-A.value;"left"===b.value?g.value=Math.max(150,g.value+t):"right"===b.value&&(v.value=Math.max(150,v.value-t)),A.value=e.touches[0].clientX},F=()=>{b.value=null},R=()=>{b.value=null},M=e=>{const t=e.toLowerCase();l.value=""!=t?n.nodes().filter(e=>{const o=n.getNodeAttributes(e);return o.label&&o.label.toLowerCase().includes(t)||Object.values(o).some(e=>"string"===typeof e&&e.toLowerCase().includes(t))}):[]},D=e=>{try{Ae(n,e,d.value,oe,a),k++,$(),_e(n)}catch(t){console.error("Error processing WebSocket message:",t)}};function $(){n.forEachNode(e=>{const t=we(n.degree(e),1,10,5,15);n.setNodeAttribute(e,"size",t)})}const K=(e,t)=>{let o=q[u].nodeColor;return""==t.ssid||(o=d.value[t.ssid[0]]["color"]),{...t,color:o}},U=(e,t)=>{let o;return"logical"===t.linktype?o=q[u].edgeColors.logical:"physical"===t.linktype?o=q[u].edgeColors.physical:"broadcast"===t.linktype&&(o=q[u].edgeColors.broadcast),{...t,color:o}};function P(e){const t=o.getNodeDisplayData(e);t&&o.getCamera().animate(t)}function X(e){n.hasNode(e)&&(o.setSetting("nodeReducer",(t,o)=>t===e||n.neighbors(e).includes(t)?{...o,color:o.color,labelColor:"#000000"}:{...o,color:"#E0E0E0"}),o.setSetting("edgeReducer",(t,o)=>n.source(t)===e||n.target(t)===e?{...o,color:"#333",size:2}:{...o,color:"#E0E0E0",size:.5}),o.refresh())}function x(){o.setSetting("nodeReducer",K),o.setSetting("edgeReducer",U),o.refresh()}const j=e=>{const t=[e.transmitter,e.source,e.target,e.receiver];for(const o of t)if(o&&n.hasNode(o))return o;return null},z=e=>{const t=j(e);t&&(X(t),r.value=n.getNodeAttributes(t),r.value["connections"]=n.neighbors(t))},Q=()=>{x()};(0,s.sV)(()=>{W(),m(),B(),window.addEventListener("resize",O),setInterval(()=>{N.value=k,k=0},1e4)}),(0,s.xo)(()=>{window.removeEventListener("resize",O)}),(0,s.hi)(()=>{i&&i.close(),o&&o.kill()});const B=()=>{i=new WebSocket(e.websocketUrl),i.onopen=()=>{C.value="Connected",E.value="connected"},i.onclose=()=>{C.value="Disconnected",E.value="disconnected"},i.onmessage=D,i.onerror=e=>{console.error("WebSocket error:",e),C.value="Error",E.value="error"}},H=()=>{i&&i.close(),B()},W=async()=>{try{const o=e.websocketUrl.replace("ws://","http://").replace("/ws","/preload"),s=await fetch(o);if(s.ok){const e=await s.json(),o={};var t=0;for(const n of e.nodes){const{ssidlist:e}=n.attributes;if(e&&e.length>0)for(const s of e)o[s]?o[s].nodes.push(n.key):(o[s]={color:oe[t],nodes:[n.key]},t++)}d.value=o,n.import(e)}else console.info("Not preloading graph:",s.status)}catch(o){console.info("Not preloading graph:",o)}};function G(){const e=n.nodes().length,t=n.edges().length,o=document.getElementById("counter");o.innerText=`Nodes: ${e}, Edges: ${t}`}function V(){Te(n)}const q={light:{backgroundColor:"#FFFFFF",textColor:"#000000",nodeColor:"#1F77B4",edgeColors:{logical:"#FF7F0E",physical:"#9467BD",broadcast:"#2CA02C"}},dark:{backgroundColor:"#000000",textColor:"#FFFFFF",nodeColor:"#17BECF",edgeColors:{logical:"#FFD700",physical:"#FF69B4",broadcast:"#32CD32"}}};function J(e){const t=q[e];document.documentElement.style.setProperty("background-color",t.backgroundColor),document.documentElement.style.setProperty("text-color",t.textColor),o.setSetting({defaultNodeColor:t.nodeColor,labelColor:t.textColor,enableEdgeHovering:!0,minEdgeSize:2,nodeReducer:K,edgeReducer:U}),o.refresh()}const Y=e=>{try{return new Date(e).toLocaleString()}catch(t){return e}};return{container:t,infopanel:c,exportGraph:V,attributes:r,ssids:d,ssidColours:oe,filteredNodes:l,alerts:a,updateSearch:M,highlightNode:X,handleAlertEnter:z,handleAlertLeave:Q,gotoNode:P,leftPanelWidth:g,rightPanelWidth:v,isLandscape:h,gridStyle:S,startResize:y,onMouseMove:w,onMouseUp:F,onTouchMove:L,onTouchEnd:R,websocketStatus:C,websocketStatusClass:E,packetCount:N,reconnectWebSocket:H,formatAlertTime:Y,resetHighlight:x}}};const Ie=(0,D.A)(Le,[["render",w]]);var Fe=Ie,Re={name:"App",components:{GraphViewer:Fe},setup(){const e="https:"===window.location.protocol?"wss":"ws",t=window.location.host.replace("8080","8765"),o=window.location.pathname.replace("index.html","")+"ws",n=(0,_.KR)(`${e}://${t}${o}`);return{wsUrl:n}}};const Me=(0,D.A)(Re,[["render",r]]);var De=Me;(0,n.Ef)(De).mount("#app")}},t={};function o(n){var s=t[n];if(void 0!==s)return s.exports;var r=t[n]={exports:{}};return e[n].call(r.exports,r,r.exports,o),r.exports}o.m=e,function(){var e=[];o.O=function(t,n,s,r){if(!n){var l=1/0;for(d=0;d<e.length;d++){n=e[d][0],s=e[d][1],r=e[d][2];for(var a=!0,i=0;i<n.length;i++)(!1&r||l>=r)&&Object.keys(o.O).every(function(e){return o.O[e](n[i])})?n.splice(i--,1):(a=!1,r<l&&(l=r));if(a){e.splice(d--,1);var c=s();void 0!==c&&(t=c)}}return t}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[n,s,r]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={524:0};o.O.j=function(t){return 0===e[t]};var t=function(t,n){var s,r,l=n[0],a=n[1],i=n[2],c=0;if(l.some(function(t){return 0!==e[t]})){for(s in a)o.o(a,s)&&(o.m[s]=a[s]);if(i)var d=i(o)}for(t&&t(n);c<l.length;c++)r=l[c],o.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return o.O(d)},n=self["webpackChunkwifigaze"]=self["webpackChunkwifigaze"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=o.O(void 0,[504],function(){return o(7520)});n=o.O(n)})();
//# sourceMappingURL=app.56a3959f.js.map