AWSTemplateFormatVersion: '2010-09-09'
Description: 'EKS Pod Identity Association with Service Account setup'
Parameters:
  ClusterName:
    Type: String
    Description: 'Cluster Name'
  Namespace:
    Type: String
    Description: 'Namespace'
  ServiceAccountName:
    Type: String
    Description: 'Service Account Name'
  RoleArn:
    Type: String
    Description: 'Role ARN'

Resources:
  PodIdentityAssociation:
    Type: AWS::EKS::PodIdentityAssociation
    Properties:
      ClusterName: !Ref ClusterName
      Namespace: !Ref Namespace
      ServiceAccount: !Ref ServiceAccountName
      RoleArn: !Ref RoleArn
      Tags:
        - Key: CreatedBy
          Value: Tensorfuse
        - Key: ClusterName
          Value: !Ref ClusterName
