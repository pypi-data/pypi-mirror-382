[build-system]
requires = ["setuptools", "setuptools-rust"]
build-backend = "setuptools.build_meta"

[project]
name = "calzone-display"
authors = [
    {name = "Valentin Niess", email = "valentin.niess@gmail.com"}
]
description = "A display extension for Calzone (CALorimeter ZONE)"
readme = "README.md"
license = {text = "LGPLv3"}
keywords = ["Python", "Monte Carlo", "Geant4", "Display"]
classifiers = [
    "Intended Audience :: Science/Research",
    "Topic :: Scientific/Engineering :: Physics"
]
version = "0.5.0"
requires-python = ">=3.7.0"
dependencies = [
    "calzone >= 0.4.0",
    "numpy >= 1.6.0",
]

[project.urls]
source = "https://github.com/niess/calzone-display"

[tool.setuptools]
packages = ["calzone_display"]

[[tool.setuptools-rust.ext-modules]]
target = "calzone_display._core"
path = "crates/core/Cargo.toml"

# Build options for Python wheels.
[tool.cibuildwheel.linux]
build = [ "cp37-manylinux_x86_64", "cp37-manylinux_aarch64" ]
manylinux-x86_64-image = "manylinux2014"

environment = "PATH=$HOME/.cargo/bin:$PATH"
before-all = """
curl -sSf https://sh.rustup.rs -o rustup.sh && \
sh rustup.sh -y\
"""

[tool.cibuildwheel.macos]
build = [ "cp38-macosx_arm64", "cp38-macosx_x86_64" ]

[tool.cibuildwheel.windows]
build = [ "cp39-win_amd64", "cp39-win_arm64" ]

before-all = "python3 -m pip install delvewheel"
repair-wheel-command = 'delvewheel repair -w {dest_dir} -v {wheel} --exclude "glu32.dll;opengl32.dll"'
