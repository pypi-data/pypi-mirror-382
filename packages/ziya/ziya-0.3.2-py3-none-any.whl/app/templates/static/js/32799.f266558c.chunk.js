"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[32799],{32799:(e,s,t)=>{t.r(s),t.d(s,{default:()=>T});var a=t(89379),l=t(65043),i=t(31023),n=t(8918),r=t(22019),o=t(6051),c=t(4015),d=t(91686),u=t(42261),x=t(89073),h=t(96603),p=t(8354),y=t(76399),f=t(55727),j=t(35589),m=t(35271),g=t(20168),A=t(70579);const{Title:v,Text:w}=i.A,{TabPane:b}=n.A,S=[{label:"Full Pipeline",value:"full"},{label:"Prism Only",value:"prismOnly"},{label:"Diff Only",value:"diffOnly"},{label:"Raw",value:"raw"}],T=()=>{const{isDarkMode:e}=(0,f.D)(),[s,t]=(0,l.useState)([]),[i,T]=(0,l.useState)("all"),[k,C]=(0,l.useState)(!0),[P,F]=(0,l.useState)({}),[D,O]=(0,l.useState)(null),[R,V]=(0,l.useState)(!1),[B,E]=(0,l.useState)("full");(0,l.useEffect)((()=>{!async function(){C(!0);try{const e="".concat("","/testcases");console.log("Loading test cases from:",e);const s=await fetch("".concat(e,"/index.json"));if(!s.ok)throw new Error("Failed to load index.json: ".concat(s.statusText));const l=await s.json();console.log("Index loaded:",l);const i=(await Promise.all(Object.entries(l.testSets||{}).map((async s=>{let[t,l]=s;return Promise.all(l.cases.map((async s=>{const[i,n]=await Promise.all([fetch("".concat(e,"/").concat(l.path,"/").concat(s,".meta.json")),fetch("".concat(e,"/").concat(l.path,"/").concat(s,".diff"))]),r=await i.json(),o=await n.text();return(0,a.A)((0,a.A)({},r),{},{id:s,category:t,diff:o})})))})))).flat().filter((e=>Boolean(e)&&Boolean(e.id)&&Boolean(e.name)&&Array.isArray(e.tags)));t(i)}catch(e){console.error("Error loading test cases:",e),r.Ay.error("Failed to load test cases")}finally{C(!1)}}()}),[]);const I=[...new Set(s.map((e=>e.category)))],z="all"===i?s:s.filter((e=>e.category===i));return(0,A.jsxs)("div",{children:[(0,A.jsxs)(o.A,{direction:"vertical",style:{width:"100%",marginBottom:"16px"},children:[(0,A.jsx)(v,{level:3,children:"Diff Rendering Test Cases"}),(0,A.jsxs)(o.A,{children:[(0,A.jsx)(c.Ay,{type:"primary",onClick:async()=>{V(!0);const e=new m.y;try{const s=await Promise.all(g.bc.map((s=>e.runSuite(s))));O(s[0]),r.Ay.success("Test suite completed")}catch(s){r.Ay.error("Failed to run tests"),console.error("Test error:",s)}finally{V(!1)}},loading:R,children:"Run All Tests"}),(0,A.jsx)(c.Ay,{onClick:()=>F({}),disabled:0===Object.keys(P).length,children:"Clear Results"})]})]}),k?(0,A.jsxs)("div",{style:{textAlign:"center",padding:"40px"},children:[(0,A.jsx)(d.A,{size:"large"}),(0,A.jsx)("div",{style:{marginTop:"16px"},children:"Loading test cases..."})]}):(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(u.A,{message:"Visual Verification Suite",description:"".concat(s.length," test cases loaded across ").concat(I.length," categories.\n                                    Each case can be validated against its source file when provided."),type:"info",showIcon:!0,style:{margin:"16px"}}),(0,A.jsx)(x.A,{style:{margin:"16px"},children:(0,A.jsxs)(o.A,{direction:"vertical",children:[(0,A.jsx)(w,{strong:!0,children:"Render Pipeline Control"}),(0,A.jsx)(h.Ay.Group,{options:S,onChange:e=>E(e.target.value),value:B,optionType:"button",buttonStyle:"solid"})]})}),D&&(0,A.jsx)(u.A,{message:"Test Results",description:(0,A.jsxs)(o.A,{direction:"vertical",size:"small",children:[(0,A.jsx)(v,{level:5,children:"Summary"}),(0,A.jsxs)(o.A,{direction:"vertical",children:[(0,A.jsxs)(w,{children:["Total Suites: ",D.summary.totalSuites]}),(0,A.jsxs)(w,{children:["Total Tests: ",D.summary.totalTests]}),(0,A.jsxs)(w,{children:["Passed: ",D.summary.totalPassed]}),(0,A.jsxs)(w,{children:["Failed: ",D.summary.totalFailed]}),(0,A.jsxs)(w,{children:["Skipped: ",D.summary.totalSkipped]}),(0,A.jsxs)(w,{children:["Duration: ",D.summary.totalDuration,"ms"]})]}),(0,A.jsx)(p.A,{}),(0,A.jsx)(v,{level:5,children:"Suite Details"}),D.suiteResults.map(((e,s)=>(0,A.jsx)(x.A,{size:"small",style:{marginBottom:8},children:(0,A.jsxs)(o.A,{direction:"vertical",children:[(0,A.jsx)(w,{strong:!0,children:e.suiteName}),(0,A.jsxs)(o.A,{children:[(0,A.jsxs)(y.A,{color:"blue",children:[e.totalTests," tests"]}),(0,A.jsxs)(y.A,{color:"success",children:[e.passed," passed"]}),e.failed>0&&(0,A.jsxs)(y.A,{color:"error",children:[e.failed," failed"]}),e.skipped>0&&(0,A.jsxs)(y.A,{color:"warning",children:[e.skipped," skipped"]})]})]})},s)))]}),type:0===D.summary.totalFailed?"success":"warning",showIcon:!0,style:{margin:"16px"}}),(0,A.jsxs)(n.A,{activeKey:i,onChange:T,style:{margin:"0 16px"},children:[(0,A.jsx)(b,{tab:"All Cases"},"all"),I.map((e=>(0,A.jsx)(b,{tab:e},e)))]}),(0,A.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(600px, 1fr))",gap:"16px",padding:"16px"},children:z.map((s=>(0,A.jsx)(x.A,{title:s.name,extra:(0,A.jsxs)(o.A,{children:[(0,A.jsx)(y.A,{color:"blue",children:s.id}),(0,A.jsx)(y.A,{color:"purple",children:s.category}),s.subcategory&&(0,A.jsx)(y.A,{color:"cyan",children:s.subcategory}),void 0!==P[s.id]&&(0,A.jsx)(y.A,{color:P[s.id]?"success":"error",children:P[s.id]?"Valid":"Invalid"})]}),children:(0,A.jsxs)(o.A,{direction:"vertical",style:{width:"100%"},children:[(0,A.jsx)(w,{type:"secondary",children:s.description}),s.tags&&s.tags.length>0&&(0,A.jsx)(o.A,{wrap:!0,children:s.tags.map((e=>(0,A.jsx)(y.A,{children:e},e)))}),(0,A.jsx)("div",{className:"diff-container",children:(0,A.jsx)(j.default,{markdown:"```diff\n".concat(s.diff,"\n```"),enableCodeApply:!1})}),s.sourceContent&&(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(p.A,{children:"Source File"}),(0,A.jsx)("pre",{style:{backgroundColor:e?"#1f1f1f":"#f6f8fa",padding:"16px",borderRadius:"6px",overflow:"auto"},children:(0,A.jsx)("code",{children:s.sourceContent})})]}),(0,A.jsx)(c.Ay,{onClick:()=>(async e=>{try{const s=(await fetch("/api/apply-changes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({diff:e.diff,filePath:e.sourceFile,content:e.sourceContent,validate:!0})})).ok;return F((t=>(0,a.A)((0,a.A)({},t),{},{[e.id]:s}))),r.Ay.success(s?"Diff validation successful":"Diff validation failed"),s}catch(s){return console.error("Validation error:",s),r.Ay.error("Validation error occurred"),!1}})(s),style:{marginTop:"8px"},children:"Validate Diff"})]})},s.id)))})]})]})}}}]);
//# sourceMappingURL=32799.f266558c.chunk.js.map