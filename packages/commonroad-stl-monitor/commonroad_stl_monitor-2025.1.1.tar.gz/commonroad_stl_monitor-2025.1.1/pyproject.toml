[project]
name = "commonroad-stl-monitor"
version = "2025.1.1"
authors = [{name = "Luis Gressenbuch", email = "luis.gressenbuch@tum.de"}, {name = "Yuanfei Lin", email = "yuanfei.lin@tum.de"}]
readme = "README.md"
requires-python = ">=3.10,<3.12"
license = "BSD-3-Clause"
dependencies = [
    "commonroad-io (>=2024.3)",
    "ruamel-yaml (>=0.16.12)",
    "commonroad-route-planner (>=2025.1.0,<2026.0.0)",
    "commonroad-clcs (>=2025.1.1,<2026.0.0)",
    "commonroad-drivability-checker (>=2025.1,<2026.0.0)",
    "matplotlib (>=3.5,<4.0)", # Although it makes more sense to include matplotlib in the visualization extra, it is used quite extensively throught the library and the codebase is not yet modular enough for this dependency to be optional.
    "typing-extensions (>=4.14.0,<5.0.0)",
    "pandas (>=2.3.0,<3.0.0)",
    # TODO: The following mpr dependencies are quite heavy. Maybe we can move them to an extra, to make the installation more lightweight for non-mpr use cases.
    "torch (>=2.7.1,<3.0.0)",
    "gpytorch (>=1.14,<2.0)",
    "shap (>=0.48.0,<0.49.0)",
]

[project.urls]
Documentation = "https://cps.pages.gitlab.lrz.de/commonroad/commonroad-stl-monitor"

[project.optional-dependencies]
visualization = [
    "matplot2tikz>=0.3.3",
    "pyqt6>=6.8.1",
    "networkx>=3.4.2",
    "pygraphviz>=1.14"
]
test = [
    "coverage[toml]>=6.5.0,<7.0.0",
    "pytest>=8.3.5,<9.0.0",
    "pytest-xdist[psutil]>=3.8.0"
]
docs = [
    "mkdocs (>=1.6, <2.0)",
    "mkdocstrings-python (>=1.10, <2.0)",
    "mkdocs-autorefs (>=1.0, <2.0)",
    "mkdocs-material (>=9.5, <10.0)",
]
dev = [
    "pre-commit>=3.7.1",
]


[tool.poetry]
packages = [
    {include = "crmonitor"},
    # Vendor rtamt directly to let omegaconf decide on the antlr version.
    # Also, the new rtamt versions (>3.5.0) are not published on PyPI.
    { from = "external/rtamt", include = "rtamt" }
]

[build-system]
requires = ["poetry-core"]
build-backend = "poetry.core.masonry.api"

[tool.ruff]
line-length = 100
indent-width = 4
format.quote-style = "double"
target-version = "py310"
src = ["crmonitor", "tests"]
# TODO: execept for fastl and external, all folders should be covered by ruff.
extend-exclude = ["crmonitor/rule/fastl/*.py", "tutorials/", "scenarios/", "external/rtamt", "tests/unit/predicates/*","scripts"]
# force exclude because pre-commit might pass those files explicitly, which will override the exclude.
force-exclude = true

[tool.ruff.lint]
select = ["E4", "E7", "E9", "I", "F"]

[tool.ruff.lint.per-file-ignores]
"__init__.py" = ["E402", "F401"]
