(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3785],{90988:function(e,t,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/systems",function(){return l(69955)}])},30952:function(e,t,l){"use strict";l.d(t,{f:function(){return o}});var s=l(24246),a=l(66726),n=l.n(a),i=l(27378),r=l(26917);let o=e=>{let{value:t,onChange:l,placeholder:a,...o}=e,[d,u]=(0,i.useState)(t);(0,i.useEffect)(()=>{u(t||"")},[t]);let c=n()(l,500),p=(0,i.useCallback)(e=>{u(e),c(e)},[]);return(0,s.jsx)(r.Z,{value:d,onChange:p,onClear:()=>{u(""),l("")},placeholder:a,...o})}},35287:function(e,t,l){"use strict";var s=l(24246),a=l(96306),n=l(88038),i=l.n(n);l(27378),t.Z=e=>{let{children:t,title:l,mainProps:n}=e;return(0,s.jsxs)(a.kCb,{"data-testid":l,direction:"column",height:"calc(100vh - 48px)",width:"calc(100vw - 240px)",children:[(0,s.jsxs)(i(),{children:[(0,s.jsxs)("title",{children:["Fides Admin UI - ",l]}),(0,s.jsx)("meta",{name:"description",content:"Privacy Engineering Platform"}),(0,s.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,s.jsx)(a.kCb,{px:10,py:6,as:"main",overflow:"auto",direction:"column",flex:1,minWidth:0,...n,children:t})]})}},34929:function(e,t,l){"use strict";var s=l(24246),a=l(64925),n=l.n(a),i=l(27378),r=l(16134),o=l(30002),d=l(28079),u=l(57072);let c=()=>{let{isLoading:e}=(0,d.fd)(),t=(0,r.C)(d.U3),{isLoading:l}=(0,u.MO)(),s=(0,r.C)(u.qb),{isLoading:a}=(0,o.te)();return{dataUses:t,dataSubjects:(0,r.C)(o.ZL),dataCategories:s,isLoading:e||l||a}};t.Z=()=>{let{dataUses:e,dataCategories:t,dataSubjects:l,isLoading:a}=c(),r=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return e.split(".").slice(0,t).join(".")},o=function(e,t){let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=t(e);if(!s)return{};let a=t(r(e,l)),n=!!s.parent_key;return{name:s.name||void 0,primaryName:n&&(null==a?void 0:a.name)!==s.name&&(null==a?void 0:a.name)||void 0}},d=function(e,t){let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,{name:a,primaryName:n}=o(e,t,l);return a?n?(0,s.jsxs)(i.Fragment,{children:[(0,s.jsxs)("strong",{children:[n,":"]})," ",a]},e):(0,s.jsx)("strong",{children:a},e):e},u=t=>n()(e,{fides_key:t}),p=e=>n()(t,{fides_key:e}),m=e=>n()(l,{fides_key:e});return{getDataUses:()=>e,getDataUseByKey:u,getDataUseDisplayName:e=>d(e,u,1),getDataUseDisplayNameProps:e=>o(e,u,1),getDataCategories:()=>t,getDataCategoryByKey:p,getDataCategoryDisplayName:e=>d(e,p,2),getDataCategoryDisplayNameProps:e=>o(e,p,2),getDataSubjects:()=>l,getDataSubjectByKey:m,getDataSubjectDisplayName:e=>{let t=m(e);return t?t.name:e},getPrimaryKey:r,isLoading:a}}},99640:function(e,t,l){"use strict";l.d(t,{Z:function(){return d}});var s=l(24246),a=l(96306),n=l(79894),i=l.n(n);let{Link:r,Text:o}=a.AntTypography,d=e=>{let{href:t,children:l,...a}=e;return t?(0,s.jsx)(i(),{href:t,passHref:!0,legacyBehavior:!0,children:(0,s.jsx)(r,{strong:!0,ellipsis:!0,onClick:e=>e.stopPropagation(),...a,children:l})}):(0,s.jsx)(o,{strong:!0,ellipsis:!0,...a,children:l})}},2525:function(e,t,l){"use strict";l.d(t,{Q:function(){return r}});var s=l(24246),a=l(96306),n=l(27378),i=l(3110);let r=e=>{let{values:t,columnState:l,tagProps:r,onTagClose:o,...d}=e,{isExpanded:u,isWrapped:c,version:p}=l||{},[m,g]=(0,n.useState)(!u),[y,h]=(0,n.useState)(!!c),[v,f]=(0,n.useState)(u?t:null==t?void 0:t.slice(0,2));(0,n.useEffect)(()=>{g(!u)},[u,p]),(0,n.useEffect)(()=>{h(!!c)},[c]),(0,n.useEffect)(()=>{(null==t?void 0:t.length)?f(m?t.slice(0,2):t):f(t)},[m,t]);let x=(0,n.useCallback)(()=>{f(null==t?void 0:t.slice(0,2)),g(!0)},[t]),j=(0,n.useCallback)(()=>{g(!1)},[]),k=(0,n.useCallback)(()=>{m?j():x()},[m,j,x]);return(0,n.useMemo)(()=>(null==v?void 0:v.length)?(0,s.jsxs)(a.jqI,{align:m?"center":"start",wrap:y?"wrap":"nowrap",vertical:!m,gap:"small","data-testid":"tag-expandable-cell",style:{overflowX:"auto",...d.style},...d,children:[v.map(e=>(0,s.jsx)(a.j8w,{color:"white","data-testid":e.key,onClose:o?()=>o(e.key):void 0,...r,...e.tagProps,children:(0,s.jsx)(a.lKn,{ellipsis:!!m&&{tooltip:!0},style:{color:"inherit",maxWidth:m?i.TD:void 0},children:e.label})},e.key)),t&&t.length>2&&(0,s.jsx)(a.wpx,{type:"link",size:"small",onClick:e=>{e.stopPropagation(),k()},className:"h-auto p-0",style:{fontSize:"var(--ant-font-size)"},children:m?"+".concat(t.length-2," more"):i.T5})]}):(0,s.jsx)("span",{"data-testid":"tag-expandable-cell-empty"}),[v,m,y,d,t,r,o,k])}},3110:function(e,t,l){"use strict";l.d(t,{DI:function(){return r},T5:function(){return n},TD:function(){return i}});var s=l(24246),a=l(96306);let n="show less",i=150,r=[{key:"expand-all",label:"Expand all",icon:(0,s.jsx)(a.PJP.jbG,{})},{key:"collapse-all",label:"Collapse all",icon:(0,s.jsx)(a.PJP.MVB,{})}]},26070:function(e,t,l){"use strict";l.d(t,{v:function(){return o},Q:function(){return d.Q}});var s=l(24246),a=l(96306),n=l(27378),i=l(3110);let{Text:r}=a.AntTypography,o=e=>{let{values:t,valueSuffix:l,columnState:o}=e,{isExpanded:d,version:u}=o||{},[c,p]=(0,n.useState)(!d);(0,n.useEffect)(()=>{p(!d)},[d,u]);let m=(0,n.useCallback)(()=>{p(!0)},[]),g=(0,n.useCallback)(()=>{p(!1)},[]),y=(0,n.useCallback)(()=>{c?g():m()},[c,g,m]);return(0,n.useMemo)(()=>(null==t?void 0:t.length)?1===t.length?(0,s.jsx)(r,{ellipsis:!0,"data-testid":"list-expandable-cell-single",children:t[0]}):(0,s.jsxs)(a.jqI,{align:c?"center":"flex-start",vertical:!c,gap:c?"small":"none","data-testid":"list-expandable-cell",children:[c?(0,s.jsxs)(r,{ellipsis:!0,children:[t.length," ",l]}):(0,s.jsx)(a.krs,{dataSource:t,renderItem:e=>(0,s.jsx)("li",{children:e})}),(0,s.jsx)(a.wpx,{type:"link",size:"small",onClick:e=>{e.stopPropagation(),y()},className:"h-auto p-0",style:{fontSize:"var(--ant-font-size)"},children:c?"view":i.T5})]}):null,[c,t,l,y])};var d=l(2525)},8125:function(e,t,l){"use strict";l.d(t,{V:function(){return n},o:function(){return d}});var s=l(27378),a=l(32735);let n=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{enableSelection:l=!1,getRowKey:n,bulkActions:i,isLoading:r=!1,isFetching:o=!1,dataSource:d=[],totalRows:u=0,currentPage:c,pageSize:p,customTableProps:m={}}=t,g=(0,s.useCallback)(e=>{if(e&&"object"==typeof e){if(e.id)return String(e.id);if(e.key)return String(e.key)}return String(e)},[]),y=n||g,[h,v]=(0,s.useState)([]),[f,x]=(0,s.useState)([]),j=(0,s.useCallback)(()=>{v([]),x([])},[]),k=(0,s.useMemo)(()=>({selectedRowKeys:h,selectedRows:f,resetSelections:j}),[h,f,j]),b=(0,s.useMemo)(()=>{if(l)return{selectedRowKeys:h,onChange:(e,t)=>{v(e),x(t)}}},[l,h]),S=(0,s.useCallback)((t,l,s)=>{var a,n;let i=null!==(a=t.current)&&void 0!==a?a:e.pageIndex,r=null!==(n=t.pageSize)&&void 0!==n?n:e.pageSize,o=i!==e.pageIndex||r!==e.pageSize;o?(t.current&&t.current!==e.pageIndex&&e.updatePageIndex(t.current),t.pageSize&&t.pageSize!==e.pageSize&&e.updatePageSize(t.pageSize)):e.updateFilters(l||{});let d=s&&!Array.isArray(s)?s.field:void 0,u=s&&!Array.isArray(s)&&null!==s.order?s.order:void 0;o||e.updateSorting(d,u)},[e]),C=(0,s.useMemo)(()=>{var t,l,s,n,i;return{current:null!=c?c:e.pageIndex,pageSize:null!=p?p:e.pageSize,total:u,showSizeChanger:null===(n=null===(t=e.paginationConfig)||void 0===t?void 0:t.showSizeChanger)||void 0===n||n,pageSizeOptions:null!==(i=null===(s=e.paginationConfig)||void 0===s?void 0:null===(l=s.pageSizeOptions)||void 0===l?void 0:l.map(String))&&void 0!==i?i:a.VZ}},[c,e.pageIndex,p,e.pageSize,u,e.paginationConfig]),_=(0,s.useMemo)(()=>({dataSource:d,loading:r||o,pagination:C,onChange:S,rowKey:y,scroll:{x:"max-content",scrollToFirstRowOnChange:!0},size:"small",bordered:!0,...m}),[d,r,o,C,S,y,m]),w=h.map(String),E=f.length>0,M=(0,s.useCallback)(e=>{let t=null==i?void 0:i.actions.find(t=>t.key===e);return t?{disabled:!E||!!t.disabled&&t.disabled(f),loading:t.loading||!1,onClick:()=>t.onClick(f)}:{disabled:!0,loading:!1}},[i,E,f]);return(0,s.useMemo)(()=>({tableProps:_,selectionProps:b,selectionState:k,selectedRows:f,selectedKeys:w,hasSelectedRows:E,resetSelections:j,getBulkActionProps:M,isLoadingOrFetching:r||o,hasData:d.length>0}),[_,b,k,f,w,E,j,M,r,o,d.length])};var i=l(40431),r=l(17245);let o=()=>({filters:(0,i.WJ)(e=>e).withDefault({})}),d=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{pagination:t={},sorting:l={},search:a={},onStateChange:n}=e,{pageIndex:d,pageSize:u,resetPagination:c,updatePageIndex:p,updatePageSize:m,pageSizeOptions:g,showSizeChanger:y}=(0,r.h0)(t),{sortKey:h,sortOrder:v,updateSorting:f,resetSorting:x}=(0,r.rK)(l),{searchQuery:j,updateSearch:k,resetSearch:b}=(0,r.Rx)(a),S=(0,s.useMemo)(()=>o(),[]),[C,_]=(0,i.XI)(S,{history:"push"}),w=(0,s.useMemo)(()=>{var e;return{pageIndex:d,pageSize:u,sortKey:h,sortOrder:v,columnFilters:null!==(e=C.filters)&&void 0!==e?e:{},searchQuery:j}},[C,d,u,h,v,j]),E=(0,s.useCallback)((e,t)=>{f(e,t),c()},[f,c]),M=(0,s.useCallback)(e=>{let t=Object.fromEntries(Object.entries(e).filter(e=>{let[,t]=e;return null!=t}));_({filters:Object.keys(t).length>0?t:null}),c()},[_,c]),O=(0,s.useCallback)(e=>{k(e),c()},[k,c]),T=(0,s.useCallback)(()=>{_({filters:null}),c(),x(),b()},[_,c,x,b]);return(0,s.useEffect)(()=>{n&&n(w)},[w,n]),{state:w,pageIndex:w.pageIndex,pageSize:w.pageSize,updatePageIndex:p,updatePageSize:m,sortKey:w.sortKey,sortOrder:w.sortOrder,updateSorting:E,columnFilters:w.columnFilters,updateFilters:M,searchQuery:w.searchQuery,updateSearch:O,resetState:T,paginationConfig:{pageSizeOptions:g,showSizeChanger:y}}}},33335:function(e,t,l){"use strict";l.d(t,{E:function(){return s}});let s=e=>e.toLowerCase().replace(/[ .]/g,"_").replace(/[^a-zA-Z0-9_<>-]/g,"")},92818:function(e,t,l){"use strict";l.d(t,{r:function(){return o}});var s=l(24246),a=l(27378),n=l(97181),i=l(22583),r=l(21910);let o={[r.Ej.TAXONOMY_WHITE]:"White",[r.Ej.TAXONOMY_RED]:"Red",[r.Ej.TAXONOMY_ORANGE]:"Orange",[r.Ej.TAXONOMY_YELLOW]:"Yellow",[r.Ej.TAXONOMY_GREEN]:"Green",[r.Ej.TAXONOMY_BLUE]:"Blue",[r.Ej.TAXONOMY_PURPLE]:"Purple",[r.Ej.SANDSTONE]:"Sandstone",[r.Ej.MINOS]:"Minos"},d=e=>{let{color:t,...l}=e;return(0,s.jsx)("span",{"aria-hidden":!0,className:"mr-2 inline-block size-4 rounded-lg align-middle",style:{backgroundColor:"var(--fidesui-bg-".concat(i.j[t],")"),border:t===r.Ej.TAXONOMY_WHITE?"1px solid var(--fidesui-neutral-200)":"none",...l.style}})},u=e=>{let t=null==e?void 0:e.value,l=null==e?void 0:e.label;return(0,s.jsxs)("span",{className:"flex items-center",children:[(0,s.jsx)(d,{color:t}),(0,s.jsx)("span",{children:l})]})};t.Z=e=>{let t=Object.values(r.Ej).map(e=>({value:e,label:o[e]})),[l,i]=(0,a.useState)(void 0);return(0,s.jsx)(n.d,{...e,options:t,optionRender:u,layout:"stacked",value:l,onChange:e=>{i(e)},prefix:(0,s.jsx)(d,{color:null!=l?l:r.Ej.TAXONOMY_WHITE,style:{marginBottom:"2px"}})})}},57072:function(e,t,l){"use strict";l.d(t,{Bd:function(){return s.Bd},L5:function(){return s.L5},MO:function(){return s.MO},qb:function(){return s.qb}});var s=l(5785)},69955:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return G}});var s=l(24246),a=l(96306),n=l(86677),i=l(27378),r=l(25980),o=l(35287),d=l(77830),u=l(58754),c=l(30952),p=l(812),m=l(65450),g=l(34090),y=l(83766),h=l.n(y),v=l(55484),f=l(97181),x=l(40324),j=l(28079),k=l(1315),b=l(92818);let S="all-suggested";var C=e=>{let{options:t,loading:l,name:n,suggestedDataUses:r,...o}=e,[d,u,{setValue:c}]=(0,g.U$)(n),p=!!(u.touched&&u.error),m=(0,i.useMemo)(()=>{let e=[],l=[];return null==t||t.forEach(t=>{r.includes(t.value)?e.push(t):l.push(t)}),{suggested:e,all:l}},[t,r]),y=m.suggested.length?[{label:"Select all suggested",value:S},{label:(0,s.jsxs)(a.jqI,{gap:"small",align:"center",children:[(0,s.jsx)(a.QMR,{}),(0,s.jsx)("strong",{children:"Suggested data uses"})]}),value:"suggested",options:m.suggested},{label:(0,s.jsxs)(a.jqI,{gap:"small",align:"center",children:[(0,s.jsx)(a.PJP.BBB,{}),(0,s.jsx)("strong",{children:"All data uses"})]}),value:"all",options:m.all}]:m.all;return(0,s.jsxs)(a.jqI,{vertical:!0,gap:"small",children:[(0,s.jsx)(a.jqI,{align:"center",children:(0,s.jsx)(x.__,{htmlFor:o.id||n,fontSize:"xs",my:0,mr:1,children:"Data uses"})}),(0,s.jsx)(a.WPr,{options:y,mode:"multiple",placeholder:"Select data uses",allowClear:!0,loading:l,value:d.value,onChange:e=>{e.includes(S)?c(h()([...r,...e.filter(e=>e!==S)])):c(e)},status:p?"error":void 0,virtual:!1,...o}),(0,s.jsx)(x.Bc,{isInvalid:p,message:u.error,fieldName:d.name})]})},_=l(21910);let w=v.Ry().shape({name:v.Z_().required("Name is required").label("Name"),label_color:v.Z_().required("Color is required").label("Color"),systems:v.IX().of(v.Z_()).label("Systems"),data_uses:v.IX().of(v.Z_()).label("Data uses")});var E=e=>{let{selectedSystemKeys:t=[],onSubmit:l,onCancel:n,isSubmitting:r=!1}=e,{data:o=[],isLoading:d}=(0,j.fd)(),{data:u,isLoading:c}=(0,k.K3)(),p=(0,i.useMemo)(()=>o.map(e=>({label:e.name||e.fides_key,value:e.fides_key})),[o]),m=(0,i.useMemo)(()=>{var e;let l=null!==(e=null==u?void 0:u.filter(e=>t.includes(e.fides_key)))&&void 0!==e?e:[];return h()(null==l?void 0:l.flatMap(e=>e.privacy_declarations.map(e=>e.data_use)))},[u,t]),y=(0,i.useMemo)(()=>{var e;return null!==(e=null==u?void 0:u.map(e=>({label:e.name||e.fides_key,value:e.fides_key})))&&void 0!==e?e:[]},[u]),v={name:"",description:"",label_color:_.Ej.TAXONOMY_WHITE,systems:t,data_uses:[],active:!0};return(0,s.jsx)(g.J9,{initialValues:v,validationSchema:w,onSubmit:l,enableReinitialize:!0,children:e=>{let{isValid:t,dirty:l}=e;return(0,s.jsx)(g.l0,{children:(0,s.jsxs)(a.jqI,{vertical:!0,gap:"middle",children:[(0,s.jsx)(a.AntTypography.Title,{level:2,children:"Create system group"}),(0,s.jsx)(x.j0,{name:"name",label:"Name",isRequired:!0,variant:"stacked",placeholder:"Enter system group name"}),(0,s.jsx)(x.Ks,{name:"description",label:"Description",variant:"stacked",placeholder:"Enter system group description",resize:!1}),(0,s.jsx)(f.d,{name:"systems",label:"Systems",mode:"multiple",placeholder:"Select systems",options:y,layout:"stacked",allowClear:!0,loading:c}),(0,s.jsx)(b.Z,{name:"label_color",label:"Color"}),(0,s.jsx)(C,{name:"data_uses",options:p,loading:d,suggestedDataUses:m}),(0,s.jsxs)(a.jqI,{gap:"small",justify:"space-between",className:"pt-4",children:[(0,s.jsx)(a.wpx,{onClick:n,disabled:r,children:"Cancel"}),(0,s.jsx)(a.wpx,{type:"primary",htmlType:"submit",loading:r,disabled:!t||!l||r,"data-testid":"save-btn",children:"Create group"})]})]})})}})},M=l(31793),O=l(31883),T=e=>{let{selectedRowKeys:t,createModalIsOpen:l,setCreateModalIsOpen:n,handleCreateSystemGroup:o,handleBulkAddToGroup:d,groupMenuItems:u}=e,[c,g]=a.Pg3.useMessage(),[y,h]=(0,i.useState)(!1),[v]=(0,m.WP)(),{plus:f}=(0,r.hz)(),{data:x}=(0,M.wv)({page:1,size:100,username:""}),[j]=(0,m.C9)(),k=(0,i.useCallback)(async e=>{let l=await v({data_steward:e,system_keys:t});(0,O.D4)(l)?c.error((0,p.e$)(l.error,"A problem occurred assigning stewards")):c.success("".concat(t.length," systems assigned to ").concat(e," successfully"))},[v,t,c]),b=async()=>{let e=await j(t);(0,O.D4)(e)?c.error((0,p.e$)(e.error,"A problem occurred deleting systems")):c.success("".concat(t.length," systems deleted successfully"))},S=(0,i.useMemo)(()=>{let e=[];return u.length&&f&&e.push(t.length?{key:"add-to-system-group",label:"Add to system group",children:[{key:"new-group",label:"Create new group +",onClick:()=>n(!0)},{type:"divider"},...u.map(e=>({key:e.key,label:e.label,onClick:()=>d(e.key)}))]}:{key:"new-group",label:"Create system group +",onClick:()=>n(!0)}),(null==x?void 0:x.items.length)&&e.push({key:"assign-data-steward",label:"Assign data steward",disabled:!t.length,children:x.items.map(e=>({key:e.username,label:e.username,onClick:()=>k(e.username)}))},{type:"divider"}),e.push({key:"delete",label:"Delete",disabled:!t.length,onClick:()=>{h(!0)}}),e},[u,f,null==x?void 0:x.items,t.length,n,d,k]);return(0,s.jsxs)(s.Fragment,{children:[g,(0,s.jsx)(a.$zI,{open:y,onCancel:()=>h(!1),onOk:b,okText:"Delete",okType:"danger",centered:!0,children:(0,s.jsxs)(a.AntTypography.Paragraph,{children:["Delete ",t.length," systems? This action cannot be undone."]})}),(0,s.jsx)(a.$zI,{open:l,destroyOnHidden:!0,onCancel:()=>n(!1),centered:!0,width:768,footer:null,children:(0,s.jsx)(E,{selectedSystemKeys:t.map(e=>e.toString()),onSubmit:o,onCancel:()=>n(!1)})}),(0,s.jsx)(a.S0p,{trigger:["click"],menu:{items:S},children:(0,s.jsx)(a.wpx,{icon:(0,s.jsx)(a.PJP._ME,{}),children:"Actions"})})]})},N=l(19904),D=l(26070),I=l(3110),A=l(99640),P=l(8125),z=l(16394),R=l(33335),q=l(69353),Z=l(88832),X=l(34929),F=e=>{let{privacyDeclarations:t,...l}=e,{getDataUseDisplayName:a}=(0,X.Z)(),n=t.map(e=>e.data_use).map(e=>({label:a(e),key:e}));return(0,s.jsx)(D.Q,{values:n,...l})},L=l(56141),W=l.n(L),B=l(22583);let Y="update-system-groups-msg";var J=e=>{let{selectedGroups:t,allGroups:l,system:n,columnState:r,...o}=e,[d,u]=(0,i.useState)(!1),[c,m]=(0,i.useState)(t.map(e=>e.fides_key)),[g,y]=a.Pg3.useMessage(),[h]=(0,k.qQ)(),v=async()=>{if(u(!1),W()(c,t.map(e=>e.fides_key)))return;g.open({key:Y,type:"loading",content:"Updating groups for ".concat(n.name,"...")});let e=await h({...n,system_groups:c});(0,O.D4)(e)?g.open({key:Y,type:"error",content:(0,p.e$)(e.error,"Failed to update system groups")}):g.open({key:Y,type:"success",content:"Groups updated for ".concat(n.name)}),setTimeout(()=>{g.destroy(Y)},3e3)};return(0,s.jsxs)(a.jqI,{gap:"small",...o,children:[y,!d&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.j8w,{onClick:()=>u(!0),addable:!0,"data-testid":"group-add-btn","aria-label":"Add group"}),(0,s.jsx)(D.Q,{values:t.map(e=>e&&{label:e.name,key:e.fides_key,tagProps:{color:e.label_color?"".concat(B.j[e.label_color]):void 0,bordered:!1}}),columnState:r})]}),d&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.WPr,{options:l.map(e=>({label:e.name,value:e.fides_key})),mode:"tags",defaultValue:t.map(e=>e.fides_key),defaultOpen:!0,onChange:e=>{m(e)}}),(0,s.jsx)(a.wpx,{icon:(0,s.jsx)(a.PJP.MCw,{}),onClick:v})]})]})},K=()=>{let{data:e}=(0,q.QD)(),t=(0,i.useMemo)(()=>e?e.reduce((e,t)=>({...e,[t.fides_key]:t}),{}):{},[e]),{data:l}=(0,M.wv)({page:1,size:100,username:""}),[o]=(0,m.DW)(),[d]=(0,q.Xz)(),[u]=(0,q.Nr)(),[c,g]=(0,i.useState)(!1),[y,v]=(0,i.useState)(!1),[f,x]=(0,i.useState)(!1),[j,k]=(0,i.useState)(!1),[b,S]=(0,i.useState)(null),C=(0,P.o)({pagination:{defaultPageSize:25,pageSizeOptions:[25,50,100]},search:{defaultSearchQuery:""},sorting:{defaultSortKey:Z.E.NAME,defaultSortOrder:"ascend",validColumns:[Z.E.NAME]}}),{columnFilters:w,pageIndex:E,pageSize:T,searchQuery:X,updateSearch:L,sortKey:W,sortOrder:B}=C,{data:Y,isLoading:K,isFetching:U}=(0,m.xF)({page:E,size:T,search:X,sort_by:W,sort_asc:"ascend"===B,show_deleted:!0,...w}),G=(0,i.useMemo)(()=>{var e,t;return{enableSelection:!0,dataSource:null!==(e=null==Y?void 0:Y.items)&&void 0!==e?e:[],totalRows:null!==(t=null==Y?void 0:Y.total)&&void 0!==t?t:0,isLoading:K,isFetching:U,getRowKey:e=>e.fides_key,customTableProps:{locale:{emptyText:(0,s.jsx)("div",{children:"No systems found"})}}}},[Y,K,U]),{tableProps:Q,selectionProps:$}=(0,P.V)(C,G),{selectedRowKeys:V}=null!=$?$:{},[H,ee]=a.Pg3.useMessage(),{plus:et}=(0,r.hz)(),el=(0,n.useRouter)(),es=(0,N.Tg)([_.Sh.SYSTEM_DELETE]),ea=async e=>{let t=await o(e.fides_key);(0,O.D4)(t)?H.error((0,p.e$)(t.error,"Failed to delete system")):H.success("Successfully deleted system"),k(!1)},en=async e=>{let t={...e,fides_key:(0,R.E)(e.name),active:!0},l=await u(t);if((0,O.D4)(l))H.error((0,p.e$)(l.error));else{var s,a;let e="System group '".concat(l.data.name,"' created");(null===(s=l.data.systems)||void 0===s?void 0:s.length)===1?e+=" with system '".concat(l.data.systems[0],"'"):(null===(a=l.data.systems)||void 0===a?void 0:a.length)&&(e+=" with ".concat(l.data.systems.length," systems")),H.success(e)}x(!1)},ei=(0,i.useCallback)(async e=>{var l;if(!V)return;let s=t[e],a=await d({...s,systems:h()([...null!==(l=s.systems)&&void 0!==l?l:[],...V.map(e=>e.toString())])});(0,O.D4)(a)?H.error((0,p.e$)(a.error)):H.success("".concat(null==V?void 0:V.length," systems added to group '").concat(e,"'"))},[t,d,V,H]),er=(0,i.useMemo)(()=>{var t;return null!==(t=null==e?void 0:e.map(e=>({key:e.fides_key,label:e.name,onClick:()=>ei(e.fides_key)})))&&void 0!==t?t:[]},[e,ei]);return{tableProps:Q,selectionProps:$,columns:(0,i.useMemo)(()=>{var n;return[{title:"Name",dataIndex:"name",key:Z.E.NAME,render:(e,t)=>(0,s.jsx)(A.Z,{href:"/systems/configure/".concat(t.fides_key),"data-testid":"system-link-".concat(t.fides_key),children:e||t.fides_key}),ellipsis:!0,fixed:"left",sorter:!0,sortOrder:W===Z.E.NAME?B:null},{dataIndex:"system_groups",key:Z.E.SYSTEM_GROUPS,render:(l,a)=>{var n;return(0,s.jsx)(J,{selectedGroups:null!==(n=null==l?void 0:l.map(e=>null==t?void 0:t[e]).filter(e=>!!e))&&void 0!==n?n:[],allGroups:e,system:{...a,system_groups:null!=l?l:[]},columnState:{isWrapped:!0,isExpanded:c},className:"w-96"})},title:"Groups",hidden:!et,menu:{items:I.DI,onClick:e=>{e.domEvent.stopPropagation(),"expand-all"===e.key?g(!0):"collapse-all"===e.key&&g(!1)}},filters:(0,z.nZ)(null==e?void 0:e.map(e=>e.fides_key),e=>{var l,s;return null!==(s=null===(l=t[e])||void 0===l?void 0:l.name)&&void 0!==s?s:e}),filteredValue:(null==w?void 0:w.system_groups)||null},{title:"Data uses",menu:{items:I.DI,onClick:e=>{e.domEvent.stopPropagation(),"expand-all"===e.key?v(!0):"collapse-all"===e.key&&v(!1)}},dataIndex:"privacy_declarations",key:Z.E.DATA_USES,render:e=>(0,s.jsx)(F,{privacyDeclarations:e,columnState:{isWrapped:!0,isExpanded:y}})},{title:"Data stewards",dataIndex:"data_stewards",key:Z.E.DATA_STEWARDS,render:e=>(0,s.jsx)(D.v,{values:null!=e?e:[],valueSuffix:"users"}),filters:(0,z.nZ)(null==l?void 0:null===(n=l.items)||void 0===n?void 0:n.map(e=>e.username)),filteredValue:(null==w?void 0:w.data_stewards)||null},{title:"Description",dataIndex:"description",key:Z.E.DESCRIPTION,render:e=>(0,s.jsx)("div",{className:"max-w-96",children:(0,s.jsx)(a.AntTypography.Text,{ellipsis:{tooltip:e},children:e})}),ellipsis:!0},{title:"Actions",key:Z.E.ACTIONS,render:(e,t)=>(0,s.jsx)(a.kCb,{justify:"end",children:(0,s.jsx)(a.S0p,{trigger:["click"],menu:{items:[{key:"edit",label:"Edit",icon:(0,s.jsx)(a.PJP.I8b,{}),onClick:()=>el.push("/systems/configure/".concat(t.fides_key))},...es?[{key:"delete",label:"Delete",icon:(0,s.jsx)(a.PJP.ZNm,{}),onClick:()=>{S(t),k(!0)}}]:[]]},children:(0,s.jsx)(a.wpx,{size:"small",icon:(0,s.jsx)(a.PJP.r43,{}),"aria-label":"More actions",type:"text","data-testid":"system-actions-menu"})})}),fixed:"right"}]},[W,B,et,e,null==w?void 0:w.system_groups,null==w?void 0:w.data_steward,null==l?void 0:l.items,c,t,y,es,el]),searchQuery:X,updateSearch:L,columnFilters:w,pageIndex:E,pageSize:T,createModalIsOpen:f,setCreateModalIsOpen:x,deleteModalIsOpen:j,setDeleteModalIsOpen:k,setSelectedSystemForDelete:S,handleCreateSystemGroup:en,handleDelete:ea,handleBulkAddToGroup:ei,messageContext:ee,groupMenuItems:er,selectedSystemForDelete:b}},U=()=>{var e,t;let{tableProps:l,selectionProps:n,columns:i,searchQuery:r,updateSearch:o,createModalIsOpen:d,setCreateModalIsOpen:u,deleteModalIsOpen:p,setDeleteModalIsOpen:m,handleDelete:g,handleCreateSystemGroup:y,handleBulkAddToGroup:h,messageContext:v,groupMenuItems:f,selectedSystemForDelete:x}=K();return(0,s.jsxs)(s.Fragment,{children:[v,(0,s.jsxs)(a.jqI,{justify:"space-between",className:"mb-4",children:[(0,s.jsx)(c.f,{value:r,onChange:o,"data-testid":"system-search"}),(0,s.jsxs)(a.jqI,{gap:"small",children:[(0,s.jsx)(T,{selectedRowKeys:null!==(e=null==n?void 0:n.selectedRowKeys)&&void 0!==e?e:[],createModalIsOpen:d,setCreateModalIsOpen:u,handleCreateSystemGroup:y,handleBulkAddToGroup:h,groupMenuItems:f}),(0,s.jsx)(a.$zI,{open:p,onCancel:()=>m(!1),onOk:()=>!!x&&g(x),okText:"Delete",okType:"danger",cancelText:"Cancel",centered:!0,children:(0,s.jsxs)(a.AntTypography.Paragraph,{children:["Are you sure you want to delete"," ",null!==(t=null==x?void 0:x.name)&&void 0!==t?t:null==x?void 0:x.fides_key,"? This action cannot be undone."]})})]})]}),(0,s.jsx)(a.V5H,{...l,columns:i,rowSelection:n})]})},G=()=>{let e=(0,n.useRouter)(),{dictionaryService:t}=(0,r.hz)();return(0,s.jsx)(o.Z,{title:"System inventory",children:(0,s.jsxs)(a.xuv,{"data-testid":"system-management",children:[(0,s.jsxs)(u.Z,{heading:"System inventory",breadcrumbItems:[{title:"All systems"}],children:[t&&(0,s.jsx)(a.S0p,{trigger:["click"],menu:{items:[{label:"Create new system",key:"add-system",onClick:()=>e.push(d.N5)},{label:"Add multiple systems",key:"add-multiple-systems",onClick:()=>e.push(d.bJ)}]},children:(0,s.jsx)(a.wpx,{type:"primary","data-testid":"add-system-btn",icon:(0,s.jsx)(a.PJP._ME,{}),className:"absolute right-8 top-8",children:"Add system"})}),!t&&(0,s.jsx)(a.wpx,{type:"primary","data-testid":"add-system-btn",onClick:()=>e.push(d.N5),children:"Add new system"})]}),(0,s.jsx)(U,{})]})})}},31883:function(e,t,l){"use strict";l.d(t,{Bw:function(){return s.Bw},D4:function(){return s.D4}});var s=l(19043)}},function(e){e.O(0,[8765,431,9278,5163,1896,4718,2888,9774,179],function(){return e(e.s=90988)}),_N_E=e.O()}]);