(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2815],{24081:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/messaging",function(){return s(18504)}])},35287:function(e,t,s){"use strict";var i=s(24246),n=s(20595),a=s(88038),r=s.n(a);s(27378),t.Z=e=>{let{children:t,title:s,mainProps:a}=e;return(0,i.jsxs)(n.kCb,{"data-testid":s,direction:"column",height:"calc(100vh - 48px)",width:"calc(100vw - 240px)",children:[(0,i.jsxs)(r(),{children:[(0,i.jsxs)("title",{children:["Fides Admin UI - ",s]}),(0,i.jsx)("meta",{name:"description",content:"Privacy Engineering Platform"}),(0,i.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,i.jsx)(n.kCb,{px:10,py:6,as:"main",overflow:"auto",direction:"column",flex:1,minWidth:0,...a,children:t})]})}},87361:function(e,t,s){"use strict";var i=s(24246),n=s(20595);t.Z=e=>{let{title:t,text:s,onClose:a}=e;return(0,i.jsxs)(n.Ugi,{backgroundColor:"gray.50",border:"1px solid",borderRadius:"md",justifyContent:"space-between",py:4,pr:6,pl:3,"data-testid":"empty-state",gap:2,position:"relative",children:[a&&(0,i.jsx)(n.Two,{boxSize:5,position:"absolute",right:3,top:3,zIndex:1,cursor:"pointer",p:1,onClick:a}),(0,i.jsx)(n.iid,{alignSelf:"start",color:"minos",mt:.5,flexGrow:0}),(0,i.jsxs)(n.kCb,{direction:"column",gap:2,flexGrow:1,children:[(0,i.jsx)(n.X6q,{fontSize:"md",children:t}),(0,i.jsx)(n.xvT,{fontSize:"sm",color:"gray.600",lineHeight:"5",children:s})]})]})}},58754:function(e,t,s){"use strict";var i=s(24246),n=s(20595),a=s(70788);t.Z=e=>{let{heading:t,breadcrumbItems:s,isSticky:r=!0,children:l,rightContent:o,style:c,...d}=e;return(0,i.jsxs)("div",{...d,style:r?{position:"sticky",top:"-24px",paddingTop:"24px",paddingBottom:"24px",paddingLeft:"40px",marginLeft:"-40px",paddingRight:"40px",marginRight:"-40px",marginTop:"-24px",left:0,zIndex:20,backgroundColor:"white",...c}:{paddingBottom:"24px",...c},children:[(0,i.jsxs)(n.jqI,{justify:"space-between",children:["string"==typeof t?(0,i.jsx)(n.lQT,{className:s||l?"pb-4":void 0,level:1,"data-testid":"page-heading",children:t}):t,o&&(0,i.jsx)("div",{"data-testid":"page-header-right-content",children:o})]}),!!s&&(0,i.jsx)(a.m,{className:l?"pb-4":void 0,items:s,"data-testid":"page-breadcrumb"}),l]})}},70788:function(e,t,s){"use strict";s.d(t,{m:function(){return c}});var i=s(24246),n=s(20595),a=s(79894),r=s.n(a),l=s(27378);let{Text:o}=n.AntTypography,c=e=>{let{items:t,...s}=e,a=(0,l.useMemo)(()=>null==t?void 0:t.map((e,s)=>{let a=s===t.length-1,l={...e},c=l.onClick&&!l.href;return("string"==typeof l.title&&(l.title=(0,i.jsx)(o,{style:{color:"inherit",maxWidth:a?void 0:400},ellipsis:!a,id:a?"breadcrumb-current-page":void 0,children:l.title})),c)?l.title=(0,i.jsx)(n.wpx,{type:"text",size:"small",icon:l.icon,onClick:l.onClick,className:"ant-breadcrumb-link -mt-px px-1 text-inherit",children:l.title}):(l.icon&&(l.title=(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{className:"anticon align-text-bottom",children:l.icon}),l.title]})),l.href&&l.title&&(l.title=(0,i.jsx)(r(),{href:l.href,className:"ant-breadcrumb-link",children:l.title}),delete l.href)),l}),[t]);return(0,i.jsx)(n.zrq,{items:a,...s})}},67810:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}}),(i=n||(n={})).PRIVACY_REQUEST_REVIEW_APPROVE="privacy_request_review_approve",i.PRIVACY_REQUEST_REVIEW_DENY="privacy_request_review_deny",i.PRIVACY_REQUEST_RECEIPT="privacy_request_receipt",i.PRIVACY_REQUEST_COMPLETE_ACCESS="privacy_request_complete_access",i.PRIVACY_REQUEST_COMPLETE_DELETION="privacy_request_complete_deletion",i.SUBJECT_IDENTITY_VERIFICATION="subject_identity_verification",i.MANUAL_TASK_DIGEST="manual_task_digest";var i,n,a={[n.PRIVACY_REQUEST_COMPLETE_ACCESS]:"Access request completed",[n.PRIVACY_REQUEST_COMPLETE_DELETION]:"Erasure request completed",[n.PRIVACY_REQUEST_RECEIPT]:"Privacy request received",[n.PRIVACY_REQUEST_REVIEW_APPROVE]:"Privacy request approved",[n.PRIVACY_REQUEST_REVIEW_DENY]:"Privacy request denied",[n.SUBJECT_IDENTITY_VERIFICATION]:"Subject identity verification",[n.MANUAL_TASK_DIGEST]:"Manual task digest"}},5058:function(e,t,s){"use strict";s.d(t,{Vw:function(){return a},ms:function(){return i},pS:function(){return n},vm:function(){return r}});let{useGetSummaryMessagingTemplatesQuery:i,usePutMessagingTemplateByIdMutation:n,useCreateMessagingTemplateByTypeMutation:a,usePatchMessagingTemplateByIdMutation:r}=s(78780).u.injectEndpoints({endpoints:e=>({getSummaryMessagingTemplates:e.query({query:e=>({method:"GET",url:"plus/messaging/templates/summary",params:e}),providesTags:()=>["Property-Specific Messaging Templates"]}),putMessagingTemplateById:e.mutation({query:e=>{let{templateId:t,template:s}=e;return{url:"plus/messaging/templates/".concat(t),method:"PUT",body:s}},invalidatesTags:()=>["Property-Specific Messaging Templates"]}),patchMessagingTemplateById:e.mutation({query:e=>{let{templateId:t,template:s}=e;return{url:"plus/messaging/templates/".concat(t),method:"PATCH",body:s}},invalidatesTags:()=>["Property-Specific Messaging Templates"]}),createMessagingTemplateByType:e.mutation({query:e=>{let{templateType:t,template:s}=e;return{url:"plus/messaging/templates/".concat(t),method:"POST",body:s}},invalidatesTags:()=>["Property-Specific Messaging Templates"]})})})},18504:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return M}});var i=s(24246),n=s(92222),a=s(59003),r=s(20595),l=s(95099),o=s.n(l),c=s(86677),d=s(27378),p=s(35287),u=s(71795),m=s(87361),g=s(46238),x=s(77830),h=s(58754),f=s(47935),j=s(42904),_=s(7426),y=s(67810),v=e=>{let{isOpen:t,onClose:s,onAccept:n}=e,[a,l]=(0,d.useState)(void 0),o=Object.keys(y.Z).map(e=>({value:e,label:y.Z[e]}));return(0,i.jsxs)(r.u_l,{isOpen:t,onClose:s,size:"2xl",isCentered:!0,children:[(0,i.jsx)(r.ZAr,{}),(0,i.jsxs)(r.hzk,{"data-testid":"add-messaging-template-modal",children:[(0,i.jsx)(r.xBx,{borderBottomWidth:1,fontWeight:"bold",children:"Select message template"}),(0,i.jsxs)(r.fef,{children:[(0,i.jsx)(r.xvT,{color:"gray.700",fontWeight:"medium",fontSize:"sm",marginBottom:3,marginTop:1,children:"Add a new email message by selecting a template below and clicking accept."}),(0,i.jsx)(r.xvT,{color:"gray.700",fontSize:"sm",fontWeight:"medium",marginBottom:2,children:"Choose template:"}),(0,i.jsx)(r.xuv,{"data-testid":"template-type-selector",children:(0,i.jsx)(r.WPr,{options:o,onChange:e=>{l(e)},className:"w-full","aria-label":"Select a template"})})]}),(0,i.jsx)(r.mzw,{justifyContent:"flex-start",children:(0,i.jsxs)("div",{className:"flex w-full gap-4",children:[(0,i.jsx)(r.wpx,{onClick:s,"data-testid":"cancel-btn",className:"grow",children:"Cancel"}),(0,i.jsx)(r.wpx,{onClick:()=>n(a),type:"primary","data-testid":"confirm-btn",disabled:!a,className:"grow",children:"Next"})]})})]})]})},b=s(5058),E=s(812),T=s(46628),C=s(31883),w=()=>{let e=(0,r.pmc)(),[t]=(0,b.vm)();return{toggleIsTemplateEnabled:(0,d.useCallback)(async s=>{let{isEnabled:i,templateId:n}=s,a=await t({templateId:n,template:{is_enabled:i}});if((0,C.D4)(a)){e((0,T.Vo)((0,E.e$)(a.error)));return}e((0,T.t5)("Messaging template ".concat(i?"enabled":"disabled")))},[t,e])}},R=s(64826);let S=(0,n.Cl)(),P={items:[],total:0,page:1,size:50,pages:1},I=()=>(0,i.jsx)(r.gCW,{mt:6,p:10,spacing:4,borderRadius:"base",maxW:"70%","data-testid":"no-results-notice",alignSelf:"center",margin:"auto",textAlign:"center",children:(0,i.jsxs)(r.gCW,{children:[(0,i.jsx)(r.xvT,{fontSize:"md",fontWeight:"600",children:"It looks like it’s your first time here!"}),(0,i.jsxs)(r.xvT,{fontSize:"sm",children:["Add new email templates with the ",'"Add message +"'," button.",(0,i.jsx)("br",{})]})]})}),k=()=>{let{isLoading:e,data:t}=(0,R.gz)({page:1,size:100}),s=null==t?void 0:t.items.filter(e=>!e.messaging_templates||0===e.messaging_templates.length),n=!!(!e&&(null==s?void 0:s.length)),a="missing-messages-notice-".concat(null==s?void 0:s.map(e=>e.id).join("-")),[l,o]=(0,u._)("notices.dismissedMessageNoticeId",""),c=a===l;return n&&!c?(0,i.jsx)(r.xuv,{mb:6,"data-testid":"notice-properties-without-messaging-templates",children:(0,i.jsx)(m.Z,{title:"Not all properties have messages configured.",text:(0,i.jsxs)(r.xvT,{as:"span",children:["You have properties that do not have messages configured. Users who submit privacy requests for these properties may not receive the necessary emails regarding their requests."," ",(0,i.jsx)(r.xuv,{as:"span",children:(0,i.jsx)(g.b,{label:null==s?void 0:s.map(e=>e.name).join(", ")})})]}),onClose:()=>{o(a)}})}):null},A=()=>{let{data:e}=(0,_.tB)({api_set:!1});return(null==e?void 0:e.notifications.enable_property_specific_messaging)?null:(0,i.jsx)(r.xuv,{mb:6,"data-testid":"notice-properties-without-messaging-templates",children:(0,i.jsx)(m.Z,{title:"Basic messaging enabled",text:(0,i.jsxs)(r.xvT,{as:"span",children:["In basic messaging mode, you can edit the content of your messages from this screen. Please note that in basic messaging, the “Enable” toggle does not apply. Fides also supports property specific messaging mode. Read our"," ",(0,i.jsx)(r.rUS,{href:"https://fid.es/property-specific-messaging",target:"_blank",rel:"nofollow",textDecoration:"underline",children:"docs"})," ","for more information about property specific mode or contact"," ",(0,i.jsx)(r.rUS,{href:"mailto:support@ethyca.com",textDecoration:"underline",children:"Ethyca support"})," ","to enable this mode on your Fides instance."]})})})};var M=()=>{let e=(0,c.useRouter)(),{toggleIsTemplateEnabled:t}=w(),{PAGE_SIZES:s,pageSize:l,setPageSize:u,onPreviousPageClick:m,isPreviousPageDisabled:g,onNextPageClick:_,isNextPageDisabled:E,startRange:T,endRange:C,pageIndex:R,setTotalPages:M}=(0,f.oi)(),{data:N,isLoading:z,isFetching:V}=(0,b.ms)({page:R,size:l}),{items:q,total:U,pages:O}=(0,d.useMemo)(()=>null!=N?N:P,[N]);(0,d.useEffect)(()=>{M(O)},[O,M]);let[W,B]=(0,d.useState)(!1),D=(0,d.useMemo)(()=>[S.accessor(e=>e.type,{id:"message",cell:e=>(0,i.jsx)(f.G3,{value:y.Z[e.getValue()]}),header:e=>(0,i.jsx)(f.Rr,{value:"Message",...e}),size:150}),S.accessor(e=>(e.properties||[]).map(e=>e.name),{id:"properties",cell:e=>(0,i.jsx)(f.WP,{suffix:"properties",value:e.getValue(),...e}),header:e=>(0,i.jsx)(f.Rr,{value:"Properties",...e}),meta:{showHeaderMenu:!0},size:250}),S.accessor(e=>e.is_enabled,{id:"is_enabled",cell:e=>(0,i.jsx)(r.kCb,{align:"center",justifyContent:"flex-start",w:"full",h:"full",children:(0,i.jsx)(r.rAg,{checked:e.getValue(),onChange:s=>{t({isEnabled:s,templateId:e.row.original.id})}})}),header:e=>(0,i.jsx)(f.Rr,{value:"Enable",...e}),size:200,meta:{disableRowClick:!0}})],[t]),Y=(0,d.useMemo)(()=>o()(q,"id"),[q]),L=(0,a.b7)({getCoreRowModel:(0,n.sC)(),getFilteredRowModel:(0,n.vL)(),getSortedRowModel:(0,n.tj)(),columns:D,data:Y,columnResizeMode:"onChange"});return(0,i.jsxs)(p.Z,{title:"Messaging",children:[(0,i.jsx)(h.Z,{heading:"Messaging"}),(0,i.jsx)(A,{}),(0,i.jsx)(k,{}),(0,i.jsx)(f.Q$,{children:(0,i.jsx)(r.Ugi,{alignItems:"center",spacing:4,marginLeft:"auto",children:(0,i.jsx)(r.wpx,{type:"primary","data-testid":"add-message-btn",onClick:()=>B(!0),children:"Add message +"})})}),z?(0,i.jsx)(f.I4,{rowHeight:36,numRows:15}):(0,i.jsx)(f.ZK,{tableInstance:L,onRowClick:t=>{e.push({pathname:x.ax,query:{id:t.id}})},emptyTableNotice:(0,i.jsx)(I,{})}),(0,i.jsx)(j.s8,{totalRows:U||0,pageSizes:s,setPageSize:u,onPreviousPageClick:m,isPreviousPageDisabled:g||V,onNextPageClick:_,isNextPageDisabled:E||V,startRange:T,endRange:C}),(0,i.jsx)(v,{isOpen:W,onClose:()=>B(!1),onAccept:t=>{e.push({pathname:x.sM,query:{templateType:t}})}})]})}},31883:function(e,t,s){"use strict";s.d(t,{Bw:function(){return i.Bw},D4:function(){return i.D4}});var i=s(19043)}},function(e){e.O(0,[8765,9278,346,2888,9774,179],function(){return e(e.s=24081)}),_N_E=e.O()}]);