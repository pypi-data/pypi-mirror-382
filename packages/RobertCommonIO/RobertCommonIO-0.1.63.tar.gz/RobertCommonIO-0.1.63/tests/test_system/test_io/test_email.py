from robertcommonio.system.io.email import EmailAccessor, EmailConfig


def test_send():
    body = '<table color="CCCC33" width="900" border="1" cellspacing="0" cellpadding="7" text-align="center">\
                            <tr>\
                                    <td text-align="center">名称</td>\
                                    <td text-align="center">状态</td>\
                                    <td text-align="center">执行时间</td>\
                                    <td text-align="center">最后成功时间</td>\
                                    <td text-align="center">接口类型</td>\
                                    <td text-align="center">调用方式</td>\
                                    <td text-align="center">接口地址</td>\
                            </tr>   \
                            <tr><td text-align="center">实时应急措施</td><td text-align="center">上传成功</td><td text-align="center">2019-05-16 09:44:45</td><td text-align="center">2019-05-16 09:44:45</td><td text-align="center">HTTP</td><td text-align="center">Client/POST</td><td text-align="center">http://58.246.92.70:20201/cloud/base/sendMsgOri</td></tr><tr><td text-align="center">上传进出口计划</td><td text-align="center">上传成功</td><td text-align="center">2020-01-13 19:15:07</td><td text-align="center">2020-01-13 19:15:07</td><td text-align="center">HTTP</td><td text-align="center">Client/POST</td><td text-align="center">http://58.40.127.69:8180/gangcheng/cargoimport/import</td></tr><tr><td text-align="center">箱位信息</td><td text-align="center">调用成功</td><td text-align="center">2020-01-13 19:24:39</td><td text-align="center">2020-01-13 19:24:39</td><td text-align="center">HTTP</td><td text-align="center">Server/GET</td><td text-align="center">/GetSeatMap</td></tr><tr><td text-align="center">车辆GPS上传(客/GET)</td><td text-align="center">上传成功</td><td text-align="center">2018-12-26 15:19:17</td><td text-align="center">2018-12-26 15:19:17</td><td text-align="center">HTTP</td><td text-align="center">Server/GET</td><td text-align="center">/UploadVehicleGPSRecordV1</td></tr><tr><td text-align="center">移箱接口</td><td text-align="center">上传成功</td><td text-align="center">2019-05-30 15:28:10</td><td text-align="center">2019-05-30 15:28:10</td><td text-align="center">HTTP</td><td text-align="center">Server/POST</td><td text-align="center">/CYMove</td></tr><tr><td text-align="center">仓库温湿度数据</td><td text-align="center">上传成功</td><td text-align="center">2020-01-13 19:23:19</td><td text-align="center">2020-01-13 19:23:19</td><td text-align="center">HTTP</td><td text-align="center">Server/POST</td><td text-align="center">/GCWareHouseV1</td></tr><tr><td text-align="center">门状态接口</td><td text-align="center">上传成功</td><td text-align="center">2019-09-28 13:06:23</td><td text-align="center">2019-09-28 13:06:23</td><td text-align="center">HTTP</td><td text-align="center">Server/POST</td><td text-align="center">/UploadDoorRecord</td></tr><tr><td text-align="center">上传行走轨迹记录</td><td text-align="center">上传成功</td><td text-align="center">2018-07-28 18:10:24</td><td text-align="center">2018-07-28 18:10:24</td><td text-align="center">HTTP</td><td text-align="center">Server/POST</td><td text-align="center">/UploadGPSRecord</td></tr><tr><td text-align="center">上传PLAN_NO记录</td><td text-align="center">上传成功</td><td text-align="center">2020-01-13 19:01:18</td><td text-align="center">2020-01-13 19:01:18</td><td text-align="center">HTTP</td><td text-align="center">Server/POST</td><td text-align="center">/UploadPlanRecord</td></tr><tr><td text-align="center">车辆GPS上传(客)</td><td text-align="center">上传成功</td><td text-align="center">2020-01-13 19:25:10</td><td text-align="center">2020-01-13 19:25:10</td><td text-align="center">HTTP</td><td text-align="center">Server/POST</td><td text-align="center">/UploadVehicleGPSRecord</td></tr><tr><td text-align="center">车辆GPS上传(客/POST)</td><td text-align="center">上传成功</td><td text-align="center">2020-01-13 19:25:10</td><td text-align="center">2020-01-13 19:25:10</td><td text-align="center">HTTP</td><td text-align="center">Server/POST</td><td text-align="center">/UploadVehicleGPSRecordV2</td></tr><tr><td text-align="center">Gas嗅探</td><td text-align="center">上传成功</td><td text-align="center">2020-01-13 19:25:04</td><td text-align="center">2020-01-13 19:25:04</td><td text-align="center">HTTP</td><td text-align="center">Server/POST</td><td text-align="center">/gcapi/v1/gas_detect</td></tr><tr><td text-align="center">同步箱子程序</td><td text-align="center">同步成功</td><td text-align="center">2020-01-13 19:25:10</td><td text-align="center">2020-01-13 19:25:10</td><td text-align="center">ORACLE</td><td text-align="center">Client</td><td text-align="center">None</td></tr><tr><td text-align="center">10.192.90.151基站</td><td text-align="center">轮询成功</td><td text-align="center">2020-01-13 19:25:06</td><td text-align="center">2020-01-13 19:25:06</td><td text-align="center">TCP</td><td text-align="center">Client</td><td text-align="center">10.192.90.151:4196</td></tr><tr><td text-align="center">10.192.90.153基站</td><td text-align="center">轮询成功</td><td text-align="center">2020-01-13 19:25:06</td><td text-align="center">2020-01-13 19:25:06</td><td text-align="center">TCP</td><td text-align="center">Client</td><td text-align="center">10.192.90.153:4196</td></tr><tr><td text-align="center">10.192.90.154基站</td><td text-align="center">轮询成功</td><td text-align="center">2020-01-13 19:25:08</td><td text-align="center">2020-01-13 19:25:08</td><td text-align="center">TCP</td><td text-align="center">Client</td><td text-align="center">10.192.90.154:4196</td></tr><tr><td text-align="center">10.192.90.158基站</td><td text-align="center">轮询成功</td><td text-align="center">2020-01-13 19:24:59</td><td text-align="center">2020-01-13 19:24:59</td><td text-align="center">TCP</td><td text-align="center">Client</td><td text-align="center">10.192.90.158:4196</td></tr><tr><td text-align="center">10.192.90.159基站</td><td text-align="center">轮询成功</td><td text-align="center">2020-01-13 19:24:46</td><td text-align="center">2020-01-13 19:24:46</td><td text-align="center">TCP</td><td text-align="center">Client</td><td text-align="center">10.192.90.159:4196</td></tr><tr><td text-align="center">周界报警</td><td text-align="center">上传成功</td><td text-align="center">2020-01-13 13:12:42</td><td text-align="center">2020-01-13 13:12:42</td><td text-align="center">UDP</td><td text-align="center">Server</td><td text-align="center">192.168.0.108:11111</td></tr>\
                    </table> '

    EmailAccessor(EmailConfig(HOST='smtp.163.com', PORT=25, USER='hxdx_gc2020', PSW='gc12345678', FROM='hxdx_gc2020@163.com')).send_email('851010070@qq.com', [['名称', '状态', '执行时间'], ['名称1', ('状态2', 'color:#FF0000'), '执行时间3']], '报警邮件4')


def test_send_office():
    body = '<table color="CCCC33" width="900" border="1" cellspacing="0" cellpadding="7" text-align="center">\
                            <tr>\
                                    <td text-align="center">名称</td>\
                                    <td text-align="center">状态</td>\
                                    <td text-align="center">执行时间</td>\
                                    <td text-align="center">最后成功时间</td>\
                                    <td text-align="center">接口类型</td>\
                                    <td text-align="center">调用方式</td>\
                                    <td text-align="center">接口地址</td>\
                            </tr>   \
                            <tr><td text-align="center">实时应急措施</td><td text-align="center">上传成功</td><td text-align="center">2019-05-16 09:44:45</td><td text-align="center">2019-05-16 09:44:45</td><td text-align="center">HTTP</td><td text-align="center">Client/POST</td><td text-align="center">http://58.246.92.70:20201/cloud/base/sendMsgOri</td></tr><tr><td text-align="center">上传进出口计划</td><td text-align="center">上传成功</td><td text-align="center">2020-01-13 19:15:07</td><td text-align="center">2020-01-13 19:15:07</td><td text-align="center">HTTP</td><td text-align="center">Client/POST</td><td text-align="center">http://58.40.127.69:8180/gangcheng/cargoimport/import</td></tr><tr><td text-align="center">箱位信息</td><td text-align="center">调用成功</td><td text-align="center">2020-01-13 19:24:39</td><td text-align="center">2020-01-13 19:24:39</td><td text-align="center">HTTP</td><td text-align="center">Server/GET</td><td text-align="center">/GetSeatMap</td></tr><tr><td text-align="center">车辆GPS上传(客/GET)</td><td text-align="center">上传成功</td><td text-align="center">2018-12-26 15:19:17</td><td text-align="center">2018-12-26 15:19:17</td><td text-align="center">HTTP</td><td text-align="center">Server/GET</td><td text-align="center">/UploadVehicleGPSRecordV1</td></tr><tr><td text-align="center">移箱接口</td><td text-align="center">上传成功</td><td text-align="center">2019-05-30 15:28:10</td><td text-align="center">2019-05-30 15:28:10</td><td text-align="center">HTTP</td><td text-align="center">Server/POST</td><td text-align="center">/CYMove</td></tr><tr><td text-align="center">仓库温湿度数据</td><td text-align="center">上传成功</td><td text-align="center">2020-01-13 19:23:19</td><td text-align="center">2020-01-13 19:23:19</td><td text-align="center">HTTP</td><td text-align="center">Server/POST</td><td text-align="center">/GCWareHouseV1</td></tr><tr><td text-align="center">门状态接口</td><td text-align="center">上传成功</td><td text-align="center">2019-09-28 13:06:23</td><td text-align="center">2019-09-28 13:06:23</td><td text-align="center">HTTP</td><td text-align="center">Server/POST</td><td text-align="center">/UploadDoorRecord</td></tr><tr><td text-align="center">上传行走轨迹记录</td><td text-align="center">上传成功</td><td text-align="center">2018-07-28 18:10:24</td><td text-align="center">2018-07-28 18:10:24</td><td text-align="center">HTTP</td><td text-align="center">Server/POST</td><td text-align="center">/UploadGPSRecord</td></tr><tr><td text-align="center">上传PLAN_NO记录</td><td text-align="center">上传成功</td><td text-align="center">2020-01-13 19:01:18</td><td text-align="center">2020-01-13 19:01:18</td><td text-align="center">HTTP</td><td text-align="center">Server/POST</td><td text-align="center">/UploadPlanRecord</td></tr><tr><td text-align="center">车辆GPS上传(客)</td><td text-align="center">上传成功</td><td text-align="center">2020-01-13 19:25:10</td><td text-align="center">2020-01-13 19:25:10</td><td text-align="center">HTTP</td><td text-align="center">Server/POST</td><td text-align="center">/UploadVehicleGPSRecord</td></tr><tr><td text-align="center">车辆GPS上传(客/POST)</td><td text-align="center">上传成功</td><td text-align="center">2020-01-13 19:25:10</td><td text-align="center">2020-01-13 19:25:10</td><td text-align="center">HTTP</td><td text-align="center">Server/POST</td><td text-align="center">/UploadVehicleGPSRecordV2</td></tr><tr><td text-align="center">Gas嗅探</td><td text-align="center">上传成功</td><td text-align="center">2020-01-13 19:25:04</td><td text-align="center">2020-01-13 19:25:04</td><td text-align="center">HTTP</td><td text-align="center">Server/POST</td><td text-align="center">/gcapi/v1/gas_detect</td></tr><tr><td text-align="center">同步箱子程序</td><td text-align="center">同步成功</td><td text-align="center">2020-01-13 19:25:10</td><td text-align="center">2020-01-13 19:25:10</td><td text-align="center">ORACLE</td><td text-align="center">Client</td><td text-align="center">None</td></tr><tr><td text-align="center">10.192.90.151基站</td><td text-align="center">轮询成功</td><td text-align="center">2020-01-13 19:25:06</td><td text-align="center">2020-01-13 19:25:06</td><td text-align="center">TCP</td><td text-align="center">Client</td><td text-align="center">10.192.90.151:4196</td></tr><tr><td text-align="center">10.192.90.153基站</td><td text-align="center">轮询成功</td><td text-align="center">2020-01-13 19:25:06</td><td text-align="center">2020-01-13 19:25:06</td><td text-align="center">TCP</td><td text-align="center">Client</td><td text-align="center">10.192.90.153:4196</td></tr><tr><td text-align="center">10.192.90.154基站</td><td text-align="center">轮询成功</td><td text-align="center">2020-01-13 19:25:08</td><td text-align="center">2020-01-13 19:25:08</td><td text-align="center">TCP</td><td text-align="center">Client</td><td text-align="center">10.192.90.154:4196</td></tr><tr><td text-align="center">10.192.90.158基站</td><td text-align="center">轮询成功</td><td text-align="center">2020-01-13 19:24:59</td><td text-align="center">2020-01-13 19:24:59</td><td text-align="center">TCP</td><td text-align="center">Client</td><td text-align="center">10.192.90.158:4196</td></tr><tr><td text-align="center">10.192.90.159基站</td><td text-align="center">轮询成功</td><td text-align="center">2020-01-13 19:24:46</td><td text-align="center">2020-01-13 19:24:46</td><td text-align="center">TCP</td><td text-align="center">Client</td><td text-align="center">10.192.90.159:4196</td></tr><tr><td text-align="center">周界报警</td><td text-align="center">上传成功</td><td text-align="center">2020-01-13 13:12:42</td><td text-align="center">2020-01-13 13:12:42</td><td text-align="center">UDP</td><td text-align="center">Server</td><td text-align="center">192.168.0.108:11111</td></tr>\
                    </table> '

    EmailAccessor(EmailConfig(HOST='smtp.office365.com', PORT=587, USER='xiezhilong1222@outlook.com', PSW='fvoiktmtpamehnhs', FROM='xiezhilong1222@outlook.com')).send_email('851010070@qq.com', [('text', '邮件附件测试'), ('table', [['名称', '状态', '执行时间'], ['名称1', ('状态2', 'color:#FF0000'), '执行时间3']]), ('file', r'E:\snap7.dll')], '报警邮件4')
    print('Success')


def test_ssl():
    try:
        EmailAccessor(EmailConfig(HOST='smtpdm.aliyun.com', PORT=25, USER='best@warning.bestshchina.com', PSW='BESTshwarning01', ENABLE_SSL=False, FROM='best@warning.bestshchina.com')).send_email('robert.luo@rnbtechgroup.com', [('table', [['编号', '报警ID', '报警级别', '报警内容', '报警分组', '发送原因']])], f"测试邮件", '')
        print('send success')
    except Exception as e:
        print(f"send fail({e.__str__()})")
    print()


test_ssl()