"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[793],{1793:($,F,c)=>{c.r(F),c.d(F,{ITextMateTokenizationService:()=>N.S,default:()=>Ot});var G={};c.r(G),c.d(G,{default:()=>_t});var x=c(10467),ne=c(60595),N=c(46343),W=c(48952),p=c(38035),_e=c(48792),oe=c(37106),Q=c(67197),Me=c(70447),w=c(52814),H=c(2744),ze=(c(30056),c(28323)),ie=c(53899),me=c(93319),v=c(88206),P=c(86714),re=c(99843),Ee=c(32412),f=c(25501),se=c(81856),pe=c(99396),ke=c(98039),Ie=c(25552),ae=c(65178),Ae=c(8527),Pe=c(76922),Te=c(71846),De=c(44392),Ne=c(48738),je=c(66205);class Oe extends w.jG{constructor(s,e,n,o,i,t,r){super(),this._grammar=s,this._initialState=e,this._containsEmbeddedLanguages=n,this._createBackgroundTokenizer=o,this._backgroundTokenizerShouldOnlyVerifyTokens=i,this._reportTokenizationTime=t,this._reportSlowTokenization=r,this._seenLanguages=[],this._onDidEncounterLanguage=this._register(new Ne.vl),this.onDidEncounterLanguage=this._onDidEncounterLanguage.event}get backgroundTokenizerShouldOnlyVerifyTokens(){return this._backgroundTokenizerShouldOnlyVerifyTokens()}getInitialState(){return this._initialState}tokenize(s,e,n){throw new Error("Not supported!")}createBackgroundTokenizer(s,e){if(this._createBackgroundTokenizer)return this._createBackgroundTokenizer(s,e)}tokenizeEncoded(s,e,n){const o=1e4*Math.random()<1,i=this._reportSlowTokenization||o,t=i?new je.W(!0):void 0,r=this._grammar.tokenizeLine2(s,n,500);if(i){const d=t.elapsed();(o||d>32)&&this._reportTokenizationTime(d,s.length,o)}if(r.stoppedEarly)return console.warn(`Time limit reached when tokenizing line: ${s.substring(0,100)}`),new P.rY(r.tokens,n);if(this._containsEmbeddedLanguages){const d=this._seenLanguages,a=r.tokens;for(let g=0,m=a.length>>>1;g<m;g++){const C=v.xn.getLanguageId(a[1+(g<<1)]);d[C]||(d[C]=!0,this._onDidEncounterLanguage.fire(C))}}let l;return l=n.equals(r.ruleStack)?n:r.ruleStack,new P.rY(r.tokens,l)}}var Re=c(420),de=c(26986);class Be extends w.jG{get backgroundTokenizerShouldOnlyVerifyTokens(){return this._actual.backgroundTokenizerShouldOnlyVerifyTokens}constructor(s,e,n,o){super(),this._encodedLanguageId=s,this._actual=e,this._maxTokenizationLineLength=o,this._register((0,de.wp)(this._maxTokenizationLineLength)),this._register(n)}getInitialState(){return this._actual.getInitialState()}tokenize(s,e,n){throw new Error("Not supported!")}tokenizeEncoded(s,e,n){return s.length>=this._maxTokenizationLineLength.get()?(0,Re.Lh)(this._encodedLanguageId,n):this._actual.tokenizeEncoded(s,e,n)}createBackgroundTokenizer(s,e){if(this._actual.createBackgroundTokenizer)return this._actual.createBackgroundTokenizer(s,e)}}var Fe=c(48408);let Ge=(()=>{class h{static{this.CHANNEL_NAME="textMateWorkerHost"}static getChannel(e){return e.getChannel(h.CHANNEL_NAME)}static setChannel(e,n){e.setChannel(h.CHANNEL_NAME,n)}}return h})();var Ve=c(6934),$e=c(17851),ce=c(97653),We=c(41566),ye=c(54600),Qe=c(29863);class He{constructor(s){this.edits=s.slice().sort((0,oe.VE)(e=>e.offset,oe.U9))}applyToArray(s){for(let e=this.edits.length-1;e>=0;e--){const n=this.edits[e];s.splice(n.offset,n.length,...new Array(n.newLength))}}}class Ue{constructor(s,e,n){this.offset=s,this.length=e,this.newLength=n}toString(){return`[${this.offset}, +${this.length}) -> +${this.newLength}}`}}class U{static fromMany(s){const e=s.map(n=>new U(n));return new Je(e)}constructor(s){this.transformation=s,this.idx=0,this.offset=0}transform(s){let e=this.transformation.edits[this.idx];for(;e&&e.offset+e.length<=s;)this.offset+=e.newLength-e.length,this.idx++,e=this.transformation.edits[this.idx];if(!(e&&e.offset<=s))return s+this.offset}}class Je{constructor(s){this.transformers=s}transform(s){for(const e of this.transformers){const n=e.transform(s);if(void 0===n)return;s=n}return s}}var Ke=c(88411);let Ye=(()=>{class h extends w.jG{static{this._id=0}constructor(e,n,o,i,t,r){super(),this._model=e,this._worker=n,this._languageIdCodec=o,this._backgroundTokenizationStore=i,this._configurationService=t,this._maxTokenizationLineLength=r,this.controllerId=h._id++,this._pendingChanges=[],this._states=new We.CQ,this._loggingEnabled=(0,Qe.V)("editor.experimental.asyncTokenizationLogging",!1,this._configurationService),this._register((0,de.wp)(this._loggingEnabled)),this._register(this._model.onDidChangeContent(a=>{this._shouldLog&&console.log("model change",{fileName:this._model.uri.fsPath.split("\\").pop(),changes:le(a.changes)}),this._worker.$acceptModelChanged(this.controllerId,a),this._pendingChanges.push(a)})),this._register(this._model.onDidChangeLanguage(a=>{const g=this._model.getLanguageId(),m=this._languageIdCodec.encodeLanguageId(g);this._worker.$acceptModelLanguageChanged(this.controllerId,g,m)}));const l=this._model.getLanguageId(),d=this._languageIdCodec.encodeLanguageId(l);this._worker.$acceptNewModel({uri:this._model.uri,versionId:this._model.getVersionId(),lines:this._model.getLinesContent(),EOL:this._model.getEOL(),languageId:l,encodedLanguageId:d,maxTokenizationLineLength:this._maxTokenizationLineLength.get(),controllerId:this.controllerId}),this._register((0,Ke.fm)(a=>{const g=this._maxTokenizationLineLength.read(a);this._worker.$acceptMaxTokenizationLineLength(this.controllerId,g)}))}dispose(){super.dispose(),this._worker.$acceptRemovedModel(this.controllerId)}requestTokens(e,n){this._worker.$retokenize(this.controllerId,e,n)}setTokensAndStates(e,n,o,i){var t=this;return(0,x.A)(function*(){if(t.controllerId!==e)return;let r=ye.Z.deserialize(new Uint8Array(o));if(t._shouldLog&&console.log("received background tokenization result",{fileName:t._model.uri.fsPath.split("\\").pop(),updatedTokenLines:r.map(d=>d.getLineRange()).join(" & "),updatedStateLines:i.map(d=>new $e.M(d.startLineNumber,d.startLineNumber+d.stateDeltas.length).toString()).join(" & ")}),t._shouldLog){const d=t._pendingChanges.filter(a=>a.versionId<=n).map(a=>a.changes).map(a=>le(a)).join(" then ");console.log("Applying changes to local states",d)}for(;t._pendingChanges.length>0&&t._pendingChanges[0].versionId<=n;){const d=t._pendingChanges.shift();t._states.acceptChanges(d.changes)}if(t._pendingChanges.length>0){if(t._shouldLog){const g=t._pendingChanges.map(m=>m.changes).map(m=>le(m)).join(" then ");console.log("Considering non-processed changes",g)}const d=U.fromMany(t._pendingChanges.map(g=>ve(g.changes))),a=new ye.Z;for(const g of r)for(let m=g.startLineNumber;m<=g.endLineNumber;m++)void 0!==d.transform(m-1)&&a.add(m,g.getLineTokens(m));r=a.finalize();for(const g of t._pendingChanges)for(const m of g.changes)for(let k=0;k<r.length;k++)r[k].applyEdit(m.range,m.text)}const l=U.fromMany(t._pendingChanges.map(d=>ve(d.changes)));if(!t._applyStateStackDiffFn||!t._initialState){const{applyStateStackDiff:d,INITIAL:a}=yield c.e(704).then(c.t.bind(c,50704,19)).then(g=>g.default??g);t._applyStateStackDiffFn=d,t._initialState=a}for(const d of i){let a=d.startLineNumber<=1?t._initialState:t._states.getEndState(d.startLineNumber-1);for(let g=0;g<d.stateDeltas.length;g++){const m=d.stateDeltas[g];let k;m?(k=t._applyStateStackDiffFn(a,m),t._states.setEndState(d.startLineNumber+g,k)):k=t._states.getEndState(d.startLineNumber+g);const C=l.transform(d.startLineNumber+g-1);void 0!==C&&t._backgroundTokenizationStore.setEndState(C+1,k),d.startLineNumber+g>=t._model.getLineCount()-1&&t._backgroundTokenizationStore.backgroundTokenizationFinished(),a=k}}t._backgroundTokenizationStore.setTokens(r)})()}get _shouldLog(){return this._loggingEnabled.get()}}return h})();function ve(h){return new He(h.map(s=>new Ue(s.range.startLineNumber-1,s.range.endLineNumber-s.range.startLineNumber+1,(0,Ve.W)(s.text)[0]+1)))}function le(h){return h.map(s=>ce.Q.lift(s.range).toString()+" => "+s.text).join(" & ")}var J,Ze=c(34879);let ge=class{static{J=this}static{this._reportedMismatchingTokens=!1}constructor(e,n,o,i,t,r,l){this._reportTokenizationTime=e,this._shouldTokenizeAsync=n,this._extensionResourceLoaderService=o,this._configurationService=i,this._languageService=t,this._notificationService=r,this._telemetryService=l,this._workerProxyPromise=null,this._worker=null,this._workerProxy=null,this._workerTokenizerControllers=new Map,this._currentTheme=null,this._currentTokenColorMap=null,this._grammarDefinitions=[]}dispose(){this._disposeWorker()}createBackgroundTokenizer(e,n,o){var i=this;if(!this._shouldTokenizeAsync()||e.isTooLargeForSyncing())return;const t=new w.Cm,r=this._getWorkerProxy().then(l=>{if(t.isDisposed||!l)return;const d={controller:void 0,worker:this._worker};return t.add(function Xe(h,s){const e=new w.Cm,n=e.add(new w.Cm);function o(){h.isAttachedToEditor()?n.add(s()):n.clear()}return o(),e.add(h.onDidChangeAttached(()=>{o()})),e}(e,()=>{const a=new Ye(e,l,this._languageService.languageIdCodec,n,this._configurationService,o);return d.controller=a,this._workerTokenizerControllers.set(a.controllerId,a),(0,w.s)(()=>{d.controller=void 0,this._workerTokenizerControllers.delete(a.controllerId),a.dispose()})})),d});return{dispose(){t.dispose()},requestTokens:(l=(0,x.A)(function*(d,a){const g=yield r;g?.controller&&g.worker===i._worker&&g.controller.requestTokens(d,a)}),function(a,g){return l.apply(this,arguments)}),reportMismatchingTokens:l=>{J._reportedMismatchingTokens||(J._reportedMismatchingTokens=!0,this._notificationService.error({message:"Async Tokenization Token Mismatch in line "+l,name:"Async Tokenization Token Mismatch"}),this._telemetryService.publicLog2("asyncTokenizationMismatchingTokens",{}))}};var l}setGrammarDefinitions(e){this._grammarDefinitions=e,this._disposeWorker()}acceptTheme(e,n){this._currentTheme=e,this._currentTokenColorMap=n,this._currentTheme&&this._currentTokenColorMap&&this._workerProxy&&this._workerProxy.$acceptTheme(this._currentTheme,this._currentTokenColorMap)}_getWorkerProxy(){return this._workerProxyPromise||(this._workerProxyPromise=this._createWorkerProxy()),this._workerProxyPromise}_createWorkerProxy(){var e=this;return(0,x.A)(function*(){const n={grammarDefinitions:e._grammarDefinitions,onigurumaWASMUri:new URL(c(6670),c.b).href},o=e._worker=(0,Ze.V3)(H.zl.asBrowserUri("vs/workbench/services/textMate/browser/backgroundTokenization/worker/textMateTokenizationWorker.workerMain.js"),"TextMateWorker");return Ge.setChannel(o,{$readFile:(i=(0,x.A)(function*(t){const r=Fe.rz.revive(t);return e._extensionResourceLoaderService.readExtensionResource(r)}),function(r){return i.apply(this,arguments)}),$setTokensAndStates:function(){var i=(0,x.A)(function*(t,r,l,d){const a=e._workerTokenizerControllers.get(t);a&&a.setTokensAndStates(t,r,l,d)});return function(r,l,d,a){return i.apply(this,arguments)}}(),$reportTokenizationTime:(i,t,r,l,d)=>{e._reportTokenizationTime(i,t,r,l,d)}}),yield o.proxy.$init(n),e._worker!==o?null:(e._workerProxy=o.proxy,e._currentTheme&&e._currentTokenColorMap&&e._workerProxy.$acceptTheme(e._currentTheme,e._currentTokenColorMap),o.proxy);var i})()}_disposeWorker(){for(const e of this._workerTokenizerControllers.values())e.dispose();this._workerTokenizerControllers.clear(),this._worker&&(this._worker.dispose(),this._worker=null),this._workerProxy=null,this._workerProxyPromise=null}};ge=J=(0,p.C)([(0,p.Q)(2,pe.j),(0,p.Q)(3,se.p),(0,p.Q)(4,re.L),(0,p.Q)(5,ae.O),(0,p.Q)(6,Te.k)],ge);class qe{constructor(){this._scopeNameToLanguageRegistration=Object.create(null)}reset(){this._scopeNameToLanguageRegistration=Object.create(null)}register(s){this._scopeNameToLanguageRegistration[s.scopeName]=s}getGrammarDefinition(s){return this._scopeNameToLanguageRegistration[s]||null}}const K="No TM Grammar registered for this language.";class et extends w.jG{constructor(s,e,n,o){var i,t;super(),i=this,this._host=s,this._initialState=n.INITIAL,this._scopeRegistry=new qe,this._injections={},this._injectedEmbeddedLanguages={},this._languageToScope=new Map,this._grammarRegistry=this._register(new n.Registry({onigLib:o,loadGrammar:(t=(0,x.A)(function*(r){const l=i._scopeRegistry.getGrammarDefinition(r);if(!l)return i._host.logTrace(`No grammar found for scope ${r}`),null;const d=l.location;try{const a=yield i._host.readFile(d);return n.parseRawGrammar(a,d.path)}catch(a){return i._host.logError(`Unable to load and parse grammar for scope ${r} from ${d}`,a),null}}),function(l){return t.apply(this,arguments)}),getInjections:t=>{const r=t.split(".");let l=[];for(let d=1;d<=r.length;d++){const a=r.slice(0,d).join(".");l=[...l,...this._injections[a]||[]]}return l}}));for(const t of e){if(this._scopeRegistry.register(t),t.injectTo){for(const r of t.injectTo){let l=this._injections[r];l||(this._injections[r]=l=[]),l.push(t.scopeName)}if(t.embeddedLanguages)for(const r of t.injectTo){let l=this._injectedEmbeddedLanguages[r];l||(this._injectedEmbeddedLanguages[r]=l=[]),l.push(t.embeddedLanguages)}}t.language&&this._languageToScope.set(t.language,t.scopeName)}}has(s){return this._languageToScope.has(s)}setTheme(s,e){this._grammarRegistry.setTheme(s,e)}getColorMap(){return this._grammarRegistry.getColorMap()}createGrammar(s,e){var n=this;return(0,x.A)(function*(){const o=n._languageToScope.get(s);if("string"!=typeof o)throw new Error(K);const i=n._scopeRegistry.getGrammarDefinition(o);if(!i)throw new Error(K);const t=i.embeddedLanguages;if(n._injectedEmbeddedLanguages[o]){const d=n._injectedEmbeddedLanguages[o];for(const a of d)for(const g of Object.keys(a))t[g]=a[g]}const r=Object.keys(t).length>0;let l;try{l=yield n._grammarRegistry.loadGrammarWithConfiguration(o,e,{embeddedLanguages:t,tokenTypes:i.tokenTypes,balancedBracketSelectors:i.balancedBracketSelectors,unbalancedBracketSelectors:i.unbalancedBracketSelectors})}catch(d){throw d.message&&d.message.startsWith("No grammar provided for")?new Error(K):d}return{languageId:s,grammar:l,initialState:n._initialState,containsEmbeddedLanguages:r,sourceExtensionId:i.sourceExtensionId}})()}}var Y=c(98604),tt=c(33561);const z=Y.g1.registerExtensionPoint({extensionPoint:"grammars",deps:[tt.b],jsonSchema:{description:(0,f.kg)(12579,"Contributes textmate tokenizers."),type:"array",defaultSnippets:[{body:[{language:"${1:id}",scopeName:"source.${2:id}",path:"./syntaxes/${3:id}.tmLanguage."}]}],items:{type:"object",defaultSnippets:[{body:{language:"${1:id}",scopeName:"source.${2:id}",path:"./syntaxes/${3:id}.tmLanguage."}}],properties:{language:{description:(0,f.kg)(12580,"Language identifier for which this syntax is contributed to."),type:"string"},scopeName:{description:(0,f.kg)(12581,"Textmate scope name used by the tmLanguage file."),type:"string"},path:{description:(0,f.kg)(12582,"Path of the tmLanguage file. The path is relative to the extension folder and typically starts with './syntaxes/'."),type:"string"},embeddedLanguages:{description:(0,f.kg)(12583,"A map of scope name to language id if this grammar contains embedded languages."),type:"object"},tokenTypes:{description:(0,f.kg)(12584,"A map of scope name to token types."),type:"object",additionalProperties:{enum:["string","comment","other"]}},injectTo:{description:(0,f.kg)(12585,"List of language scope names to which this grammar is injected to."),type:"array",items:{type:"string"}},balancedBracketScopes:{description:(0,f.kg)(12586,"Defines which scope names contain balanced brackets."),type:"array",items:{type:"string"},default:["*"]},unbalancedBracketScopes:{description:(0,f.kg)(12587,"Defines which scope names do not contain balanced brackets."),type:"array",items:{type:"string"},default:[]}},required:["scopeName","path"]}}});var j,Se=c(78017);let ue=class extends w.jG{static{j=this}static{this.reportTokenizationTimeCounter={sync:0,async:0}}constructor(e,n,o,i,t,r,l,d,a,g){super(),this._languageService=e,this._themeService=n,this._extensionResourceLoaderService=o,this._notificationService=i,this._logService=t,this._configurationService=r,this._progressService=l,this._environmentService=d,this._instantiationService=a,this._telemetryService=g,this._createdModes=[],this._encounteredLanguages=[],this._debugMode=!1,this._debugModePrintFunc=()=>{},this._grammarDefinitions=null,this._grammarFactory=null,this._tokenizersRegistrations=this._register(new w.Cm),this._currentTheme=null,this._currentTokenColorMap=null,this._threadedBackgroundTokenizerFactory=this._instantiationService.createInstance(ge,(m,k,C,M,L)=>this._reportTokenizationTime(m,k,C,M,!0,L),()=>this.getAsyncTokenizationEnabled()),this._vscodeOniguruma=null,this._styleElement=(0,_e.li)(),this._styleElement.className="vscode-tokens-styles",z.setHandler(m=>this._handleGrammarsExtPoint(m)),this._updateTheme(this._themeService.getColorTheme(),!0),this._register(this._themeService.onDidColorThemeChange(()=>{this._updateTheme(this._themeService.getColorTheme(),!1)})),this._register(this._languageService.onDidRequestRichLanguageFeatures(m=>{this._createdModes.push(m)}))}getAsyncTokenizationEnabled(){return!!this._configurationService.getValue("editor.experimental.asyncTokenization")}getAsyncTokenizationVerification(){return!!this._configurationService.getValue("editor.experimental.asyncTokenizationVerification")}_handleGrammarsExtPoint(e){this._grammarDefinitions=null,this._grammarFactory&&(this._grammarFactory.dispose(),this._grammarFactory=null),this._tokenizersRegistrations.clear(),this._grammarDefinitions=[];for(const n of e){const o=n.value;for(const i of o){const t=this._validateGrammarDefinition(n,i);if(t&&(this._grammarDefinitions.push(t),t.language)){const r=new P.v_(()=>this._createTokenizationSupport(t.language));this._tokenizersRegistrations.add(r),this._tokenizersRegistrations.add(P.dG.registerFactory(t.language,r))}}}this._threadedBackgroundTokenizerFactory.setGrammarDefinitions(this._grammarDefinitions);for(const n of this._createdModes)P.dG.getOrCreate(n)}_validateGrammarDefinition(e,n){if(!function it(h,s,e,n){if(s.language&&("string"!=typeof s.language||!n.isRegisteredLanguageId(s.language)))return e.error((0,f.kg)(12572,"Unknown language in `contributes.{0}.language`. Provided value: {1}",z.name,String(s.language))),!1;if(!s.scopeName||"string"!=typeof s.scopeName)return e.error((0,f.kg)(12573,"Expected string in `contributes.{0}.scopeName`. Provided value: {1}",z.name,String(s.scopeName))),!1;if(!s.path||"string"!=typeof s.path)return e.error((0,f.kg)(12574,"Expected string in `contributes.{0}.path`. Provided value: {1}",z.name,String(s.path))),!1;if(s.injectTo&&(!Array.isArray(s.injectTo)||s.injectTo.some(i=>"string"!=typeof i)))return e.error((0,f.kg)(12575,"Invalid value in `contributes.{0}.injectTo`. Must be an array of language scope names. Provided value: {1}",z.name,JSON.stringify(s.injectTo))),!1;if(s.embeddedLanguages&&!(0,me.Gv)(s.embeddedLanguages))return e.error((0,f.kg)(12576,"Invalid value in `contributes.{0}.embeddedLanguages`. Must be an object map from scope name to language. Provided value: {1}",z.name,JSON.stringify(s.embeddedLanguages))),!1;if(s.tokenTypes&&!(0,me.Gv)(s.tokenTypes))return e.error((0,f.kg)(12577,"Invalid value in `contributes.{0}.tokenTypes`. Must be an object map from scope name to token type. Provided value: {1}",z.name,JSON.stringify(s.tokenTypes))),!1;const o=(0,ie.uJ)(h,s.path);return(0,ie._1)(o,h)||e.warn((0,f.kg)(12578,"Expected `contributes.{0}.path` ({1}) to be included inside extension's folder ({2}). This might make the extension non-portable.",z.name,o.path,h.path)),!0}(e.description.extensionLocation,n,e.collector,this._languageService))return null;const o=(0,ie.uJ)(e.description.extensionLocation,n.path),i=Object.create(null);if(n.embeddedLanguages){const d=Object.keys(n.embeddedLanguages);for(let a=0,g=d.length;a<g;a++){const m=d[a],k=n.embeddedLanguages[m];"string"==typeof k&&this._languageService.isRegisteredLanguageId(k)&&(i[m]=this._languageService.languageIdCodec.encodeLanguageId(k))}}const t=Object.create(null);if(n.tokenTypes){const d=Object.keys(n.tokenTypes);for(const a of d)switch(n.tokenTypes[a]){case"string":t[a]=v.Vy.String;break;case"other":t[a]=v.Vy.Other;break;case"comment":t[a]=v.Vy.Comment}}function l(d,a){return Array.isArray(d)&&d.every(g=>"string"==typeof g)?d:a}return{location:o,language:n.language&&this._languageService.isRegisteredLanguageId(n.language)?n.language:void 0,scopeName:n.scopeName,embeddedLanguages:i,tokenTypes:t,injectTo:n.injectTo,balancedBracketSelectors:l(n.balancedBracketScopes,["*"]),unbalancedBracketSelectors:l(n.unbalancedBracketScopes,[]),sourceExtensionId:e.description.id}}startDebugMode(e,n){this._debugMode?this._notificationService.error((0,f.kg)(12568,"Already Logging.")):(this._debugModePrintFunc=e,this._debugMode=!0,this._debugMode&&this._progressService.withProgress({location:Ae.Nq.Notification,buttons:[(0,f.kg)(12569,"Stop")]},o=>(o.report({message:(0,f.kg)(12570,"Preparing to log TM Grammar parsing. Press Stop when finished.")}),this._getVSCodeOniguruma().then(i=>(i.setDefaultDebugCall(!0),o.report({message:(0,f.kg)(12571,"Now logging TM Grammar parsing. Press Stop when finished.")}),new Promise((t,r)=>{})))),o=>{this._getVSCodeOniguruma().then(i=>{this._debugModePrintFunc=()=>{},this._debugMode=!1,i.setDefaultDebugCall(!1),n()})}))}_canCreateGrammarFactory(){return!!this._grammarDefinitions}_getOrCreateGrammarFactory(){var e=this;return(0,x.A)(function*(){if(e._grammarFactory)return e._grammarFactory;const[n,o]=yield Promise.all([c.e(704).then(c.t.bind(c,50704,19)).then(t=>t.default??t),e._getVSCodeOniguruma()]),i=Promise.resolve({createOnigScanner:t=>o.createOnigScanner(t),createOnigString:t=>o.createOnigString(t)});return e._grammarFactory||(e._grammarFactory=new et({logTrace:t=>e._logService.trace(t),logError:(t,r)=>e._logService.error(t,r),readFile:t=>e._extensionResourceLoaderService.readExtensionResource(t)},e._grammarDefinitions||[],n,i),e._updateTheme(e._themeService.getColorTheme(),!0)),e._grammarFactory})()}_createTokenizationSupport(e){var n=this;return(0,x.A)(function*(){if(!n._languageService.isRegisteredLanguageId(e)||!n._canCreateGrammarFactory())return null;try{const o=yield n._getOrCreateGrammarFactory();if(!o.has(e))return null;const i=n._languageService.languageIdCodec.encodeLanguageId(e),t=yield o.createGrammar(e,i);if(!t.grammar)return null;const r=function rt(h,s,e,n){return(0,de.y0)(o=>n.onDidChangeConfiguration(i=>{i.affectsConfiguration(h,{overrideIdentifier:s})&&o(i)}),()=>n.getValue(h,{overrideIdentifier:s})??e)}("editor.maxTokenizationLineLength",e,-1,n._configurationService),l=new w.Cm,d=l.add(new Oe(t.grammar,t.initialState,t.containsEmbeddedLanguages,(a,g)=>n._threadedBackgroundTokenizerFactory.createBackgroundTokenizer(a,g,r),()=>n.getAsyncTokenizationVerification(),(a,g,m)=>{n._reportTokenizationTime(a,e,t.sourceExtensionId,g,!1,m)},!0));return l.add(d.onDidEncounterLanguage(a=>{if(!n._encounteredLanguages[a]){const g=n._languageService.languageIdCodec.decodeLanguageId(a);n._encounteredLanguages[a]=!0,n._languageService.requestBasicLanguageFeatures(g)}})),new Be(i,d,l,r)}catch(o){return o.message&&o.message===K||(0,Me.dz)(o),null}})()}_updateTheme(e,n){if(!n&&this._currentTheme&&this._currentTokenColorMap&&function ot(h,s){if(!s||!h||s.length!==h.length)return!1;for(let e=s.length-1;e>=0;e--){const n=s[e],o=h[e];if(n.scope!==o.scope)return!1;const i=n.settings,t=o.settings;if(i&&t){if(i.fontStyle!==t.fontStyle||i.foreground!==t.foreground||i.background!==t.background)return!1}else if(!i||!t)return!1}return!0}(this._currentTheme.settings,e.tokenColors)&&(0,oe.aI)(this._currentTokenColorMap,e.tokenColorMap))return;this._currentTheme={name:e.label,settings:e.tokenColors},this._currentTokenColorMap=e.tokenColorMap,this._grammarFactory?.setTheme(this._currentTheme,this._currentTokenColorMap);const o=function nt(h){const s=[null];for(let e=1,n=h.length;e<n;e++)s[e]=Q.Q1.fromHex(h[e]);return s}(this._currentTokenColorMap),i=(0,Ee.nh)(o);this._styleElement.textContent=i,P.dG.setColorMap(o),this._currentTheme&&this._currentTokenColorMap&&this._threadedBackgroundTokenizerFactory.acceptTheme(this._currentTheme,this._currentTokenColorMap)}createTokenizer(e){var n=this;return(0,x.A)(function*(){if(!n._languageService.isRegisteredLanguageId(e))return null;const o=yield n._getOrCreateGrammarFactory();if(!o.has(e))return null;const i=n._languageService.languageIdCodec.encodeLanguageId(e),{grammar:t}=yield o.createGrammar(e,i);return t})()}_getVSCodeOniguruma(){var e=this;return this._vscodeOniguruma||(this._vscodeOniguruma=(0,x.A)(function*(){const[n,o]=yield Promise.all([c.e(577).then(c.t.bind(c,15577,19)).then(i=>i.default??i),e._loadVSCodeOnigurumaWASM()]);return yield n.loadWASM({data:o,print:i=>{e._debugModePrintFunc(i)}}),n})()),this._vscodeOniguruma}_loadVSCodeOnigurumaWASM(){return(0,x.A)(function*(){return ze.HZ?yield(yield fetch(new URL(c(6670),c.b).href)).arrayBuffer():yield fetch(H.zl.asBrowserUri(`${H.dy}/vscode-oniguruma/release/onig.wasm`).toString(!0))})()}_reportTokenizationTime(e,n,o,i,t,r){const l=t?"async":"sync";j.reportTokenizationTimeCounter[l]>50||(0===j.reportTokenizationTimeCounter[l]&&setTimeout(()=>{j.reportTokenizationTimeCounter[l]=0},36e5),j.reportTokenizationTimeCounter[l]++,this._telemetryService.publicLog2("editor.tokenizedLine",{timeMs:e,languageId:n,lineLength:i,fromWorker:t,sourceExtensionId:o,isRandomSample:r,tokenizationSetting:this.getAsyncTokenizationEnabled()?this.getAsyncTokenizationVerification()?2:1:0}))}};ue=j=(0,p.C)([(0,p.Q)(0,re.L),(0,p.Q)(1,Se.t),(0,p.Q)(2,pe.j),(0,p.Q)(3,ae.O),(0,p.Q)(4,Ie.r),(0,p.Q)(5,se.p),(0,p.Q)(6,Pe.G),(0,p.Q)(7,De.P),(0,p.Q)(8,ke._Y),(0,p.Q)(9,Te.k)],ue);var st=c(63630),at=c(25207),dt=c(23849),ct=c(97026),D=c(85195),Ce=c(29647);const E=(0,D.FZ)(),lt=Y.g1.registerExtensionPoint({extensionPoint:"semanticTokenTypes",jsonSchema:{description:(0,f.kg)(12775,"Contributes semantic token types."),type:"array",items:{type:"object",properties:{id:{type:"string",description:(0,f.kg)(12776,"The identifier of the semantic token type"),pattern:D.GE,patternErrorMessage:(0,f.kg)(12777,"Identifiers should be in the form letterOrDigit[_-letterOrDigit]*")},superType:{type:"string",description:(0,f.kg)(12778,"The super type of the semantic token type"),pattern:D.GE,patternErrorMessage:(0,f.kg)(12779,"Super types should be in the form letterOrDigit[_-letterOrDigit]*")},description:{type:"string",description:(0,f.kg)(12780,"The description of the semantic token type")}}}}}),gt=Y.g1.registerExtensionPoint({extensionPoint:"semanticTokenModifiers",jsonSchema:{description:(0,f.kg)(12781,"Contributes semantic token modifiers."),type:"array",items:{type:"object",properties:{id:{type:"string",description:(0,f.kg)(12782,"The identifier of the semantic token modifier"),pattern:D.GE,patternErrorMessage:(0,f.kg)(12783,"Identifiers should be in the form letterOrDigit[_-letterOrDigit]*")},description:{type:"string",description:(0,f.kg)(12784,"The description of the semantic token modifier")}}}}}),ut=Y.g1.registerExtensionPoint({extensionPoint:"semanticTokenScopes",jsonSchema:{description:(0,f.kg)(12785,"Contributes semantic token scope maps."),type:"array",items:{type:"object",properties:{language:{description:(0,f.kg)(12786,"Lists the languge for which the defaults are."),type:"string"},scopes:{description:(0,f.kg)(12787,"Maps a semantic token (described by semantic token selector) to one or more textMate scopes used to represent that token."),type:"object",additionalProperties:{type:"array",items:{type:"string"}}}}}}});class ht{constructor(){function s(e,n,o){if("string"!=typeof e.id||0===e.id.length)return o.error((0,f.kg)(12788,"'configuration.{0}.id' must be defined and can not be empty",n)),!1;if(!e.id.match(D.GE))return o.error((0,f.kg)(12789,"'configuration.{0}.id' must follow the pattern letterOrDigit[-_letterOrDigit]*",n)),!1;const i=e.superType;return i&&!i.match(D.GE)?(o.error((0,f.kg)(12790,"'configuration.{0}.superType' must follow the pattern letterOrDigit[-_letterOrDigit]*",n)),!1):"string"==typeof e.description&&0!==e.id.length||(o.error((0,f.kg)(12791,"'configuration.{0}.description' must be defined and can not be empty",n)),!1)}lt.setHandler((e,n)=>{for(const o of n.added){const i=o.value,t=o.collector;if(!i||!Array.isArray(i))return void t.error((0,f.kg)(12792,"'configuration.semanticTokenType' must be an array"));for(const r of i)s(r,"semanticTokenType",t)&&E.registerTokenType(r.id,r.description,r.superType)}for(const o of n.removed){const i=o.value;for(const t of i)E.deregisterTokenType(t.id)}}),gt.setHandler((e,n)=>{for(const o of n.added){const i=o.value,t=o.collector;if(!i||!Array.isArray(i))return void t.error((0,f.kg)(12793,"'configuration.semanticTokenModifier' must be an array"));for(const r of i)s(r,"semanticTokenModifier",t)&&E.registerTokenModifier(r.id,r.description)}for(const o of n.removed){const i=o.value;for(const t of i)E.deregisterTokenModifier(t.id)}}),ut.setHandler((e,n)=>{for(const o of n.added){const i=o.value,t=o.collector;if(!i||!Array.isArray(i))return void t.error((0,f.kg)(12794,"'configuration.semanticTokenScopes' must be an array"));for(const r of i)if(r.language&&"string"!=typeof r.language)t.error((0,f.kg)(12795,"'configuration.semanticTokenScopes.language' must be a string"));else if(r.scopes&&"object"==typeof r.scopes)for(const l in r.scopes){const d=r.scopes[l];if(Array.isArray(d)&&!d.some(a=>"string"!=typeof a))try{const a=E.parseTokenSelector(l,r.language);E.registerTokenStyleDefault(a,{scopesToProbe:d.map(g=>g.split(" "))})}catch{t.error((0,f.kg)(12798,"configuration.semanticTokenScopes.scopes': Problems parsing selector {0}.",l))}else t.error((0,f.kg)(12797,"'configuration.semanticTokenScopes.scopes' values must be an array of strings"))}else t.error((0,f.kg)(12796,"'configuration.semanticTokenScopes.scopes' must be defined as an object"))}for(const o of n.removed){const i=o.value;for(const t of i)for(const r in t.scopes){const l=t.scopes[r];try{const d=E.parseTokenSelector(r,t.language);E.registerTokenStyleDefault(d,{scopesToProbe:l.map(a=>a.split(" "))})}catch{}}}})}}let Z=class{static{this.ID="workbench.contrib.tokenClassificationExtensionPoint"}constructor(s){this.instantiationService=s,this.instantiationService.createInstance(ht)}};Z=(0,p.C)([(0,p.Q)(0,ke._Y)],Z),(0,Ce.tr)(Z.ID,Z,Ce.lw.BlockStartup);var ft=c(19317),mt=c(85072),pt=c.n(mt),kt=c(97825),Tt=c.n(kt),yt=c(77659),vt=c.n(yt),St=c(55056),Ct=c.n(St),Lt=c(10540),bt=c.n(Lt),xt=c(41113),wt=c.n(xt),X=c(50137),O={};O.styleTagTransform=wt(),O.setAttributes=Ct(),O.insert=vt().bind(null,"head"),O.domAPI=Tt(),O.insertStyleElement=bt(),pt()(X.A,O);const _t=X.A&&X.A.locals?X.A.locals:void 0;var T=c(64613),Le=c(3061),Mt=c(13211),be=c(21030),q=c(93034);function Et(h,s,e,n){let o=null;for(let i=h.tokenColors.length-1;i>=0;i--){const t=h.tokenColors[i];if(n&&!t.settings.foreground)continue;let r;if("string"==typeof t.scope)r=t.scope.split(/,/).map(l=>l.trim());else{if(!Array.isArray(t.scope))continue;r=t.scope}for(let l=0,d=r.length;l<d;l++){const g=new ee(r[l],t.settings);g.matches(s,e)&&g.isMoreSpecific(o)&&(o=g)}}return o}class ee{constructor(s,e){this.rawSelector=s,this.settings=e;const n=this.rawSelector.split(/ /);this.scope=n[n.length-1],this.parentScopes=n.slice(0,n.length-1)}matches(s,e){return ee._matches(this.scope,this.parentScopes,s,e)}static _cmp(s,e){if(null===s&&null===e)return 0;if(null===s)return-1;if(null===e)return 1;if(s.scope.length!==e.scope.length)return s.scope.length-e.scope.length;const n=s.parentScopes.length,o=e.parentScopes.length;if(n!==o)return n-o;for(let i=0;i<n;i++){const t=s.parentScopes[i].length,r=e.parentScopes[i].length;if(t!==r)return t-r}return 0}isMoreSpecific(s){return ee._cmp(this,s)>0}static _matchesOne(s,e){const n=s+".";return s===e||e.substring(0,n.length)===n}static _matches(s,e,n,o){if(!this._matchesOne(s,n))return!1;let i=e.length-1,t=o.length-1;for(;i>=0&&t>=0;)this._matchesOne(e[i],o[t])&&i--,t--;return-1===i}}var he,It=c(97119),At=c(15993),Pt=c(46119),Dt=c(46933);(0,ft.r)(G);const u=T.$;let R=class extends w.jG{static{he=this}static{this.ID="editor.contrib.inspectEditorTokens"}static get(e){return e.getContribution(he.ID)}constructor(e,n,o,i,t,r,l,d){super(),this._editor=e,this._textMateService=n,this._treeSitterService=o,this._themeService=t,this._languageService=i,this._notificationService=r,this._configurationService=l,this._languageFeaturesService=d,this._widget=null,this._register(this._editor.onDidChangeModel(a=>this.stop())),this._register(this._editor.onDidChangeModelLanguage(a=>this.stop())),this._register(this._editor.onKeyUp(a=>a.keyCode===Mt.DD.Escape&&this.stop()))}dispose(){this.stop(),super.dispose()}launch(){this._widget||this._editor.hasModel()&&this._editor.getModel().uri.scheme!==H.ny.vscodeNotebookCell&&(this._widget=new jt(this._editor,this._textMateService,this._treeSitterService,this._languageService,this._themeService,this._notificationService,this._configurationService,this._languageFeaturesService))}stop(){this._widget&&(this._widget.dispose(),this._widget=null)}toggle(){this._widget?this.stop():this.launch()}};function xe(h){h.length>40&&(h=h.substr(0,20)+"\u2026"+h.substr(h.length-20));let s="";for(let e=0,n=h.length;e<n;e++){const o=h.charCodeAt(e);switch(o){case Le.s.Tab:s+="\u2192";break;case Le.s.Space:s+="\xb7";break;default:s+=String.fromCharCode(o)}}return s}R=he=(0,p.C)([(0,p.Q)(1,N.S),(0,p.Q)(2,Dt.j),(0,p.Q)(3,re.L),(0,p.Q)(4,Se.t),(0,p.Q)(5,ae.O),(0,p.Q)(6,se.p),(0,p.Q)(7,Pt.u)],R);let jt=(()=>{class h extends w.jG{static{this._ID="editor.contrib.inspectEditorTokensWidget"}constructor(e,n,o,i,t,r,l,d){super(),this.allowEditorOverflow=!0,this._isDisposed=!1,this._editor=e,this._languageService=i,this._themeService=t,this._textMateService=n,this._treeSitterService=o,this._notificationService=r,this._configurationService=l,this._languageFeaturesService=d,this._model=this._editor.getModel(),this._domNode=document.createElement("div"),this._domNode.className="token-inspect-widget",this._currentRequestCancellationTokenSource=new It.Qi,this._beginCompute(this._editor.getPosition()),this._register(this._editor.onDidChangeCursorPosition(a=>this._beginCompute(this._editor.getPosition()))),this._register(t.onDidColorThemeChange(a=>this._beginCompute(this._editor.getPosition()))),this._register(l.onDidChangeConfiguration(a=>a.affectsConfiguration("editor.semanticHighlighting.enabled")&&this._beginCompute(this._editor.getPosition()))),this._editor.addContentWidget(this)}dispose(){this._isDisposed=!0,this._editor.removeContentWidget(this),this._currentRequestCancellationTokenSource.cancel(),super.dispose()}getId(){return h._ID}_beginCompute(e){const n=this._textMateService.createTokenizer(this._model.getLanguageId()),o=this._computeSemanticTokens(e),i=this._treeSitterService.getParseResult(this._model);(0,T.w_)(this._domNode),this._domNode.appendChild(document.createTextNode((0,f.kg)(5155,"Loading..."))),Promise.all([n,o]).then(([t,r])=>{this._isDisposed||(this._compute(t,r,i,e),this._domNode.style.maxWidth=`${Math.max(.66*this._editor.getLayoutInfo().width,500)}px`,this._editor.layoutContentWidget(this))},t=>{this._notificationService.warn(t),setTimeout(()=>{R.get(this._editor)?.stop()})})}_isSemanticColoringEnabled(){const e=this._configurationService.getValue(At.r,{overrideIdentifier:this._model.getLanguageId(),resource:this._model.uri})?.enabled;return"boolean"==typeof e?e:this._themeService.getColorTheme().semanticHighlighting}_compute(e,n,o,i){const t=e&&this._getTokensAtPosition(e,i),r=n&&this._getSemanticTokenAtPosition(n,i),l=o&&this._getTreeSitterTokenAtPosition(o,i);if(!t&&!r&&!l)return void(0,T.Ln)(this._domNode,"No grammar or semantic tokens available.");const d=t?.metadata,a=r?.metadata,g=r&&xe(this._model.getValueInRange(r.range)),m=t&&xe(this._model.getLineContent(i.lineNumber).substring(t.token.startIndex,t.token.endIndex)),k=g||m||"";if((0,T.Ln)(this._domNode,u("h2.tiw-token",void 0,k,u("span.tiw-token-length",void 0,`${k.length} ${1===k.length?"char":"chars"}`))),(0,T.BC)(this._domNode,u("hr.tiw-metadata-separator",{style:"clear:both"})),(0,T.BC)(this._domNode,u("table.tiw-metadata-table",void 0,u("tbody",void 0,u("tr",void 0,u("td.tiw-metadata-key",void 0,"language"),u("td.tiw-metadata-value",void 0,d?.languageId||"")),u("tr",void 0,u("td.tiw-metadata-key",void 0,"standard token type"),u("td.tiw-metadata-value",void 0,this._tokenTypeToString(d?.tokenType||v.Vy.Other))),...this._formatMetadata(a,d)))),r){(0,T.BC)(this._domNode,u("hr.tiw-metadata-separator"));const C=(0,T.BC)(this._domNode,u("table.tiw-metadata-table",void 0)),M=(0,T.BC)(C,u("tbody",void 0,u("tr",void 0,u("td.tiw-metadata-key",void 0,"semantic token type"),u("td.tiw-metadata-value",void 0,r.type))));if(r.modifiers.length&&(0,T.BC)(M,u("tr",void 0,u("td.tiw-metadata-key",void 0,"modifiers"),u("td.tiw-metadata-value",void 0,r.modifiers.join(" ")))),r.metadata){const L=["foreground","bold","italic","underline","strikethrough"],b={},_=new Array;for(const y of L)if(void 0!==r.metadata[y]){const I=this._renderTokenStyleDefinition(r.definitions[y],y),A=I.map(te=>(0,T.sb)(te)?te.outerHTML:te).join();let V=b[A];V||(b[A]=V=[],_.push([I,A])),V.push(y)}for(const[y,S]of _)(0,T.BC)(M,u("tr",void 0,u("td.tiw-metadata-key",void 0,b[S].join(", ")),u("td.tiw-metadata-value",void 0,...y)))}}if(t){const C=this._themeService.getColorTheme();(0,T.BC)(this._domNode,u("hr.tiw-metadata-separator"));const M=(0,T.BC)(this._domNode,u("table.tiw-metadata-table")),L=(0,T.BC)(M,u("tbody"));m&&m!==k&&(0,T.BC)(L,u("tr",void 0,u("td.tiw-metadata-key",void 0,"textmate token"),u("td.tiw-metadata-value",void 0,`${m} (${m.length})`)));const b=new Array;for(let S=t.token.scopes.length-1;S>=0;S--)b.push(t.token.scopes[S]),S>0&&b.push(u("br"));(0,T.BC)(L,u("tr",void 0,u("td.tiw-metadata-key",void 0,"textmate scopes"),u("td.tiw-metadata-value.tiw-metadata-scopes",void 0,...b)));const _=function zt(h,s,e=!0){for(let n=s.length-1;n>=0;n--){const o=s.slice(0,n),t=Et(h,s[n],o,e);if(t)return t}return null}(C,t.token.scopes,!1),y=r?.metadata?.foreground;if(_){if(y!==t.metadata.foreground){let S=u("code.tiw-theme-selector",void 0,_.rawSelector,u("br"),JSON.stringify(_.settings,null,"\t"));y&&(S=u("s",void 0,S)),(0,T.BC)(L,u("tr",void 0,u("td.tiw-metadata-key",void 0,"foreground"),u("td.tiw-metadata-value",void 0,S)))}}else y||(0,T.BC)(L,u("tr",void 0,u("td.tiw-metadata-key",void 0,"foreground"),u("td.tiw-metadata-value",void 0,"No theme selector")))}if(l){const C=l[l.length-1];(0,T.BC)(this._domNode,u("hr.tiw-metadata-separator"));const M=(0,T.BC)(this._domNode,u("table.tiw-metadata-table")),L=(0,T.BC)(M,u("tbody"));(0,T.BC)(L,u("tr",void 0,u("td.tiw-metadata-key",void 0,`tree-sitter token ${C.id}`),u("td.tiw-metadata-value",void 0,`${C.text}`)));const b=new Array;let _=l.length-1,y=l[_];for(;y.parent||_>0;)b.push(y.type),y=y.parent??l[--_],y&&b.push(u("br"));(0,T.BC)(L,u("tr",void 0,u("td.tiw-metadata-key",void 0,"tree-sitter tree"),u("td.tiw-metadata-value.tiw-metadata-scopes",void 0,...b)));const I=P.OB.get(this._model.getLanguageId())?.captureAtPosition(i.lineNumber,i.column,this._model);I&&I.length>0&&(0,T.BC)(L,u("tr",void 0,u("td.tiw-metadata-key",void 0,"foreground"),u("td.tiw-metadata-value",void 0,I.map(A=>A.name).join(" "))))}}_formatMetadata(e,n){const o=new Array;function i(a){const g=e?.[a]||n?.[a];if(void 0!==g){const m=e?.[a]?"tiw-metadata-semantic":"";o.push(u("tr",void 0,u("td.tiw-metadata-key",void 0,a),u(`td.tiw-metadata-value.${m}`,void 0,g)))}return g}const t=i("foreground"),r=i("background");if(t&&r){const a=Q.Q1.fromHex(r),g=Q.Q1.fromHex(t);a.isOpaque()?o.push(u("tr",void 0,u("td.tiw-metadata-key",void 0,"contrast ratio"),u("td.tiw-metadata-value",void 0,a.getContrastRatio(g.makeOpaque(a)).toFixed(2)))):o.push(u("tr",void 0,u("td.tiw-metadata-key",void 0,"Contrast ratio cannot be precise for background colors that use transparency"),u("td.tiw-metadata-value")))}const l=new Array;function d(a){let g;e&&e[a]?g=u("span.tiw-metadata-semantic",void 0,a):n&&n[a]&&(g=a),g&&(l.length&&l.push(" "),l.push(g))}return d("bold"),d("italic"),d("underline"),d("strikethrough"),l.length&&o.push(u("tr",void 0,u("td.tiw-metadata-key",void 0,"font style"),u("td.tiw-metadata-value",void 0,...l))),o}_decodeMetadata(e){const n=this._themeService.getColorTheme().tokenColorMap,o=v.xn.getLanguageId(e),i=v.xn.getTokenType(e),t=v.xn.getFontStyle(e),r=v.xn.getForeground(e),l=v.xn.getBackground(e);return{languageId:this._languageService.languageIdCodec.decodeLanguageId(o),tokenType:i,bold:!!(t&v.zz.Bold)||void 0,italic:!!(t&v.zz.Italic)||void 0,underline:!!(t&v.zz.Underline)||void 0,strikethrough:!!(t&v.zz.Strikethrough)||void 0,foreground:n[r],background:n[l]}}_tokenTypeToString(e){switch(e){case v.Vy.Other:return"Other";case v.Vy.Comment:return"Comment";case v.Vy.String:return"String";case v.Vy.RegEx:return"RegEx";default:return"??"}}_getTokensAtPosition(e,n){const o=n.lineNumber,i=this._getStateBeforeLine(e,o),t=e.tokenizeLine(this._model.getLineContent(o),i),r=e.tokenizeLine2(this._model.getLineContent(o),i);let l=0;for(let a=t.tokens.length-1;a>=0;a--)if(n.column-1>=t.tokens[a].startIndex){l=a;break}let d=0;for(let a=r.tokens.length>>>1;a>=0;a--)if(n.column-1>=r.tokens[a<<1]){d=a;break}return{token:t.tokens[l],metadata:this._decodeMetadata(r.tokens[1+(d<<1)])}}_getStateBeforeLine(e,n){let o=null;for(let i=1;i<n;i++)o=e.tokenizeLine(this._model.getLineContent(i),o).ruleStack;return o}isSemanticTokens(e){return e&&e.data}_computeSemanticTokens(e){var n=this;return(0,x.A)(function*(){if(!n._isSemanticColoringEnabled())return null;const o=n._languageFeaturesService.documentSemanticTokensProvider.ordered(n._model);if(o.length){const t=o[0],r=yield Promise.resolve(t.provideDocumentSemanticTokens(n._model,null,n._currentRequestCancellationTokenSource.token));if(n.isSemanticTokens(r))return{tokens:r,legend:t.getLegend()}}const i=n._languageFeaturesService.documentRangeSemanticTokensProvider.ordered(n._model);if(i.length){const t=i[0],r=e.lineNumber,l=new ce.Q(r,1,r,n._model.getLineMaxColumn(r)),d=yield Promise.resolve(t.provideDocumentRangeSemanticTokens(n._model,l,n._currentRequestCancellationTokenSource.token));if(n.isSemanticTokens(d))return{tokens:d,legend:t.getLegend()}}return null})()}_getSemanticTokenAtPosition(e,n){const o=e.tokens.data,i=this._model.getLanguageId();let t=0,r=0;const l=n.lineNumber-1,d=n.column-1;for(let a=0;a<o.length;a+=5){const g=o[a],m=o[a+1],k=o[a+2],L=t+g,b=0===g?r+m:m;if(l===L&&b<=d&&d<b+k){const _=e.legend.tokenTypes[o[a+3]]||"not in legend (ignored)",y=[];let S=o[a+4];for(let fe=0;S>0&&fe<e.legend.tokenModifiers.length;fe++)1&S&&y.push(e.legend.tokenModifiers[fe]),S>>=1;S>0&&y.push("not in legend (ignored)");const I=new ce.Q(L+1,b+1,L+1,b+1+k),A={},V=this._themeService.getColorTheme().tokenColorMap,B=this._themeService.getColorTheme().getTokenStyleMetadata(_,y,i,!0,A);let we;return B&&(we={languageId:void 0,tokenType:v.Vy.Other,bold:B?.bold,italic:B?.italic,underline:B?.underline,strikethrough:B?.strikethrough,foreground:V[B?.foreground||v.b1.None],background:void 0}),{type:_,modifiers:y,range:I,metadata:we,definitions:A}}t=L,r=b}return null}_walkTreeforPosition(e,n){const o=this._model.getOffsetAt(n);e.gotoFirstChild();let i=!1,t=null;do{e.currentNode.startIndex<=o&&o<e.currentNode.endIndex?(i=!0,t=e.currentNode):i=!1}while(i?e.gotoFirstChild():e.gotoNextSibling());return t}_getTreeSitterTokenAtPosition(e,n){let o=e.parseResult;if(!o?.tree)return null;const i=[];do{const t=o.tree.walk(),r=this._walkTreeforPosition(t,n);r?(i.push(r),o=e.getInjection(r.startIndex,o.languageId)):o=void 0}while(o?.tree);return i.length>0?i:null}_renderTokenStyleDefinition(e,n){const o=new Array;if(void 0===e)return o;const i=this._themeService.getColorTheme();if(Array.isArray(e)){const t={};i.resolveScopes(e,t);const r=t[n];if(r&&t.scope){const l=u("ul.tiw-metadata-values"),d=Array.isArray(r.scope)?r.scope:[String(r.scope)];for(const a of d)l.appendChild(u("li.tiw-metadata-value.tiw-metadata-scopes",void 0,a));return o.push(t.scope.join(" "),l,u("code.tiw-theme-selector",void 0,JSON.stringify(r.settings,null,"\t"))),o}return o}if(D.yS.is(e)){const t=i.getTokenStylingRuleScope(e);return"setting"===t?(o.push(`User settings: ${e.selector.id} - ${this._renderStyleProperty(e.style,n)}`),o):("theme"===t&&o.push(`Color theme: ${e.selector.id} - ${this._renderStyleProperty(e.style,n)}`),o)}{const t=i.resolveTokenStyleValue(e);return o.push(`Default: ${t?this._renderStyleProperty(t,n):""}`),o}}_renderStyleProperty(e,n){return"foreground"===n?e.foreground?Q.Q1.Format.CSS.formatHexA(e.foreground,!0):"":void 0!==e[n]?String(e[n]):""}getDomNode(){return this._domNode}getPosition(){return{position:this._editor.getPosition(),preference:[be.Qj.BELOW,be.Qj.ABOVE]}}}return h})();function Ot(){return{...(0,dt.Ay)(),[N.S.toString()]:new W.d(ue,[],!1)}}(0,q.HW)(R.ID,R,q.Hk.Lazy),(0,q.Fl)(class Nt extends q.ks{constructor(){super({id:"editor.action.inspectTMScopes",label:(0,f.aS)(5154,"Developer: Inspect Editor Tokens and Scopes"),precondition:void 0})}run(s,e){R.get(e)?.toggle()}}),(0,ct.GP)(function(){var h=(0,x.A)(function*(s){s.get(at.f).when(st.k2.Ready).then(()=>{ne.QE.get(N.S)})});return function(s){return h.apply(this,arguments)}}())},6670:($,F,c)=>{$.exports=c.p+"25dd2e6f4f6bb57b.wasm"},50137:($,F,c)=>{c.d(F,{A:()=>p});var G=c(8564),x=c.n(G),ne=c(98557),W=c.n(ne)()(x());W.push([$.id,".token-inspect-widget {\n\tz-index: 50;\n\tuser-select: text;\n\t-webkit-user-select: text;\n\tpadding: 10px;\n\tborder: 1px solid var(--vscode-editorHoverWidget-border);\n}\n.hc-black .tokens-inspect-widget, .hc-light .tokens-inspect-widget {\n\tborder-width: 2px;\n}\n.monaco-editor .token-inspect-widget {\n\tbackground-color: var(--vscode-editorHoverWidget-background);\n}\n.monaco-editor .token-inspect-widget .tiw-metadata-separator {\n\tbackground-color: var(--vscode-editorHoverWidget-border)\n}\n.tiw-token {\n\tfont-family: var(--monaco-monospace-font);\n}\n.tiw-metadata-separator {\n\theight: 1px;\n\tborder: 0;\n}\n.tiw-token-length {\n\tfont-weight: normal;\n\tfont-size: 60%;\n\tfloat: right;\n}\n.tiw-metadata-table {\n\twidth: 100%;\n}\n.tiw-metadata-value {\n\tfont-family: var(--monaco-monospace-font);\n\tword-break: break-word;\n}\n.tiw-metadata-values {\n\tlist-style: none;\n\tmax-height: 300px;\n\toverflow-y: auto;\n\tmargin-right: -10px;\n\tpadding-left: 0;\n}\n.tiw-metadata-values > .tiw-metadata-value {\n\tmargin-right: 10px;\n}\n.tiw-metadata-key {\n\twidth: 1px;\n\tmin-width: 150px;\n\tpadding-right: 10px;\n\twhite-space: nowrap;\n\tvertical-align: top;\n}\n.tiw-metadata-semantic {\n\tfont-style: italic;\n}\n.tiw-metadata-scopes {\n\tline-height: normal;\n}\n.tiw-theme-selector {\n\tfont-family: var(--monaco-monospace-font);\n}\n",""]);const p=W}}]);