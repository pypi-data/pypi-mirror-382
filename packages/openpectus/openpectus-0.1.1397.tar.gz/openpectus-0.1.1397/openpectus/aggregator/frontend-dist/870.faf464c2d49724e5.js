"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[870],{28870:(Z,D,c)=>{c.r(D),c.d(D,{default:()=>W,routes:()=>_});var m=c(11747),u=c(59640);class h{static{this.source="Dashboard"}static{this.recentRunsFilterChanged=(0,u.VP)(this.source+"Recent Runs Filter Changed",(0,u.xk)())}static{this.recentRunsInitialized=(0,u.VP)(this.source+"Recent Runs Initialized")}static{this.recentRunsLoaded=(0,u.VP)(this.source+"Recent Runs Loaded",(0,u.xk)())}}var f=c(32881),k=c(61774),b=c(7033),y=c(2857),x=c(30321),t=c(41360);let T=(()=>{class n{transform(e){if(void 0===e)return"";const s=e/1e3/60,r=s%1*60;return`${Math.floor(s).toFixed(0)}:${Math.floor(r).toFixed(0).padStart(2,"0")}`}static{this.\u0275fac=function(s){return new(s||n)}}static{this.\u0275pipe=t.EJ8({name:"formatDurationMsec",type:n,pure:!0})}}return n})();var R=c(8687);let S=(()=>{class n{transform(e){switch(e){case"ready":return"Ready";case"in_progress":return"In progress";case"not_online":return"Not online";case"error":return"Interrupted by error";case void 0:return"";default:return R.h.assertNever(e)}}static{this.\u0275fac=function(s){return new(s||n)}}static{this.\u0275pipe=t.EJ8({name:"processUnitState",type:n,pure:!0})}}return n})(),I=(()=>{class n{get backgroundColor(){const e=this.processUnit?.state.state;switch(e){case void 0:return"";case"in_progress":return"bg-emerald-700";case"ready":return"bg-sky-800";case"not_online":return"bg-gray-600";case"error":return"bg-rose-700";default:return R.h.assertNever(e)}}get statusIcon(){const e=this.processUnit?.state.state;switch(e){case void 0:return"";case"in_progress":return"codicon-play-circle";case"ready":return"codicon-pass";case"not_online":return"codicon-circle-slash";case"error":return"codicon-warning";default:return R.h.assertNever(e)}}static{this.\u0275fac=function(s){return new(s||n)}}static{this.\u0275cmp=t.VBU({type:n,selectors:[["app-process-unit-card"]],inputs:{processUnit:"processUnit"},decls:14,vars:11,consts:[[1,"rounded-md","shadow-md","cursor-pointer","bg-stone-100","hover:brightness-95"],[1,"font-semibold","text-lg"],[1,"ml-2","codicon","!text-xl",3,"ngClass"],[1,"px-5","py-4"]],template:function(s,r){1&s&&(t.j41(0,"div",0)(1,"div")(2,"div",1),t.EFF(3),t.k0s(),t.nrm(4,"div",2),t.k0s(),t.j41(5,"div",3)(6,"div"),t.EFF(7),t.nI1(8,"processUnitState"),t.k0s(),t.j41(9,"div"),t.EFF(10),t.k0s(),t.j41(11,"div"),t.EFF(12),t.nI1(13,"formatDurationMsec"),t.k0s()()()),2&s&&(t.R7$(),t.HbH("px-5 py-3 text-white rounded-t-md flex justify-between "+r.backgroundColor),t.R7$(2),t.JRh(null==r.processUnit?null:r.processUnit.name),t.R7$(),t.Y8G("ngClass",r.statusIcon),t.R7$(3),t.SpI("State: ",t.bMT(8,7,null==r.processUnit||null==r.processUnit.state?null:r.processUnit.state.state),""),t.R7$(3),t.SpI("Location: ",null==r.processUnit?null:r.processUnit.location,""),t.R7$(2),t.SpI("Runtime: ",t.bMT(13,9,null==r.processUnit?null:r.processUnit.runtime_msec),""))},dependencies:[f.YU,T,S],encapsulation:2,changeDetection:0})}}return n})();var C=c(40824);function w(n,o){if(1&n){const e=t.RV6();t.j41(0,"app-process-unit-card",3),t.bIt("click",function(){const r=t.eBV(e).$implicit,i=t.XpG();return t.Njj(i.onCardClick(r.id))}),t.k0s()}2&n&&t.Y8G("processUnit",o.$implicit)}function j(n,o){1&n&&(t.j41(0,"div",4),t.EFF(1,"No process units available"),t.k0s())}let $=(()=>{class n{constructor(e,s){this.store=e,this.router=s,this.processUnits=this.store.select(x.G.processUnits)}onCardClick(e){this.router.navigate([b.ro,y.w.processUnitUrlPart,e]).then()}static{this.\u0275fac=function(s){return new(s||n)(t.rXU(u.il),t.rXU(C.Ix))}}static{this.\u0275cmp=t.VBU({type:n,selectors:[["app-dashboard-process-units"]],decls:5,vars:6,consts:[[1,"grid","gap-6","grid-cols-1","md:grid-cols-2","lg:grid-cols-3"],[3,"processUnit","click",4,"ngFor","ngForOf"],["class","text-center",4,"ngIf"],[3,"click","processUnit"],[1,"text-center"]],template:function(s,r){if(1&s&&(t.j41(0,"div",0),t.DNE(1,w,1,1,"app-process-unit-card",1),t.nI1(2,"ngrxPush"),t.k0s(),t.DNE(3,j,2,0,"div",2),t.nI1(4,"ngrxPush")),2&s){let i;t.R7$(),t.Y8G("ngForOf",t.bMT(2,2,r.processUnits)),t.R7$(2),t.Y8G("ngIf",0===(null==(i=t.bMT(4,4,r.processUnits))?null:i.length))}},dependencies:[f.Sq,I,f.bT,k.L9],encapsulation:2,changeDetection:0})}}return n})();var g=c(91490);function A(n,o){1&n&&t.nrm(0,"span",10)}function P(n,o){1&n&&t.nrm(0,"span",11)}function G(n,o){if(1&n&&(t.qex(0),t.DNE(1,A,1,0,"span",8)(2,P,1,0,"span",9),t.bVm()),2&n){const e=t.XpG(2);t.R7$(),t.Y8G("ngIf",e.sortDir===e.TableSortDirection.Descending),t.R7$(),t.Y8G("ngIf",e.sortDir===e.TableSortDirection.Ascending)}}function N(n,o){if(1&n){const e=t.RV6();t.j41(0,"th",6),t.bIt("click",function(){const r=t.eBV(e).$implicit,i=t.XpG();return t.Njj(i.setSortByColumn(r))}),t.j41(1,"span"),t.EFF(2),t.k0s(),t.DNE(3,G,3,2,"ng-container",7),t.k0s()}if(2&n){const e=o.$implicit,s=t.XpG();t.R7$(2),t.JRh(e.header),t.R7$(),t.Y8G("ngIf",s.sortColumn===e)}}function X(n,o){if(1&n&&(t.j41(0,"td",14),t.EFF(1),t.k0s()),2&n){const e=o.$implicit,s=t.XpG().$implicit,r=t.XpG();t.R7$(),t.SpI(" ",r.format(s[e.key],e)," ")}}function M(n,o){if(1&n){const e=t.RV6();t.j41(0,"tr",12),t.bIt("click",function(){const r=t.eBV(e).$implicit,i=t.XpG();return t.Njj(i.rowClicked.emit(r))}),t.DNE(1,X,2,1,"td",13),t.k0s()}if(2&n){const e=t.XpG();t.R7$(),t.Y8G("ngForOf",e.columns)}}var a=function(n){return n.Ascending="ascending",n.Descending="descending",n}(a||{});let B=(()=>{class n{constructor(e,s){this.datePipe=e,this.cd=s,this.rowClicked=new t.bkB,this.sortDir=a.Ascending,this.TableSortDirection=a}set defaultSort(e){this.sortColumn=this.columns?.find(s=>s.key===e.columnKey),this.sortDir=e.direction}get data(){let e=this._data;return void 0!==this.filter&&(e=this.filterData(e,this.filter)),void 0!==this.sortColumn&&(e=this.sortData(e,this.sortColumn)),this.cd.markForCheck(),e}set data(e){this._data=structuredClone(e)}toDate(e){if("string"!=typeof e&&"number"!=typeof e)throw Error("Value is not Date!");return new Date(e)}format(e,s){return s.isDate?this.datePipe.transform(this.toDate(e))?.toString():void 0!==s.transform?s.transform(e):e}setSortByColumn(e){if(this.sortColumn===e)switch(this.sortDir){case a.Ascending:this.sortDir=a.Descending;break;case a.Descending:this.sortDir=a.Ascending}else this.sortColumn=e,this.sortDir=a.Ascending}sortData(e,s){const r=structuredClone(e);return r?.sort((i,d)=>{const l=i[s.key],p=d[s.key];if(s.isDate)switch(this.sortDir){case a.Ascending:return function V(n,o){const e=+(0,g.a)(n)-+(0,g.a)(o);return e<0?-1:e>0?1:e}(this.toDate(l),this.toDate(p));case a.Descending:return function E(n,o){const e=+(0,g.a)(n)-+(0,g.a)(o);return e>0?-1:e<0?1:e}(this.toDate(l),this.toDate(p))}if("string"==typeof l&&"string"==typeof p)switch(this.sortDir){case a.Ascending:return l.localeCompare(p);case a.Descending:return p.localeCompare(l)}if("number"==typeof l&&"number"==typeof p)switch(this.sortDir){case a.Ascending:return l-p;case a.Descending:return p-l}if(Array.isArray(l)&&Array.isArray(p))switch(this.sortDir){case a.Ascending:return l.toString().localeCompare(p.toString());case a.Descending:return p.toString().localeCompare(l.toString())}return 0}),r}filterData(e,s){return e?.filter(r=>this.columns?.some(i=>{const d=r[i.key];let l="";return i.isDate?l=this.datePipe.transform(this.toDate(d))??"":("number"==typeof d||"string"==typeof d||Array.isArray(d))&&(l=d.toString()),l.toUpperCase().includes(s.toUpperCase())}))}static{this.\u0275fac=function(s){return new(s||n)(t.rXU(f.vh),t.rXU(t.gRc))}}static{this.\u0275cmp=t.VBU({type:n,selectors:[["app-table"]],inputs:{columns:"columns",filter:"filter",defaultSort:"defaultSort",data:"data"},outputs:{rowClicked:"rowClicked"},decls:7,vars:2,consts:[[1,"bg-stone-100","rounded-md","shadow-lg","overflow-hidden"],[1,"w-full","table-fixed","border-collapse"],[1,"bg-slate-600","text-white","cursor-pointer","select-none"],["class","px-3 py-2",3,"click",4,"ngFor","ngForOf"],[1,"cursor-pointer"],["class","border-y last-of-type:border-none border-gray-300",3,"click",4,"ngFor","ngForOf"],[1,"px-3","py-2",3,"click"],[4,"ngIf"],["class","codicon codicon-arrow-up ml-1 -mr-5",4,"ngIf"],["class","codicon codicon-arrow-down ml-1 -mr-5",4,"ngIf"],[1,"codicon","codicon-arrow-up","ml-1","-mr-5"],[1,"codicon","codicon-arrow-down","ml-1","-mr-5"],[1,"border-y","last-of-type:border-none","border-gray-300",3,"click"],["class","text-center px-3 py-2",4,"ngFor","ngForOf"],[1,"text-center","px-3","py-2"]],template:function(s,r){1&s&&(t.j41(0,"div",0)(1,"table",1)(2,"thead")(3,"tr",2),t.DNE(4,N,4,2,"th",3),t.k0s()(),t.j41(5,"tbody",4),t.DNE(6,M,2,1,"tr",5),t.k0s()()()),2&s&&(t.R7$(4),t.Y8G("ngForOf",r.columns),t.R7$(2),t.Y8G("ngForOf",r.data))},dependencies:[f.Sq,f.bT],encapsulation:2,changeDetection:0})}}return n})();var F=c(81025);const v={name:"dashboard",reducer:(0,u.vy)({recentRunsFilter:"",recentRuns:[]},(0,u.on)(h.recentRunsFilterChanged,(n,{filter:o})=>(0,F.jM)(n,e=>{e.recentRunsFilter=o})),(0,u.on)(h.recentRunsLoaded,(n,{recentRuns:o})=>(0,F.jM)(n,e=>{e.recentRuns=o})))};class U{static{this.selectFeature=(0,u.UX)(v.name)}static{this.recentRunsFilter=(0,u.Mz)(this.selectFeature,o=>o.recentRunsFilter)}static{this.recentRuns=(0,u.Mz)(this.selectFeature,o=>o.recentRuns)}}function Y(n,o){1&n&&(t.j41(0,"div",1),t.EFF(1,"No recent runs available"),t.k0s())}let z=(()=>{class n{constructor(e,s){this.router=e,this.store=s,this.recentRunsFilter=this.store.selectSignal(U.recentRunsFilter),this.recentRuns=this.store.selectSignal(U.recentRuns),this.defaultSort={columnKey:"completed_date",direction:a.Descending},this.columns=[{header:"Unit",key:"engine_id"},{header:"Started",key:"started_date",isDate:!0},{header:"Completed",key:"completed_date",isDate:!0},{header:"Contributors",key:"contributors",transform:r=>r?.map(i=>i.name).join(", ")??""}]}ngOnInit(){this.store.dispatch(h.recentRunsInitialized())}navigateToRecentRun(e){this.router.navigate([b.ro,y.w.recentRunUrlPart,e.run_id]).then()}static{this.\u0275fac=function(s){return new(s||n)(t.rXU(C.Ix),t.rXU(u.il))}}static{this.\u0275cmp=t.VBU({type:n,selectors:[["app-recent-runs"]],decls:2,vars:5,consts:[[1,"w-full","h-96",3,"rowClicked","columns","data","defaultSort","filter"],[1,"text-center","p-2"]],template:function(s,r){1&s&&(t.j41(0,"app-table",0),t.bIt("rowClicked",function(d){return r.navigateToRecentRun(d)}),t.k0s(),t.DNE(1,Y,2,0,"div",1)),2&s&&(t.Y8G("columns",r.columns)("data",r.recentRuns())("defaultSort",r.defaultSort)("filter",r.recentRunsFilter()),t.R7$(),t.vxM(0===r.recentRuns().length?1:-1))},dependencies:[B],encapsulation:2,changeDetection:0})}}return n})(),L=(()=>{class n{constructor(e){this.store=e}filterChange(e){this.store.dispatch(h.recentRunsFilterChanged({filter:e}))}static{this.\u0275fac=function(s){return new(s||n)(t.rXU(u.il))}}static{this.\u0275cmp=t.VBU({type:n,selectors:[["app-dashboard"]],decls:11,vars:0,consts:[["filterInput",""],[1,"flex","justify-center"],[1,"flex","flex-col","max-w-5xl","mx-4","lg:mx-8"],[1,"text-xl","font-semibold","my-6","text-gray-500"],[1,"mb-6"],[1,"flex","justify-between","items-center"],["type","text","placeholder","Filter Recent Runs","size","25",1,"border-b-2","border-slate-400","p-1",3,"input"]],template:function(s,r){if(1&s){const i=t.RV6();t.j41(0,"div",1)(1,"div",2)(2,"div",3),t.EFF(3,"Process Units:"),t.k0s(),t.nrm(4,"app-dashboard-process-units",4),t.j41(5,"div",5)(6,"div",3),t.EFF(7,"Recent Runs:"),t.k0s(),t.j41(8,"input",6,0),t.bIt("input",function(){t.eBV(i);const l=t.sdS(9);return t.Njj(r.filterChange(l.value))}),t.k0s()(),t.nrm(10,"app-recent-runs"),t.k0s()()}},dependencies:[$,z],encapsulation:2,changeDetection:0})}}return n})();var H=c(25558),J=c(96354),K=c(34998);let Q=(()=>{class n{constructor(e,s){this.actions=e,this.recentRunsService=s,this.loadRecentRunsOnComponentInitialization=(0,m.EH)(()=>this.actions.pipe((0,m.gp)(h.recentRunsInitialized),(0,H.n)(()=>this.recentRunsService.getRecentRuns().pipe((0,J.T)(r=>h.recentRunsLoaded({recentRuns:r}))))))}static{this.\u0275fac=function(s){return new(s||n)(t.KVO(m.En),t.KVO(K.V1))}}static{this.\u0275prov=t.jDH({token:n,factory:n.\u0275fac})}}return n})();const _=[{path:"",component:L,providers:[(0,u.vQ)(v),(0,m.SI)(Q)]}],W=_}}]);