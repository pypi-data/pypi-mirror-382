{
    "__head_reduce": 0,
    "__last_dense": -1,
    "__using_landmark": false,
    "__seq_thresh_fa3": 0,
    "using_extend": false,
    "self_extend_scale": 36,
    "dense_layers": [0,1,2],
    "mask_refresh_interval": [32, 16, 8],
    "layers": [
        {
            "sliding_window_size": 65536,
            "second_stage_k": 4096,
            "sink_token_size": 256,
            "sa_extend_backend": "streaming",
            "scan_extend_backend": "streaming",
            "stages": [
                {
                    "stage_block_size_q":64,
                    "stage_block_stride_q":2,
                    "stage_chunk_size":64,
                    "stage_k":null,
                    "stage_stride":1
                },
                {
                    "stage_block_size_q":64,
                    "stage_block_stride_q":2,
                    "stage_chunk_size":32,
                    "stage_k":32768,
                    "stage_stride":1
                },
                {
                    "stage_block_size_q":64,
                    "stage_block_stride_q":1,
                    "stage_chunk_size":8,
                    "stage_k":8192,
                    "stage_stride":1
                }
            ]
        },
        {
            "sliding_window_size": 1024,
            "second_stage_k": 2048,
            "sink_token_size": 256,
            "sa_extend_backend": "streaming",
            "scan_extend_backend": "relative",
            "stages": [
                {
                    "stage_block_size_q":64,
                    "stage_block_stride_q":2,
                    "stage_chunk_size":64,
                    "stage_k":null,
                    "stage_stride":1
                },
                {
                    "stage_block_size_q":64,
                    "stage_block_stride_q":2,
                    "stage_chunk_size":32,
                    "stage_k":32768,
                    "stage_stride":1
                },
                {
                    "stage_block_size_q":64,
                    "stage_block_stride_q":1,
                    "stage_chunk_size":8,
                    "stage_k":8192,
                    "stage_stride":1
                }
            ]
        }
    ],
    "prefill_layers": [
        {
            "sliding_window_size": 8192,
            "second_stage_k": 4096,
            "sink_token_size": 256,
            "sa_extend_backend": "streaming",
            "scan_extend_backend": "streaming",
            "stages": [
                {
                    "stage_block_size_q":64,
                    "stage_block_stride_q":2,
                    "stage_chunk_size":64,
                    "stage_k":null,
                    "stage_stride":1
                },
                {
                    "stage_block_size_q":64,
                    "stage_block_stride_q":2,
                    "stage_chunk_size":32,
                    "stage_k":32768,
                    "stage_stride":1
                },
                {
                    "stage_block_size_q":64,
                    "stage_block_stride_q":1,
                    "stage_chunk_size":8,
                    "stage_k":8192,
                    "stage_stride":1
                }
            ]
        },
        {
            "sliding_window_size": 1024,
            "second_stage_k": 2048,
            "sink_token_size": 256,
            "sa_extend_backend": "streaming",
            "scan_extend_backend": "relative",
            "stages": [
                {
                    "stage_block_size_q":64,
                    "stage_block_stride_q":2,
                    "stage_chunk_size":64,
                    "stage_k":null,
                    "stage_stride":1
                },
                {
                    "stage_block_size_q":64,
                    "stage_block_stride_q":2,
                    "stage_chunk_size":32,
                    "stage_k":32768,
                    "stage_stride":1
                },
                {
                    "stage_block_size_q":64,
                    "stage_block_stride_q":1,
                    "stage_chunk_size":8,
                    "stage_k":8192,
                    "stage_stride":1
                }
            ]
        }
    ]
}
