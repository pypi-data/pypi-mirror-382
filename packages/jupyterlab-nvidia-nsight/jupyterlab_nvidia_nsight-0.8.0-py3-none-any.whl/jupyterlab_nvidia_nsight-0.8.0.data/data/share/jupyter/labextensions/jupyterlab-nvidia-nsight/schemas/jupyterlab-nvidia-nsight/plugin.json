{
  "jupyter.lab.shortcuts": [
    {
      "command": "jupyterlab-nvidia-nsight:profile-cells",
      "keys": ["Accel Shift Enter"],
      "selector": ".jp-Notebook-Nsight"
    }
  ],
  "title": "NVIDIA Nsight",
  "description": "jupyterlab-nvidia-nsight settings.",
  "type": "object",
  "additionalProperties": false,
  "jupyter.lab.setting-icon": "jupyterlab-nvidia-nsight:nvidia-icon",
  "properties": {
    "outDir": {
      "type": "string",
      "title": "Output directory",
      "description": "The directory where the Nsight tool reports will be saved. Default is the directory of the notebook.",
      "default": ""
    },
    "nsys": {
      "additionalProperties": false,
      "type": "object",
      "title": "Nsight Systems",
      "properties": {
        "installationPath": {
          "type": "string",
          "title": "Installation top folder",
          "description": "e.g. /opt/nvidia/nsight-systems/<version>"
        },
        "args": {
          "type": "string",
          "title": "Default arguments for 'nsys launch'"
        },
        "startArgs": {
          "type": "string",
          "title": "Default arguments for 'nsys start'"
        }
      },
      "default": {
        "installationPath": "",
        "args": "--trace=cuda,nvtx,osrt --python-sampling=true --python-backtrace=cuda --cudabacktrace=all",
        "startArgs": ""
      }
    },
    "ncu": {
      "additionalProperties": false,
      "type": "object",
      "title": "Nsight Compute",
      "properties": {
        "installationPath": {
          "type": "string",
          "title": "Installation top folder",
          "description": "e.g. /usr/local/NVIDIA-Nsight-Compute-<version>"
        },
        "args": {
          "type": "string",
          "title": "Default arguments for enabling 'ncu'"
        },
        "startArgs": {
          "type": "string",
          "title": "Default arguments for profiling with ncu"
        }
      },
      "default": {
        "installationPath": "",
        "args": "",
        "startArgs": ""
      }
    },
    "ui": {
      "additionalProperties": false,
      "type": "object",
      "title": "Nsight tools UI",
      "properties": {
        "enabled": {
          "type": "boolean",
          "title": "Enabled",
          "description": "Allows to open reports with nsys/ncu UI in a tab inside JupyterLab (requires docker)"
        },
        "host": {
          "type": "string",
          "title": "JupyterLab server address for streaming Nsight tools UI",
          "description": "Set the JupyterLab server host address for streaming Nsight tools UI. This is required when the JupyterLab server machine has multiple network interfaces."
        },
        "dockerHost": {
          "type": "string",
          "title": "Docker host address",
          "description": "Specify the address of the Docker host. This setting is applicable and required only when JupyterLab is running inside a Docker container."
        },
        "maxResolution": {
          "type": "string",
          "title": "Maximum resolution",
          "description": "Set the maximum display resolution for streaming Nsight tools UI.",
          "pattern": "^[0-9]+x[0-9]+$"
        },
        "proxyDomain": {
          "type": "string",
          "title": "Proxy domain",
          "description": "If this setting is set, the extension assumes that JupyterLab is running behind a proxy (e.g., nginx). The extension will use this domain to construct the URL to display the Nsight tools UI. See NGINX Example in https://pypi.org/project/jupyterlab-nvidia-nsight/#description"
        },
        "allowedHttpPorts": {
          "type": "string",
          "title": "Allowed HTTP ports",
          "description": "Set the ports (single port numbers or ranges, comma-separated) that are allowed to be used as http ports for displaying reports. Port numbers must be between 1024 and 65535. The default is that all ports are allowed. Example: 8080,8081-8083",
          "pattern": "^(([0-9]{1,5}(-[0-9]{1,5})?)(,([0-9]{1,5}(-[0-9]{1,5})?))*)?$"
        },
        "allowedMediaPorts": {
          "type": "string",
          "title": "Allowed media ports",
          "description": "Set the ports (single port numbers or ranges, comma-separated) that are allowed to be used as media ports for displaying reports. Port numbers must be between 1024 and 65535. The default is that all ports are allowed. Example: 49152-49154",
          "pattern": "^(([0-9]{1,5}(-[0-9]{1,5})?)(,([0-9]{1,5}(-[0-9]{1,5})?))*)?$"
        },
        "turnHost": {
          "type": "string",
          "title": "Turn server address.",
          "description": "Set the address for the TURN server. Typically required when the Jupyter server is not reachable from the client. See TURN server section in https://pypi.org/project/jupyterlab-nvidia-nsight/#description"
        },
        "turnPort": {
          "type": "integer",
          "title": "Turn port",
          "description": "Set the port for the TURN server. Default is 3478. Ignored if 'Turn server address' is not set."
        },
        "turnUsername": {
          "type": "string",
          "title": "Turn username",
          "description": "Set the username for the TURN server. Default is 'nvidia'."
        },
        "turnPassword": {
          "type": "string",
          "title": "Turn password",
          "description": "Set the password for the TURN server. Default is 'nvidia'."
        },
        "suppressServerAddressWarning": {
          "type": "boolean",
          "title": "Suppress server address warning",
          "description": "Don't show warning message when the JupyterLab server address is not set"
        },
        "defaultStreamerAddress": {
          "type": "string",
          "title": "NVIDIA Nsight Streamer default address",
          "description": "Will appear in the 'Display Nsight UI via Nsight Streamer' dialog. Use '%HOSTNAME%' to replace with the current hostname."
        }
      },
      "default": {
        "enabled": true,
        "host": "",
        "dockerHost": "",
        "maxResolution": "1920x1080",
        "proxyDomain": "",
        "allowedHttpPorts": "",
        "allowedMediaPorts": "",
        "turnHost": "",
        "turnPort": 3478,
        "turnUsername": "",
        "turnPassword": "",
        "suppressServerAddressWarning": false,
        "defaultStreamerAddress": "http://%HOSTNAME%:8080"
      }
    }
  },
  "jupyter.lab.menus": {
    "main": [
      {
        "id": "jp-mainmenu-nvidia",
        "label": "NVIDIA Nsight",
        "items": [
          {
            "command": "jupyterlab-nvidia-nsight:toggle-nsys-profile",
            "rank": 1
          },
          {
            "command": "jupyterlab-nvidia-nsight:toggle-ncu-profile",
            "rank": 1
          },
          {
            "command": "jupyterlab-nvidia-nsight:display-devtools-streamer",
            "rank": 2
          },
          {
            "type": "separator",
            "rank": 2
          },
          {
            "command": "jupyterlab-nvidia-nsight:profile-cells",
            "rank": 2
          },
          {
            "type": "separator",
            "rank": 3
          },
          {
            "command": "jupyterlab-nvidia-nsight:open-settings",
            "rank": 3
          },
          {
            "type": "separator",
            "rank": 4
          },
          {
            "command": "jupyterlab-nvidia-nsight:open-nsys-site",
            "rank": 4
          },
          {
            "command": "jupyterlab-nvidia-nsight:open-ncu-site",
            "rank": 4
          }
        ],
        "rank": 500
      }
    ],
    "context": [
      {
        "command": "jupyterlab-nvidia-nsight:open-report",
        "selector": ".jp-DirListing-item",
        "rank": 0
      }
    ]
  }
}
