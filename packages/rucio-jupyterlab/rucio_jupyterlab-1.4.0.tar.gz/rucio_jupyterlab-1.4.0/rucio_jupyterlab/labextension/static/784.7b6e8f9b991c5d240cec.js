"use strict";(self.webpackChunkrucio_jupyterlab=self.webpackChunkrucio_jupyterlab||[]).push([[784],{9252:e=>{e.exports=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;var n,s,o;if(Array.isArray(t)){if((n=t.length)!=r.length)return!1;for(s=n;0!=s--;)if(!e(t[s],r[s]))return!1;return!0}if(t instanceof Map&&r instanceof Map){if(t.size!==r.size)return!1;for(s of t.entries())if(!r.has(s[0]))return!1;for(s of t.entries())if(!e(s[1],r.get(s[0])))return!1;return!0}if(t instanceof Set&&r instanceof Set){if(t.size!==r.size)return!1;for(s of t.entries())if(!r.has(s[0]))return!1;return!0}if(ArrayBuffer.isView(t)&&ArrayBuffer.isView(r)){if((n=t.length)!=r.length)return!1;for(s=n;0!=s--;)if(t[s]!==r[s])return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((n=(o=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(s=n;0!=s--;)if(!Object.prototype.hasOwnProperty.call(r,o[s]))return!1;for(s=n;0!=s--;){var a=o[s];if(!e(t[a],r[a]))return!1}return!0}return t!=t&&r!=r}},4784:(e,t,r)=>{r.r(t),r.d(t,{EAsyncActionInjectType:()=>ze,EAsyncEndTags:()=>ve,EPostActionContext:()=>ge,InjectAsyncAction:()=>$e,InjectStoreState:()=>ye,PullstateContext:()=>Be,PullstateProvider:()=>Te,Store:()=>he,batch:()=>qe,createAsyncAction:()=>je,createAsyncActionDirect:()=>Ae,createPullstateCore:()=>Ue,errorResult:()=>Pe,registerInDevtools:()=>We,setupBatch:()=>Ke,successResult:()=>we,update:()=>pe,useInstance:()=>Fe,useLocalStore:()=>ce,useStoreState:()=>ie,useStores:()=>Le});var n=r(9252),s=r.n(n),o=r(3345),a=r.n(o);function i(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];throw Error("[Immer] minified error nr: "+e+(r.length?" "+r.map((function(e){return"'"+e+"'"})).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function c(e){return!!e&&!!e[X]}function u(e){var t;return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;var r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object||"function"==typeof r&&Function.toString.call(r)===J}(e)||Array.isArray(e)||!!e[V]||!!(null===(t=e.constructor)||void 0===t?void 0:t[V])||y(e)||v(e))}function l(e,t,r){void 0===r&&(r=!1),0===h(e)?(r?Object.keys:G)(e).forEach((function(n){r&&"symbol"==typeof n||t(n,e[n],e)})):e.forEach((function(r,n){return t(n,r,e)}))}function h(e){var t=e[X];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:y(e)?2:v(e)?3:0}function f(e,t){return 2===h(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function d(e,t){return 2===h(e)?e.get(t):e[t]}function p(e,t,r){var n=h(e);2===n?e.set(t,r):3===n?e.add(r):e[t]=r}function y(e){return W&&e instanceof Map}function v(e){return M&&e instanceof Set}function g(e){return e.o||e.t}function b(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=Q(e);delete t[X];for(var r=G(t),n=0;n<r.length;n++){var s=r[n],o=t[s];!1===o.writable&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(t[s]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[s]})}return Object.create(Object.getPrototypeOf(e),t)}function C(e,t){return void 0===t&&(t=!1),S(e)||c(e)||!u(e)||(h(e)>1&&(e.set=e.add=e.clear=e.delete=m),Object.freeze(e),t&&l(e,(function(e,t){return C(t,!0)}),!0)),e}function m(){i(2)}function S(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function _(e){var t=Y[e];return t||i(18,e),t}function O(){return z}function k(e,t){t&&(_("Patches"),e.u=[],e.s=[],e.v=t)}function w(e){P(e),e.p.forEach(R),e.p=null}function P(e){e===z&&(z=e.l)}function E(e){return z={p:[],l:z,h:e,m:!0,_:0}}function R(e){var t=e[X];0===t.i||1===t.i?t.j():t.g=!0}function A(e,t){t._=t.p.length;var r=t.p[0],n=void 0!==e&&e!==r;return t.h.O||_("ES5").S(t,e,n),n?(r[X].P&&(w(t),i(4)),u(e)&&(e=I(t,e),t.l||B(t,e)),t.u&&_("Patches").M(r[X].t,e,t.u,t.s)):e=I(t,r,[]),w(t),t.u&&t.v(t.u,t.s),e!==q?e:void 0}function I(e,t,r){if(S(t))return t;var n=t[X];if(!n)return l(t,(function(s,o){return j(e,n,t,s,o,r)}),!0),t;if(n.A!==e)return t;if(!n.P)return B(e,n.t,!0),n.t;if(!n.I){n.I=!0,n.A._--;var s=4===n.i||5===n.i?n.o=b(n.k):n.o,o=s,a=!1;3===n.i&&(o=new Set(s),s.clear(),a=!0),l(o,(function(t,o){return j(e,n,s,t,o,r,a)})),B(e,s,!1),r&&e.u&&_("Patches").N(n,r,e.u,e.s)}return n.o}function j(e,t,r,n,s,o,a){if(c(s)){var i=I(e,s,o&&t&&3!==t.i&&!f(t.R,n)?o.concat(n):void 0);if(p(r,n,i),!c(i))return;e.m=!1}else a&&r.add(s);if(u(s)&&!S(s)){if(!e.h.D&&e._<1)return;I(e,s),t&&t.A.l||B(e,s)}}function B(e,t,r){void 0===r&&(r=!1),!e.l&&e.h.D&&e.m&&C(t,r)}function T(e,t){var r=e[X];return(r?g(r):e)[t]}function D(e,t){if(t in e)for(var r=Object.getPrototypeOf(e);r;){var n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=Object.getPrototypeOf(r)}}function x(e){e.P||(e.P=!0,e.l&&x(e.l))}function H(e){e.o||(e.o=b(e.t))}function N(e,t,r){var n=y(t)?_("MapSet").F(t,r):v(t)?_("MapSet").T(t,r):e.O?function(e,t){var r=Array.isArray(e),n={i:r?1:0,A:t?t.A:O(),P:!1,I:!1,R:{},l:t,t:e,k:null,o:null,j:null,C:!1},s=n,o=Z;r&&(s=[n],o=ee);var a=Proxy.revocable(s,o),i=a.revoke,c=a.proxy;return n.k=c,n.j=i,c}(t,r):_("ES5").J(t,r);return(r?r.A:O()).p.push(n),n}function U(e){return c(e)||i(22,e),function e(t){if(!u(t))return t;var r,n=t[X],s=h(t);if(n){if(!n.P&&(n.i<4||!_("ES5").K(n)))return n.t;n.I=!0,r=L(t,s),n.I=!1}else r=L(t,s);return l(r,(function(t,s){n&&d(n.t,t)===s||p(r,t,e(s))})),3===s?new Set(r):r}(e)}function L(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return b(e)}var F,z,$="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),W="undefined"!=typeof Map,M="undefined"!=typeof Set,K="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,q=$?Symbol.for("immer-nothing"):((F={})["immer-nothing"]=!0,F),V=$?Symbol.for("immer-draftable"):"__$immer_draftable",X=$?Symbol.for("immer-state"):"__$immer_state",J=("undefined"!=typeof Symbol&&Symbol.iterator,""+Object.prototype.constructor),G="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,Q=Object.getOwnPropertyDescriptors||function(e){var t={};return G(e).forEach((function(r){t[r]=Object.getOwnPropertyDescriptor(e,r)})),t},Y={},Z={get:function(e,t){if(t===X)return e;var r=g(e);if(!f(r,t))return function(e,t,r){var n,s=D(t,r);return s?"value"in s?s.value:null===(n=s.get)||void 0===n?void 0:n.call(e.k):void 0}(e,r,t);var n=r[t];return e.I||!u(n)?n:n===T(e.t,t)?(H(e),e.o[t]=N(e.A.h,n,e)):n},has:function(e,t){return t in g(e)},ownKeys:function(e){return Reflect.ownKeys(g(e))},set:function(e,t,r){var n=D(g(e),t);if(null==n?void 0:n.set)return n.set.call(e.k,r),!0;if(!e.P){var s=T(g(e),t),o=null==s?void 0:s[X];if(o&&o.t===r)return e.o[t]=r,e.R[t]=!1,!0;if(function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}(r,s)&&(void 0!==r||f(e.t,t)))return!0;H(e),x(e)}return e.o[t]===r&&(void 0!==r||t in e.o)||Number.isNaN(r)&&Number.isNaN(e.o[t])||(e.o[t]=r,e.R[t]=!0),!0},deleteProperty:function(e,t){return void 0!==T(e.t,t)||t in e.t?(e.R[t]=!1,H(e),x(e)):delete e.R[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var r=g(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n?{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:n.enumerable,value:r[t]}:n},defineProperty:function(){i(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){i(12)}},ee={};l(Z,(function(e,t){ee[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),ee.deleteProperty=function(e,t){return ee.set.call(this,e,t,void 0)},ee.set=function(e,t,r){return Z.set.call(this,e[0],t,r,e[0])};var te=function(){function e(e){var t=this;this.O=K,this.D=!0,this.produce=function(e,r,n){if("function"==typeof e&&"function"!=typeof r){var s=r;r=e;var o=t;return function(e){var t=this;void 0===e&&(e=s);for(var n=arguments.length,a=Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=arguments[i];return o.produce(e,(function(e){var n;return(n=r).call.apply(n,[t,e].concat(a))}))}}var a;if("function"!=typeof r&&i(6),void 0!==n&&"function"!=typeof n&&i(7),u(e)){var c=E(t),l=N(t,e,void 0),h=!0;try{a=r(l),h=!1}finally{h?w(c):P(c)}return"undefined"!=typeof Promise&&a instanceof Promise?a.then((function(e){return k(c,n),A(e,c)}),(function(e){throw w(c),e})):(k(c,n),A(a,c))}if(!e||"object"!=typeof e){if(void 0===(a=r(e))&&(a=e),a===q&&(a=void 0),t.D&&C(a,!0),n){var f=[],d=[];_("Patches").M(e,a,f,d),n(f,d)}return a}i(21,e)},this.produceWithPatches=function(e,r){if("function"==typeof e)return function(r){for(var n=arguments.length,s=Array(n>1?n-1:0),o=1;o<n;o++)s[o-1]=arguments[o];return t.produceWithPatches(r,(function(t){return e.apply(void 0,[t].concat(s))}))};var n,s,o=t.produce(e,r,(function(e,t){n=e,s=t}));return"undefined"!=typeof Promise&&o instanceof Promise?o.then((function(e){return[e,n,s]})):[o,n,s]},"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze)}var t=e.prototype;return t.createDraft=function(e){u(e)||i(8),c(e)&&(e=U(e));var t=E(this),r=N(this,e,void 0);return r[X].C=!0,P(t),r},t.finishDraft=function(e,t){var r=(e&&e[X]).A;return k(r,t),A(void 0,r)},t.setAutoFreeze=function(e){this.D=e},t.setUseProxies=function(e){e&&!K&&i(20),this.O=e},t.applyPatches=function(e,t){var r;for(r=t.length-1;r>=0;r--){var n=t[r];if(0===n.path.length&&"replace"===n.op){e=n.value;break}}r>-1&&(t=t.slice(r+1));var s=_("Patches").$;return c(e)?s(e,t):this.produce(e,(function(e){return s(e,t)}))},e}(),re=new te,ne=re.produce,se=re.produceWithPatches.bind(re),oe=(re.setAutoFreeze.bind(re),re.setUseProxies.bind(re),re.applyPatches.bind(re));re.createDraft.bind(re),re.finishDraft.bind(re);const ae=ne;function ie(e,t,r){const n=(0,o.useRef)({state:void 0,initialized:!1});n.current.initialized||(n.current.state=t?t(e.getRawState()):e.getRawState(),n.current.initialized=!0);const[,a]=(0,o.useState)(0);if((0,o.useEffect)((()=>{const r={shouldUpdate:!0};function o(){if(r.shouldUpdate){const o=t?t(e.getRawState()):e.getRawState();s()(n.current.state,o)||r.shouldUpdate&&(n.current.state=o,a((e=>e+1)))}}return e._addUpdateListener(o),o(),()=>{r.shouldUpdate=!1,e._removeUpdateListener(o)}}),null!=r?r:[]),void 0!==r){const a=(0,o.useRef)(r);s()(r,a)||(n.current.state=t(e.getRawState()))}return n.current.state}function ce(e,t){const r=(0,o.useRef)();if(null==r.current&&(r.current=new he(e)),void 0!==t){const n=(0,o.useRef)(t);s()(t,n)||(r.current=new he(e))}return r.current}const ue={storeOrdinal:0,batching:!1,flushStores:{}};!function(){function e(t){if(!u(t))return t;if(Array.isArray(t))return t.map(e);if(y(t))return new Map(Array.from(t.entries()).map((function(t){return[t[0],e(t[1])]})));if(v(t))return new Set(Array.from(t).map(e));var r=Object.create(Object.getPrototypeOf(t));for(var n in t)r[n]=e(t[n]);return f(t,V)&&(r[V]=t[V]),r}function t(t){return c(t)?e(t):t}var r="add";!function(e,t){Y[e]||(Y[e]=t)}("Patches",{$:function(t,n){return n.forEach((function(n){for(var s=n.path,o=n.op,a=t,c=0;c<s.length-1;c++){var u=h(a),l=s[c];"string"!=typeof l&&"number"!=typeof l&&(l=""+l),0!==u&&1!==u||"__proto__"!==l&&"constructor"!==l||i(24),"function"==typeof a&&"prototype"===l&&i(24),"object"!=typeof(a=d(a,l))&&i(15,s.join("/"))}var f=h(a),p=e(n.value),y=s[s.length-1];switch(o){case"replace":switch(f){case 2:return a.set(y,p);case 3:i(16);default:return a[y]=p}case r:switch(f){case 1:return"-"===y?a.push(p):a.splice(y,0,p);case 2:return a.set(y,p);case 3:return a.add(p);default:return a[y]=p}case"remove":switch(f){case 1:return a.splice(y,1);case 2:return a.delete(y);case 3:return a.delete(n.value);default:return delete a[y]}default:i(17,o)}})),t},N:function(e,n,s,o){switch(e.i){case 0:case 4:case 2:return function(e,n,s,o){var a=e.t,i=e.o;l(e.R,(function(e,c){var u=d(a,e),l=d(i,e),h=c?f(a,e)?"replace":r:"remove";if(u!==l||"replace"!==h){var p=n.concat(e);s.push("remove"===h?{op:h,path:p}:{op:h,path:p,value:l}),o.push(h===r?{op:"remove",path:p}:"remove"===h?{op:r,path:p,value:t(u)}:{op:"replace",path:p,value:t(u)})}}))}(e,n,s,o);case 5:case 1:return function(e,n,s,o){var a=e.t,i=e.R,c=e.o;if(c.length<a.length){var u=[c,a];a=u[0],c=u[1];var l=[o,s];s=l[0],o=l[1]}for(var h=0;h<a.length;h++)if(i[h]&&c[h]!==a[h]){var f=n.concat([h]);s.push({op:"replace",path:f,value:t(c[h])}),o.push({op:"replace",path:f,value:t(a[h])})}for(var d=a.length;d<c.length;d++){var p=n.concat([d]);s.push({op:r,path:p,value:t(c[d])})}a.length<c.length&&o.push({op:"replace",path:n.concat(["length"]),value:a.length})}(e,n,s,o);case 3:return function(e,t,n,s){var o=e.t,a=e.o,i=0;o.forEach((function(e){if(!a.has(e)){var o=t.concat([i]);n.push({op:"remove",path:o,value:e}),s.unshift({op:r,path:o,value:e})}i++})),i=0,a.forEach((function(e){if(!o.has(e)){var a=t.concat([i]);n.push({op:r,path:a,value:e}),s.unshift({op:"remove",path:a,value:e})}i++}))}(e,n,s,o)}},M:function(e,t,r,n){r.push({op:"replace",path:[],value:t===q?void 0:t}),n.push({op:"replace",path:[],value:e})}})}();const le="~._.~";class he{constructor(e){if(this.updateListeners=[],this.ssr=!1,this.reactions=[],this.clientSubscriptions=[],this.reactionCreators=[],this.optimizedUpdateListeners={},this.optimizedUpdateListenerPaths={},this.optimizedListenerPropertyMap={},this._optListenerCount=0,this._patchListeners=[],e instanceof Function){const t=e();this.currentState=t,this.initialState=t,this.createInitialState=e}else this.currentState=e,this.initialState=e,this.createInitialState=()=>e;this.internalOrdId=ue.storeOrdinal++}_setInternalOptions({ssr:e,reactionCreators:t=[]}){this.ssr=e,this.reactionCreators=t,this.reactions=t.map((e=>e(this)))}_getReactionCreators(){return this.reactionCreators}_instantiateReactions(){this.reactions=this.reactionCreators.map((e=>e(this)))}_getInitialState(){return this.createInitialState()}_updateStateWithoutReaction(e){this.currentState=e}_updateState(e,t=[]){this.currentState=e,this.batchState=void 0;for(const e of this.reactions)t.push(...e());if(!this.ssr){for(const e of this.clientSubscriptions)e();if(t.length>0){const e=new Set;for(const r of t)if(this.optimizedListenerPropertyMap[r])for(const t of this.optimizedListenerPropertyMap[r])e.add(t);for(const t of e.values())this.optimizedUpdateListeners[t]&&this.optimizedUpdateListeners[t]()}this.updateListeners.forEach((e=>e()))}}_addUpdateListener(e){this.updateListeners.push(e)}_removeUpdateListener(e){this.updateListeners=this.updateListeners.filter((t=>t!==e))}_removeUpdateListenerOpt(e){const t=this.optimizedUpdateListenerPaths[e];for(const r of t)this.optimizedListenerPropertyMap[r]=this.optimizedListenerPropertyMap[r].filter((t=>t!==e));delete this.optimizedUpdateListenerPaths[e],delete this.optimizedUpdateListeners[e],this._optListenerCount--}listenToPatches(e){return this._patchListeners.push(e),()=>{this._patchListeners=this._patchListeners.filter((t=>t!==e))}}subscribe(e,t){if(!this.ssr){const r=function(e,t,r){let n=t(e.getRawState());return()=>{const o=e.getRawState(),a=t(o);s()(a,n)||(r(a,o,n),n=a)}}(this,e,t);return this.clientSubscriptions.push(r),()=>{this.clientSubscriptions=this.clientSubscriptions.filter((e=>e!==r))}}return()=>{console.warn("Pullstate: Subscriptions made on the server side are not registered - so therefor this call to unsubscribe does nothing.")}}createReaction(e,t,{runNow:r=!1,runNowWithSideEffects:n=!1}={}){const o=function(e,t){return r=>{let n=e(r.getRawState());return(o=!1)=>{const a=r.getRawState(),i=e(a);if(o||!s()(i,n))if(r._optListenerCount>0){const[e,s,o]=se(a,(e=>t(i,e,a,n)));if(r._updateStateWithoutReaction(e),n=i,s.length>0)return r._patchListeners.forEach((e=>e(s,o))),Object.keys(fe(s))}else{if(r._patchListeners.length>0){const[e,s,o]=se(a,(e=>t(i,e,a,n)));s.length>0&&r._patchListeners.forEach((e=>e(s,o))),r._updateStateWithoutReaction(e)}else r._updateStateWithoutReaction(ne(a,(e=>t(i,e,a,n))));n=i}return[]}}}(e,t);this.reactionCreators.push(o);const a=o(this);return this.reactions.push(a),(r||n)&&(a(!0),n&&!this.ssr&&this._updateState(this.currentState)),()=>{this.reactions=this.reactions.filter((e=>e!==a))}}getRawState(){return void 0!==this.batchState?this.batchState:this.currentState}useState(e,t){return ie(this,e,t)}useLocalCopyInitial(e){return ce(this.createInitialState,e)}useLocalCopySnapshot(e){return ce(this.currentState,e)}flushBatch(e=!1){void 0!==this.batchState?this.batchState!==this.currentState&&this._updateState(this.batchState):e||console.error("Pullstate: Trying to flush batch state which was never created or updated on"),this.batchState=void 0}update(e,t){if(ue.batching){void 0===this.batchState&&(this.batchState=this.currentState,ue.flushStores[this.internalOrdId]=this);const r="function"==typeof e,[n,s,o]=de(this.batchState,e,r);s.length>0&&(this._patchListeners.length>0||t)&&(t&&t(s,o),this._patchListeners.forEach((e=>e(s,o)))),this.batchState=n}else this.batchState=void 0,pe(this,e,t)}replace(e){this._updateState(e)}replaceFromCurrent(e){this._updateState(e(this.currentState))}applyPatches(e){!function(e,t){const r=e.getRawState(),n=oe(r,t);n!==r&&e._updateState(n,Object.keys(fe(t)))}(this,e)}}function fe(e,t={}){for(const r of e){let e;for(const n of r.path)e=e?`${e}${le}${n}`:n,t[e]=1}return t}function de(e,t,r){return r?se(e,(r=>t(r,e))):t.reduce((([e,t,r],n)=>{const s=se(e,(t=>n(t,e)));return t.push(...s[1]),r.push(...s[2]),[s[0],t,r]}),[e,[],[]])}function pe(e,t,r){const n=e.getRawState(),s="function"==typeof t;if(e._optListenerCount>0){const[o,a,i]=de(n,t,s);a.length>0&&(r&&r(a,i),e._patchListeners.forEach((e=>e(a,i))),e._updateState(o,Object.keys(fe(a))))}else{let o;if(e._patchListeners.length>0||r){const[a,i,c]=de(n,t,s);i.length>0&&(r&&r(i,c),e._patchListeners.forEach((e=>e(i,c)))),o=a}else o=ne(n,(e=>s?t(e,n):t.reduce(((e,t)=>ne(e,(r=>t(r,e)))),n)));o!==n&&e._updateState(o)}}function ye({store:e,on:t=(e=>e),children:r}){return r(ie(e,t))}var ve,ge;!function(e){e.THREW_ERROR="THREW_ERROR",e.RETURNED_ERROR="RETURNED_ERROR",e.UNFINISHED="UNFINISHED",e.DORMANT="DORMANT"}(ve||(ve={})),function(e){e.WATCH_HIT_CACHE="WATCH_HIT_CACHE",e.BECKON_HIT_CACHE="BECKON_HIT_CACHE",e.RUN_HIT_CACHE="RUN_HIT_CACHE",e.READ_HIT_CACHE="READ_HIT_CACHE",e.READ_RUN="READ_RUN",e.SHORT_CIRCUIT="SHORT_CIRCUIT",e.DIRECT_RUN="DIRECT_RUN",e.BECKON_RUN="BECKON_RUN",e.CACHE_UPDATE="CACHE_UPDATE"}(ge||(ge={}));const be={listeners:{},results:{},actions:{},actionOrd:{}};let Ce,me=0;function Se(e){if(null===e)return"(n)";const t=typeof e;if("object"!==t){if("undefined"===t)return"(u)";if("string"===t)return":"+e+";";if("boolean"===t||"number"===t)return"("+e+")"}let r="{";for(const t of Object.keys(e).sort())r+=t+Se(e[t]);return r+"}"}function _e(e){if(be.listeners.hasOwnProperty(e))for(const t of Object.keys(be.listeners[e]))be.listeners[e][t]()}function Oe(e,t=!0,r=!0){t&&be.actionOrd.hasOwnProperty(e)&&(be.actionOrd[e]+=1),delete be.results[e],r&&_e(e)}function ke(e,t){return e.actionOrd.hasOwnProperty(t)?e.actionOrd[t]+=1:e.actionOrd[t]=0,e.actionOrd[t]}function we(e=null,t=[],r=""){return{payload:e,tags:t,message:r,error:!1,errorPayload:null}}function Pe(e=[],t="",r){return{payload:null,tags:[ve.RETURNED_ERROR,...e],message:t,error:!0,errorPayload:r}}class Ee extends Error{constructor(e,t){super(e),this.tags=t}}try{Ce=new Proxy({},{get:function(e,t){throw new Error(`Pullstate: Trying to access store (${String(t)}) inside async actions without the correct usage or setup.\nIf this error occurred on the server:\n* If using run(), make use of your created instance for this request: instance.runAsyncAction()\n* If using read(), useWatch(), useBeckon() etc. - make sure you have properly set up your <PullstateProvider/>\n\nIf this error occurred on the client:\n* Make sure you have created your "pullstateCore" object with all your stores, using createPullstateCore(), and are making use of instantiate() before rendering.`)}})}catch{Ce={}}const Re=[!0,!1,{message:"",tags:[ve.UNFINISHED],error:!0,payload:null,errorPayload:null},!1,-1];function Ae(e,t={}){return je((async(t,r,n)=>we(await e(t,r,n))),t)}function Ie(e){if(null!=e)return"boolean"==typeof e?()=>e:"number"==typeof e?({timeCached:t,result:r})=>!!r.error||Date.now()-t>e:e}function je(e,{forceContext:t=!1,shortCircuitHook:r,cacheBreakHook:n,postActionHook:i,subsetKey:c,actionId:u}={}){const l=null!=u?`_${u}`:me++,h="undefined"==typeof window;function f(e,t){return null!=t?`${l}-c-${t}`:void 0!==c?`${l}-${Se(c(e))}`:`${l}-${Se(e)}`}const d=`def_wait_${f({})}`;let p={},y=0;const v={};function g(e,t,r,n){void 0!==i&&i({args:t,result:e,stores:r,context:n})}function b({args:e,cache:t,cacheBreakEnabled:r,context:s,fromListener:o,key:a,postActionEnabled:i,stores:c,customCacheBreak:u}){const l=null!=u?u:n;if(t.results.hasOwnProperty(a)){const n=p.hasOwnProperty(a)&&p[a]>2;if(!h&&!o&&r&&null!=l&&t.results[a][1]&&l({args:e,result:t.results[a][2],stores:c,timeCached:t.results[a][4]})&&!n){p.hasOwnProperty(a)?p[a]++:p[a]=1;const e=t.results[a];return delete t.results[a],{cacheBroke:!0,response:void 0,previous:e}}return n?console.error(`[${a}] Pullstate detected an infinite loop caused by cacheBreakHook()\nreturning true too often (breaking cache as soon as your action is resolving - hence\ncausing beckoned actions to run the action again) in one of your AsyncActions - Pullstate prevented\nfurther looping. Fix in your cacheBreakHook() is needed.`):p[a]=0,i&&t.results[a][1]&&!o&&g(t.results[a][2],e,c,s),{response:t.results[a],cacheBroke:!1,previous:void 0}}return{cacheBroke:!1,response:void 0,previous:void 0}}function C(t,r,n,s,o,a,i,c){return()=>e(n,s,c).then((e=>(o===r.actionOrd[t]&&(a&&g(e,n,s,i),r.results[t]=[!0,!0,e,!1,Date.now()]),e))).catch((e=>{console.error(e);const c={payload:null,errorPayload:null,error:!0,tags:[ve.THREW_ERROR],message:e.message};return o===r.actionOrd[t]&&(a&&g(c,n,s,i),r.results[t]=[!0,!0,c,!1,Date.now()]),c})).then((e=>(o===r.actionOrd[t]&&(delete r.actions[t],h||_e(t)),e)))}function m({key:e,cache:t,initiate:n,ssr:s,args:o,stores:a,fromListener:i=!1,postActionEnabled:c=!0,cacheBreakEnabled:u=!0,holdingResult:l,customContext:f,customCacheBreak:d,holdPrevious:p}){const y=b({key:e,cache:t,args:o,stores:a,context:n?ge.BECKON_HIT_CACHE:ge.WATCH_HIT_CACHE,postActionEnabled:c,cacheBreakEnabled:u,fromListener:i,customCacheBreak:d});if(y.response)return y.response;if(!t.actions.hasOwnProperty(e)){const i=ke(t,e);if(!n){const r=[!1,!1,{message:"",tags:[ve.UNFINISHED],error:!0,payload:null,errorPayload:null},!1,-1];if(h||(t.results[e]=r),p){if(l){const e=[...l];return e[3]=!0,e}if(null!=y.previous){const e=[...y.previous];return e[3]=!0,e}}return r}if(void 0!==r){const n=r({args:o,stores:a});if(!1!==n)return g(n,o,a,ge.SHORT_CIRCUIT),t.results[e]=[!0,!0,n,!1,Date.now()],t.results[e]}if(!s&&h||(t.actions[e]=C(e,t,o,a,i,c,ge.BECKON_RUN,f)),h)return Re;t.actions[e](),t.results[e]=Re}if(p){if(l){const e=[...l];return e[3]=!0,e}if(null!=y.previous){const e=[...y.previous];return e[3]=!0,e}}return Re}const S=(e={},{initiate:r=!1,ssr:n=!0,postActionEnabled:a=!1,cacheBreakEnabled:i=!1,holdPrevious:c=!1,dormant:u=!1,key:l,cacheBreak:d}={})=>{const p=(0,o.useRef)(),g=(0,o.useRef)("."),b=u?".":f(e,l);let C=(0,o.useRef)(-1);-1===C.current&&(C.current=y++),u||(v.hasOwnProperty(b)?v[b][C.current]=!0:v[b]={[C.current]:!0});const S=h?(0,o.useContext)(Be)._asyncCache:be;let _,O;if(h||t){const e=(0,o.useContext)(Be);_=e.stores,O=e.customContext}else _=xe.loaded?xe.stores:Ce;if(!h){const t=()=>{if(v[b][C.current]&&!s()(p.current,S.results[b])){const t=m({key:b,cache:S,initiate:r,ssr:n,args:e,stores:_,fromListener:!0,postActionEnabled:a,cacheBreakEnabled:i,holdingResult:void 0,customContext:O,holdPrevious:c});c&&!t[1]&&null!=p.current&&p.current[1]?(p.current=[...p.current],p.current[3]=!0):p.current=t,w((e=>e+1))}};u||(S.listeners.hasOwnProperty(b)||(S.listeners[b]={}),S.listeners[b][C.current]=t,v[b][C.current]=!0),(0,o.useEffect)((()=>(u||(S.listeners[b][C.current]=t,v[b][C.current]=!0),()=>{u||(delete S.listeners[b][C.current],v[b][C.current]=!1)})),[b])}const[k,w]=(0,o.useState)(0);return u?(p.current=c&&p.current&&p.current[1]?p.current:[!1,!1,{message:"",tags:[ve.DORMANT],error:!0,payload:null},!1,-1],g.current="."):g.current!==b&&(null!==g.current&&v.hasOwnProperty(g.current)&&(delete S.listeners[g.current][C.current],v[g.current][C.current]=!1),g.current=b,p.current=m({key:b,cache:S,initiate:r,ssr:n,args:e,stores:_,fromListener:!1,postActionEnabled:a,cacheBreakEnabled:i,holdingResult:c&&p.current&&p.current[1]?p.current:void 0,customContext:O,customCacheBreak:Ie(d),holdPrevious:c})),p.current},_=async(e={},t={})=>{const{treatAsUpdate:n=!1,ignoreShortCircuit:s=!1,respectCache:o=!1,key:a,_asyncCache:i=be,_stores:c=(xe.loaded?xe.stores:Ce),_customContext:u,cacheBreak:l}=t,h=f(e,a);if(o){const t=b({key:h,cache:i,args:e,stores:c,context:ge.RUN_HIT_CACHE,postActionEnabled:!0,cacheBreakEnabled:!0,fromListener:!1,customCacheBreak:Ie(l)});if(t.response&&t.response[0]){if(!t.response[1]){const e=y++;return i.listeners.hasOwnProperty(h)||(i.listeners[h]={}),new Promise((t=>{i.listeners[h][e]=()=>{const[,r,n]=i.results[h];r&&(delete i.listeners[h][e],t(n))}}))}return t.response[2]}}if(!s&&void 0!==r){const t=r({args:e,stores:c});if(!1!==t)return i.results[h]=[!0,!0,t,!1,Date.now()],g(t,e,c,ge.SHORT_CIRCUIT),_e(h),t}const[,d,p,v,m]=i.results[h]||[!1,!1,{error:!0,message:"",payload:null,tags:[ve.UNFINISHED]},!1,-1];i.results[h]=d&&n?[!0,!0,p,!0,m]:[!0,!1,{error:!0,message:"",payload:null,tags:[ve.UNFINISHED]},!1,-1];let S=ke(i,h);return i.actions[h]=C(h,i,e,c,S,!0,ge.DIRECT_RUN,u),_e(h),i.actions[h]()},O=(e={},{key:t,notify:r=!0}={})=>{Oe(f(e,t),!0,r)},k=(e,t,r)=>{const{notify:n=!0,key:s}=r||{},a=f(e,s);(h?(0,o.useContext)(Be)._asyncCache:be).results[a]=[!0,!0,t,!1,Date.now()],n&&_e(a)},w=(e,t,r)=>k(e,we(t),r),P=(e,t,r)=>{const{notify:n=!0,resetTimeCached:s=!0,runPostActionHook:a=!1,key:i}=r||{},c=f(e,i),u=h?(0,o.useContext)(Be)._asyncCache:be;if(u.results.hasOwnProperty(c)&&!u.results[c][2].error){const r=u.results[c][2].payload,o={payload:ae(r,(e=>t(e,r))),error:!1,message:u.results[c][2].message,tags:u.results[c][2].tags};a&&g(o,e,xe.loaded?xe.stores:Ce,ge.CACHE_UPDATE),u.results[c]=[!0,!0,o,u.results[c][3],s?Date.now():u.results[c][4]],n&&_e(c)}},E=(e={},t)=>{var r;const{checkCacheBreak:s=!1,key:a,cacheBreak:i}=t||{},c=f(e,a);let u=!1;const l=be;if(l.results.hasOwnProperty(c)){const t=null!==(r=Ie(i))&&void 0!==r?r:n;if(s&&void 0!==t){const r=h?(0,o.useContext)(Be).stores:xe.loaded?xe.stores:Ce;t({args:e,result:l.results[c][2],stores:r,timeCached:l.results[c][4]})&&(u=!0)}const[a,f,d,p,y]=l.results[c];return{started:a,finished:f,result:d,existed:!0,cacheBreakable:u,updating:p,timeCached:y}}return{started:!1,finished:!1,result:{message:"",tags:[ve.UNFINISHED],error:!0,payload:null,errorPayload:null},updating:!1,existed:!1,cacheBreakable:u,timeCached:-1}};let R;const A=(e={},{initiate:t=!0,ssr:r=!0,postActionEnabled:n,cacheBreakEnabled:s,holdPrevious:i=!1,dormant:c=!1,key:u,onSuccess:l,cacheBreak:h}={})=>{null==n&&(n=t),null==s&&(s=t);const f=S(e,{initiate:t,ssr:r,postActionEnabled:n,cacheBreakEnabled:s,holdPrevious:i,dormant:c,key:u,cacheBreak:h}),[d,p,y,v]=f,g=p&&!y.error,b=p&&y.error;return l&&(0,o.useEffect)((()=>{g&&!c&&l(y.payload,e)}),[g]),{isStarted:d,isFinished:p,isUpdating:v,isSuccess:g,isFailure:b,isLoading:d&&(!p||v),endTags:y.tags,error:y.error,payload:y.payload,errorPayload:y.errorPayload,renderPayload:e=>y.error?a().Fragment:e(y.payload),message:y.message,raw:f,execute:t=>_(e,t),clearCached:()=>O(e),setCached:(t,r)=>{k(e,t,r)},setCachedPayload:(t,r)=>{w(e,t,r)},updateCached:(t,r)=>{P(e,t,r)}}};return{use:A,useDefer:(e={})=>{const[t,r]=(0,o.useState)((()=>({key:e.key?e.key:d,args:{}}))),n=A({},{...e,key:t.key,initiate:!1}),a=(t={},r={})=>{var n,s;const o=null!==(n=e.key)&&void 0!==n?n:f(t),{checkCacheBreak:a=!0,successOnly:i=!1}=r,c=E(t,{key:o,cacheBreak:null!==(s=r.cacheBreak)&&void 0!==s?s:e.cacheBreak,checkCacheBreak:a});return!(!c.existed||a&&c.cacheBreakable||i&&c.result.error)},i=()=>{r({key:d,args:{}})},c=(n={},s)=>{var o;const a=null!==(o=e.key)&&void 0!==o?o:f(n);return a!==t.key&&r({key:a,args:n}),_(n,{...s,key:a,cacheBreak:e.cacheBreak}).then((t=>(e.clearOnSuccess&&O({},{key:a}),t)))};return{...n,clearCached:()=>{O({},{key:t.key})},unwatchExecuted:i,setCached:(e,r={})=>{r.key=t.key,k({},e,r)},setCachedPayload:(e,r={})=>{r.key=t.key,w({},e,r)},updateCached:(e,r={})=>{r.key=t.key,P({},e,r)},useDebouncedExecution:(e,t,r={})=>{if(!h){const n=(0,o.useRef)({update:!1}),u=(0,o.useRef)(void 0),l=(0,o.useRef)(-1),h=(0,o.useRef)(void 0);(0,o.useEffect)((()=>(n.current.update=!0,()=>{n.current.update=!1})),[]),null!=r.equality?"function"==typeof r.equality?(void 0===u.current||r.equality(u.current,e))&&(u.current=e,l.current+=1):u.current!==r.equality&&(u.current=r.equality,l.current+=1):s()(u.current,e)||(u.current=e,l.current+=1),(0,o.useEffect)((()=>{var s,o,u;clearTimeout(h.current);const l=()=>{var t;n.current.update&&c(e,null!==(t=r.executeOptions)&&void 0!==t?t:{respectCache:!0})};null===(o=null===(s=r.validInput)||void 0===s?void 0:s.call(r,e))||void 0===o||o?a(e)?l():h.current=setTimeout(l,t):null!==(u=r.watchLastValid)&&void 0!==u&&u||i()}),[l.current])}},hasCached:a,execute:c,args:t.args,key:t.key}},read:(e={},{cacheBreakEnabled:n=!0,postActionEnabled:s=!0,key:a}={})=>{const i=f(e,a),c=h?(0,o.useContext)(Be)._asyncCache:be;let u,l;if(h||t){const e=(0,o.useContext)(Be);u=e.stores,l=e.customContext}else u=xe.loaded?xe.stores:Ce;const d=b({key:i,cache:c,args:e,stores:u,context:ge.READ_HIT_CACHE,postActionEnabled:s,cacheBreakEnabled:n,fromListener:!1});if(d.response){if(d.response[2].error)throw new Ee(d.response[2].message,d.response[2].tags);return d.response[2].payload}if(!c.actions.hasOwnProperty(i)){if(void 0!==r){const t=r({args:e,stores:u});if(!1!==t){if(g(t,e,u,ge.SHORT_CIRCUIT),c.results[i]=[!0,!0,t,!1,Date.now()],t.error)throw new Ee(t.message,t.tags);return t.payload}}const t=ke(c,i);if(c.actions[i]=C(i,c,e,u,t,s,ge.READ_RUN,l),h)throw new Error("Pullstate Async Action: action.read() : Resolve all async state for Suspense actions before Server-side render ( make use of instance.runAsyncAction() )");throw c.actions[i]()}if(h)throw new Error("Pullstate Async Action: action.read() : Resolve all async state for Suspense actions before Server-side render ( make use of instance.runAsyncAction() )");const p=y++;throw new Promise((e=>{c.listeners[i][p]=()=>{delete c.listeners[i][p],e()}}))},useBeckon:(e={},{ssr:t=!0,postActionEnabled:r=!0,cacheBreakEnabled:n=!0,holdPrevious:s=!1,dormant:o=!1,key:a}={})=>{const i=S(e,{initiate:!0,ssr:t,postActionEnabled:r,cacheBreakEnabled:n,holdPrevious:s,dormant:o,key:a});return[i[1],i[2],i[3]]},useWatch:S,run:_,delayedRun:(e={},{clearOldRun:t=!0,delay:r,immediateIfCached:n=!0,...s})=>{if(t&&clearTimeout(R),n){const{finished:t,cacheBreakable:r}=E(e,{checkCacheBreak:!0});if(t&&!r)return _(e,s),()=>{}}let o={cancelled:!1};return R=setTimeout((()=>{o.cancelled||_(e,s)}),r),()=>{o.cancelled=!0}},clearCache:O,clearAllCache:({notify:e=!0}={})=>{for(const t of Object.keys(be.actionOrd))t.startsWith(`${l}-`)&&Oe(t,!0,e)},clearAllUnwatchedCache:({notify:e=!0}={})=>{for(const t of Object.keys(v))Object.values(v[t]).some((e=>e))||(delete v[t],Oe(t,!1,e))},getCached:E,setCached:k,setCachedPayload:w,updateCached:P}}const Be=a().createContext(null),Te=({instance:e,children:t})=>a().createElement(Be.Provider,{value:e},t);let De=null;const xe={internalClientStores:!0,loaded:!1,stores:{}};class He{constructor(e,t={}){this.options={},null!==De&&console.error("Pullstate: createPullstate() - Should not be creating the core Pullstate class more than once! In order to re-use pull state, you need to call instantiate() on your already created object."),De=this,xe.stores=e,xe.loaded=!0,this.options=t}instantiate({hydrateSnapshot:e,ssr:t=!1,customContext:r}={}){if(!t){const t=new Ne(xe.stores,!1,r);return null!=e&&t.hydrateFromSnapshot(e),t.instantiateReactions(),t}const n={};for(const r of Object.keys(xe.stores))null==e?n[r]=new he(xe.stores[r]._getInitialState()):e.hasOwnProperty(r)?n[r]=new he(e.allState[r]):(n[r]=new he(xe.stores[r]._getInitialState()),console.warn(`Pullstate (instantiate): store [${r}] didn't hydrate any state (data was non-existent on hydration object)`)),n[r]._setInternalOptions({ssr:t,reactionCreators:xe.stores[r]._getReactionCreators()});return new Ne(n,!0,r)}useStores(){return Le()}useInstance(){return Fe()}createAsyncActionDirect(e,t={}){return Ae(e,t)}createAsyncAction(e,t={}){var r;return(null===(r=this.options.asyncActions)||void 0===r?void 0:r.defaultCachingSeconds)&&!t.cacheBreakHook&&(t.cacheBreakHook=e=>e.timeCached<Date.now()-1e3*this.options.asyncActions.defaultCachingSeconds),je(e,t)}}class Ne{constructor(e,t,r){this._ssr=!1,this._stores={},this._asyncCache={listeners:{},results:{},actions:{},actionOrd:{}},this._stores=e,this._ssr=t,this._customContext=r}getAllUnresolvedAsyncActions(){return Object.keys(this._asyncCache.actions).map((e=>this._asyncCache.actions[e]()))}instantiateReactions(){for(const e of Object.keys(this._stores))this._stores[e]._instantiateReactions()}getPullstateSnapshot(){const e={};for(const t of Object.keys(this._stores))e[t]=this._stores[t].getRawState();return{allState:e,asyncResults:this._asyncCache.results,asyncActionOrd:this._asyncCache.actionOrd}}async resolveAsyncState(){const e=this.getAllUnresolvedAsyncActions();await Promise.all(e)}hasAsyncStateToResolve(){return Object.keys(this._asyncCache.actions).length>0}get stores(){return this._stores}get customContext(){return this._customContext}async runAsyncAction(e,t={},r={}){return this._ssr&&(r._asyncCache=this._asyncCache,r._stores=this._stores,r._customContext=this._customContext),await e.run(t,r)}hydrateFromSnapshot(e){for(const t of Object.keys(this._stores))e.allState.hasOwnProperty(t)?this._stores[t]._updateStateWithoutReaction(e.allState[t]):console.warn(`${t} didn't hydrate any state (data was non-existent on hydration object)`);be.results=e.asyncResults||{},be.actionOrd=e.asyncActionOrd||{}}}function Ue(e={},t={}){return new He(e,t)}function Le(){return(0,o.useContext)(Be).stores}function Fe(){return(0,o.useContext)(Be)}var ze;function $e(e){if(e.type===ze.BECKON){const t=e.action.useBeckon(e.args,e.options);return e.children(t)}const t=e.action.useWatch(e.args,e.options);return e.children(t)}function We(e,{namespace:t=""}={}){const r="undefined"!=typeof window?null===window||void 0===window?void 0:window.__REDUX_DEVTOOLS_EXTENSION__:void 0;if(r)for(const n of Object.keys(e)){const s=e[n],o=r.connect({name:`${t}${n}`});o.init(s.getRawState());let a=!1;s.subscribe((e=>e),(e=>{a?a=!1:o.send("Change",e)})),o.subscribe((e=>{if("DISPATCH"===e.type&&e.state){a=!0;const t=JSON.parse(e.state);s.replace(t)}}))}}!function(e){e.WATCH="watch",e.BECKON="beckon"}(ze||(ze={}));const Me={};function Ke({uiBatchFunction:e}){Me.uiBatchFunction=e}function qe(e){if(ue.batching)throw new Error("Pullstate: Can't enact two batch() update functions at the same time-\nmake sure you are not running a batch() inside of a batch() by mistake.");ue.batching=!0;try{e()}finally{Me.uiBatchFunction?Me.uiBatchFunction((()=>{Object.values(ue.flushStores).forEach((e=>e.flushBatch(!0)))})):Object.values(ue.flushStores).forEach((e=>e.flushBatch(!0))),ue.flushStores={},ue.batching=!1}}}}]);