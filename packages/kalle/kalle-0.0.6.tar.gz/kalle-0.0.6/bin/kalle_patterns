#!/usr/bin/env bash

# kalle
# Copyright (C) 2024-2025 Wayland Holdings, LLC


if [ -d "$HOME/Library/Application Support/kalle" ]; then
  CONFIG_ROOT="$HOME/Library/Application Support/kalle"
  DATA_ROOT="$HOME/Library/Application Support/kalle"
else
  CONFIG_ROOT="$HOME/.config/kalle"
  DATA_ROOT="$HOME/.local/share/kalle"
fi

if [ -f "$CONFIG_ROOT/config.yml" ]; then
  PATTERNS_ROOT=$(cat "$CONFIG_ROOT/config.yml" | grep "^patterns_dir" | sed "s/^patterns_dir: //")
else
  PATTERNS_ROOT=""
fi

if [ -z "$PATTERNS_ROOT" ]; then
  PATTERNS_ROOT="$DATA_ROOT/patterns"
fi

if [ -d "$PATTERNS_ROOT" ]; then
  ls -1 "$PATTERNS_ROOT" | sed "s/\.yaml$//" | sort | uniq
else
  echo ""
  exit 1
fi
