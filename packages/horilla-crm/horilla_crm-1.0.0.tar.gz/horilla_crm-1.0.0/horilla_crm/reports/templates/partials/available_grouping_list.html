{% load reports_tags i18n %}
{% for field in available_fields %}
  <div class="mb-1 flex items-center justify-between bg-dark-50 rounded-md px-1.5 py-2 text-xs font-medium w-full text-left relative">
    <span>{{ field.verbose_name|title }}</span>
    <div class="flex border border-dark-100 rounded-md">
      {% with row_count=report.row_groups_list|length %}
      {% with col_count=report.column_groups_list|length %}
      {% with total_count=row_count|add:col_count %}
        {% if total_count < 3 %}
          <button
            class="font-bold px-1.5 py-1 {% if field.name in report.row_groups_list %}text-primary-600{% else %}text-[#979797]{% endif %}"
            hx-post="{% url 'reports:toggle_row_group' report.pk %}"
            hx-vals='{"field_name": "{{ field.name }}"}'
            hx-target="#report-content"
            hx-select="#report-content"
            hx-select-oob="#nav-actions"
            hx-swap="outerHTML"
            hx-headers='{"HX-Trigger": "refreshReport"}'>
            {% trans "R" %}
          </button>
          <button
            class="font-bold px-1.5 py-1 border-l-[1px] border-r-[1px] border-dark-100 {% if field.name in report.column_groups_list %}text-primary-600{% else %}text-[#979797]{% endif %}"
            hx-post="{% url 'reports:toggle_column_group' report.pk %}"
            hx-vals='{"field_name": "{{ field.name }}"}'
            hx-target="#report-content"
            hx-select="#report-content"
            hx-select-oob="#nav-actions"
            hx-swap="outerHTML"
            hx-headers='{"HX-Trigger": "refreshReport"}'>
            {% trans "C" %}
          </button>
        {% endif %}
      {% endwith %}
      {% endwith %}
      {% endwith %}
      <button
        class="font-bold px-1.5 py-1 {% if report.aggregate_columns_dict.field == field.name %}text-primary-600{% else %}text-[#979797]{% endif %}"
        hx-post="{% url 'reports:toggle_aggregate' report.pk %}"
        hx-vals='{"field_name": "{{ field.name }}"}'
        hx-target="#report-content"
        hx-select="#report-content"
        hx-select-oob="#nav-actions"
        hx-swap="outerHTML"
        hx-headers='{"HX-Trigger": "refreshReport"}'>
        {% trans "A" %}
      </button>
    </div>
  </div>
{% empty %}
  <div class="text-center text-gray-500 py-4 text-xs">
    {% trans "No fields found matching your search" %}
  </div>
{% endfor %}
