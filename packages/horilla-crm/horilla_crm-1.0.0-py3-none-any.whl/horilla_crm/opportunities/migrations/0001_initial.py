# Generated by Django 5.2.7 on 2025-10-07 04:49

import django.core.validators
import django.db.models.deletion
import django.utils.timezone
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('accounts', '0001_initial'),
        ('campaigns', '0003_initial'),
        ('contacts', '0001_initial'),
        ('horilla_core', '0001_initial'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='BigDealAlert',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('is_active', models.BooleanField(default=True, verbose_name='Is Active')),
                ('additional_info', models.JSONField(blank=True, null=True, verbose_name='Additional info')),
                ('created_at', models.DateTimeField(default=django.utils.timezone.now, verbose_name='Created At')),
                ('updated_at', models.DateTimeField(default=django.utils.timezone.now, verbose_name='Updated At')),
                ('alert_name', models.CharField(max_length=255, verbose_name='Alert Name')),
                ('trigger_amount', models.DecimalField(decimal_places=2, default=0.0, max_digits=15, verbose_name='Trigger Amount')),
                ('trigger_probability', models.PositiveIntegerField(default=0, help_text='Trigger alert when opportunity probability reaches this percentage', verbose_name='Trigger Probability')),
                ('sender_name', models.CharField(blank=True, max_length=255, null=True, verbose_name='Sender Name')),
                ('sender_email', models.EmailField(blank=True, max_length=254, null=True, verbose_name='Sender Email')),
                ('notify_emails', models.TextField(blank=True, help_text='Comma-separated emails to notify', null=True, verbose_name='Notify Emails')),
                ('notify_cc_emails', models.TextField(blank=True, null=True, verbose_name='Notify CC Emails')),
                ('notify_bcc_emails', models.TextField(blank=True, null=True, verbose_name='Notify BCC Emails')),
                ('notify_opportunity_owner', models.BooleanField(default=False, verbose_name='Notify Opportunity Owner')),
                ('active', models.BooleanField(default=False, verbose_name='Active')),
                ('company', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='horilla_core.company', verbose_name='Company')),
                ('created_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL, verbose_name='Created By')),
                ('updated_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL, verbose_name='Updated By')),
            ],
            options={
                'verbose_name': 'Big Deal Alert',
                'verbose_name_plural': 'Big Deal Alerts',
            },
        ),
        migrations.CreateModel(
            name='OpportunityStage',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('is_active', models.BooleanField(default=True, verbose_name='Is Active')),
                ('additional_info', models.JSONField(blank=True, null=True, verbose_name='Additional info')),
                ('created_at', models.DateTimeField(default=django.utils.timezone.now, verbose_name='Created At')),
                ('updated_at', models.DateTimeField(default=django.utils.timezone.now, verbose_name='Updated At')),
                ('name', models.CharField(max_length=100, verbose_name='Stage Name')),
                ('order', models.PositiveIntegerField(help_text='Order in which stages appear', verbose_name='Order')),
                ('probability', models.DecimalField(decimal_places=2, help_text='Default probability percentage for this stage', max_digits=5, verbose_name='Probability')),
                ('is_final', models.BooleanField(default=False, verbose_name='Is Final Stage')),
                ('stage_type', models.CharField(choices=[('open', 'Open'), ('won', 'Closed Won'), ('lost', 'Closed Lost')], default='open', help_text='Type of stage - Open, Closed Won, or Closed Lost', max_length=10, verbose_name='Stage Type')),
                ('company', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='horilla_core.company', verbose_name='Company')),
                ('created_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL, verbose_name='Created By')),
                ('updated_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL, verbose_name='Updated By')),
            ],
            options={
                'verbose_name': 'Opportunity Stage',
                'verbose_name_plural': 'Opportunity Stages',
                'ordering': ['order'],
            },
        ),
        migrations.CreateModel(
            name='Opportunity',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('is_active', models.BooleanField(default=True, verbose_name='Is Active')),
                ('additional_info', models.JSONField(blank=True, null=True, verbose_name='Additional info')),
                ('created_at', models.DateTimeField(default=django.utils.timezone.now, verbose_name='Created At')),
                ('updated_at', models.DateTimeField(default=django.utils.timezone.now, verbose_name='Updated At')),
                ('name', models.CharField(help_text='Opportunity Name', max_length=120, verbose_name='Opportunity Name')),
                ('amount', models.DecimalField(blank=True, decimal_places=2, max_digits=18, null=True, verbose_name='Amount')),
                ('expected_revenue', models.DecimalField(blank=True, decimal_places=2, max_digits=18, null=True, verbose_name='Expected Revenue')),
                ('quantity', models.DecimalField(blank=True, decimal_places=2, help_text='Total Opportunity Quantity', max_digits=16, null=True, verbose_name='Quantity')),
                ('close_date', models.DateField(blank=True, null=True, verbose_name='Close Date')),
                ('probability', models.DecimalField(blank=True, decimal_places=2, help_text='Probability percentage (0-100)', max_digits=5, null=True, validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(100)], verbose_name='Probability')),
                ('description', models.TextField(blank=True, max_length=32000, verbose_name='Description')),
                ('next_step', models.CharField(blank=True, max_length=255, verbose_name='Next Step')),
                ('opportunity_score', models.IntegerField(default=0, verbose_name='Opportunity Score')),
                ('opportunity_type', models.CharField(blank=True, choices=[('existing_customer_upgrade', 'Existing Customer - Upgrade'), ('existing_customer_replacement', 'Existing Customer - Replacement'), ('existing_customer_downgrade', 'Existing Customer - Downgrade'), ('new_customer', 'New Customer')], max_length=50, verbose_name='Type')),
                ('lead_source', models.CharField(blank=True, choices=[('website', 'Website'), ('referral', 'Referral'), ('event', 'Event'), ('campaign', 'Campaign'), ('phone', 'Phone'), ('email', 'Email'), ('social media', 'Social Media'), ('partner', 'Partner'), ('other', 'Other')], max_length=50, verbose_name='Lead Source')),
                ('forecast_category', models.CharField(blank=True, choices=[('omitted', 'Omitted'), ('pipeline', 'Pipeline'), ('best_case', 'Best Case'), ('commit', 'Commit'), ('closed', 'Closed')], max_length=50, verbose_name='Forecast Category')),
                ('delivery_installation_status', models.CharField(blank=True, choices=[('yet_to_fulfill', 'Yet to Fulfill'), ('partially_delivered', 'Partially Delivered'), ('completely_delivered', 'Completely Delivered')], max_length=50, verbose_name='Delivery Installation Status')),
                ('main_competitors', models.CharField(blank=True, max_length=100, verbose_name='Main Competitors')),
                ('order_number', models.CharField(blank=True, max_length=8, verbose_name='Order Number')),
                ('tracking_number', models.CharField(blank=True, max_length=12, verbose_name='Tracking Number')),
                ('account', models.ForeignKey(blank=True, default='', null=True, on_delete=django.db.models.deletion.PROTECT, related_name='opportunity_account', to='accounts.account', verbose_name='Account')),
                ('company', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='horilla_core.company', verbose_name='Company')),
                ('created_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL, verbose_name='Created By')),
                ('opportunity_currency', models.ForeignKey(blank=True, default='', null=True, on_delete=django.db.models.deletion.PROTECT, related_name='opportunity_currency', to='horilla_core.multiplecurrency', verbose_name='Opportunity Currency')),
                ('owner', models.ForeignKey(help_text='Opportunity Owner', on_delete=django.db.models.deletion.PROTECT, to=settings.AUTH_USER_MODEL, verbose_name='Owner')),
                ('primary_campaign_source', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='opportunities', to='campaigns.campaign', verbose_name='Primary Campaign Source')),
                ('updated_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL, verbose_name='Updated By')),
                ('stage', models.ForeignKey(help_text='Current opportunity stage', on_delete=django.db.models.deletion.PROTECT, to='opportunities.opportunitystage', verbose_name='Stage')),
            ],
            options={
                'verbose_name': 'Opportunity',
                'verbose_name_plural': 'Opportunities',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='OpportunityTeam',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('is_active', models.BooleanField(default=True, verbose_name='Is Active')),
                ('additional_info', models.JSONField(blank=True, null=True, verbose_name='Additional info')),
                ('created_at', models.DateTimeField(default=django.utils.timezone.now, verbose_name='Created At')),
                ('updated_at', models.DateTimeField(default=django.utils.timezone.now, verbose_name='Updated At')),
                ('team_name', models.CharField(max_length=255, verbose_name='Team Name')),
                ('description', models.TextField(blank=True, verbose_name='Description')),
                ('company', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='horilla_core.company', verbose_name='Company')),
                ('created_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL, verbose_name='Created By')),
                ('owner', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='owner', to=settings.AUTH_USER_MODEL, verbose_name='Owner')),
                ('updated_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL, verbose_name='Updated By')),
            ],
            options={
                'verbose_name': 'Opportunity Team',
                'verbose_name_plural': 'Opportunity Teams',
            },
        ),
        migrations.CreateModel(
            name='DefaultOpportunityMember',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('is_active', models.BooleanField(default=True, verbose_name='Is Active')),
                ('additional_info', models.JSONField(blank=True, null=True, verbose_name='Additional info')),
                ('created_at', models.DateTimeField(default=django.utils.timezone.now, verbose_name='Created At')),
                ('updated_at', models.DateTimeField(default=django.utils.timezone.now, verbose_name='Updated At')),
                ('team_role', models.CharField(choices=[('account_manager', 'Account Manager'), ('channel_manager', 'Channel Manager'), ('executive_sponsor', 'Executive Sponsor'), ('lead_qualifier', 'Lead Qualifier'), ('pre_sales_consultant', 'Pre-Sales Consultant'), ('sales_manager', 'Sales Manager'), ('sales_rep', 'Sales Rep'), ('opportunity_owner', 'Opportunity Owner')], max_length=255, verbose_name='Member Role')),
                ('opportunity_access_level', models.CharField(choices=[('read', 'Read Only'), ('edit', 'Read/Write'), ('owner', 'Owner')], max_length=20, verbose_name='Access Level')),
                ('company', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='horilla_core.company', verbose_name='Company')),
                ('created_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL, verbose_name='Created By')),
                ('updated_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL, verbose_name='Updated By')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='default_opportunity_memberships', to=settings.AUTH_USER_MODEL, verbose_name='Team Member')),
                ('team', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='team_members', to='opportunities.opportunityteam', verbose_name='Team Name')),
            ],
            options={
                'verbose_name': 'Default Opportunity Member',
                'verbose_name_plural': 'Default Opportunity Members',
            },
        ),
        migrations.CreateModel(
            name='OpportunityTeamMember',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('is_active', models.BooleanField(default=True, verbose_name='Is Active')),
                ('additional_info', models.JSONField(blank=True, null=True, verbose_name='Additional info')),
                ('created_at', models.DateTimeField(default=django.utils.timezone.now, verbose_name='Created At')),
                ('updated_at', models.DateTimeField(default=django.utils.timezone.now, verbose_name='Updated At')),
                ('opportunity_access', models.CharField(choices=[('read', 'Read Only'), ('edit', 'Read/Write'), ('owner', 'Owner')], default='Read', max_length=255, verbose_name='Opportunity Access')),
                ('team_role', models.CharField(choices=[('account_manager', 'Account Manager'), ('channel_manager', 'Channel Manager'), ('executive_sponsor', 'Executive Sponsor'), ('lead_qualifier', 'Lead Qualifier'), ('pre_sales_consultant', 'Pre-Sales Consultant'), ('sales_manager', 'Sales Manager'), ('sales_rep', 'Sales Rep'), ('opportunity_owner', 'Opportunity Owner')], max_length=255, verbose_name='Member Role')),
                ('company', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='horilla_core.company', verbose_name='Company')),
                ('created_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL, verbose_name='Created By')),
                ('opportunity', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='opportunity_team_members', to='opportunities.opportunity', verbose_name='Opportunity')),
                ('updated_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL, verbose_name='Updated By')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='opportunty_team_users', to=settings.AUTH_USER_MODEL, verbose_name='Team Members')),
            ],
            options={
                'verbose_name': 'Opportunity team member',
                'verbose_name_plural': 'Opportunity team members',
            },
        ),
        migrations.CreateModel(
            name='OpportunityContactRole',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('is_active', models.BooleanField(default=True, verbose_name='Is Active')),
                ('additional_info', models.JSONField(blank=True, null=True, verbose_name='Additional info')),
                ('created_at', models.DateTimeField(default=django.utils.timezone.now, verbose_name='Created At')),
                ('updated_at', models.DateTimeField(default=django.utils.timezone.now, verbose_name='Updated At')),
                ('is_primary', models.BooleanField(default=False, verbose_name='Primary')),
                ('company', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='horilla_core.company', verbose_name='Company')),
                ('contact', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='opportunity_roles', to='contacts.contact', verbose_name='Contact')),
                ('created_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL, verbose_name='Created By')),
                ('opportunity', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='contact_roles', to='opportunities.opportunity', verbose_name='Opportunity')),
                ('role', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='opportunity_contact_roles', to='horilla_core.customerrole', verbose_name='Role')),
                ('updated_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL, verbose_name='Updated By')),
            ],
            options={
                'verbose_name': 'Opportunity Contact Role',
                'verbose_name_plural': 'Opportunity Contact Roles',
                'unique_together': {('contact', 'opportunity')},
            },
        ),
        migrations.AddConstraint(
            model_name='opportunitystage',
            constraint=models.UniqueConstraint(fields=('name', 'company'), name='unique_stage_name_per_company'),
        ),
        migrations.AddConstraint(
            model_name='opportunitystage',
            constraint=models.UniqueConstraint(fields=('order', 'company'), name='unique_stage_order_per_company'),
        ),
        migrations.AlterUniqueTogether(
            name='defaultopportunitymember',
            unique_together={('user', 'team')},
        ),
    ]
