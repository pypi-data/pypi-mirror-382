[project]
name = "spreadsheet-handling"
description = "Composable pipelines for spreadsheets (JSON/YAML/CSV/XLSX) with FK helpers, validation, and IO routing."
readme = "README.md"
requires-python = ">=3.10"
license = { file = "LICENSE" }
authors = [{ name = "Stefan Schade" }]
classifiers = [
  "Programming Language :: Python :: 3",
  "Operating System :: OS Independent",
]
dynamic = ["version"]

dependencies = [
  "pandas>=2.0",
  "openpyxl>=3.1",
  "XlsxWriter>=3.0",
  "pyyaml>=6",
]

[project.optional-dependencies]
dev = [
  "pytest>=8",
  "pytest-cov>=5",
  "ruff>=0.4",
  "black>=24",
  "autopep8>=2",
]
ods = ["odfpy>=1.4.1"]

[project.scripts]
sheets-run    = "spreadsheet_handling.cli.run:main"
sheets-pack   = "spreadsheet_handling.cli.sheets_pack:main"
sheets-unpack = "spreadsheet_handling.cli.sheets_unpack:main"

[project.urls]
Homepage = "https://github.com/StefanSchade/spreadsheet-handling"
Issues   = "https://github.com/StefanSchade/spreadsheet-handling/issues"

[build-system]
requires = ["setuptools>=68", "setuptools-scm>=8", "wheel"]
build-backend = "setuptools.build_meta"

[tool.setuptools]
license-files = ["LICENSE"]
package-dir = {"" = "src"}

[tool.setuptools.packages.find]
where = ["src"]
include = ["spreadsheet_handling*"]
exclude = ["tests*", "tmp*", "target*", "data*"]

[tool.setuptools_scm]
version_scheme = "guess-next-dev"
local_scheme   = "node-and-date"
write_to       = "src/spreadsheet_handling/_version.py"
fallback_version = "0.0.0"

# ---- Tool-Konfigurationen ----

[tool.black]
line-length = 100
target-version = ["py310"]

[tool.ruff]
line-length = 100
target-version = "py310"
exclude = [".venv", "build", "dist"]

[tool.ruff.lint]
# Basis-Regeln (PEP8-Fehler & Name/Import)
select = ["E", "F"]
# Black-kompatible Ausnahmen
ignore = ["E203", "E266", "E501"]

[tool.pytest.ini_options]
testpaths = ["tests"]
addopts = "-q -m 'not integ and not legacy'"
markers = [
  "integ: integration tests touching real IO",
  "legacy: legacy test suite",
  "slow: potentially slow tests"
]

[tool.coverage.run]
branch = true
source = ["src/spreadsheet_handling"]
omit = [
  "*/tests/*",
  "*/__init__.py",
  "*/_version.py",
  "*/core/refs.py",
  "*/io_backends/ods_backend.py"
]

[tool.coverage.report]
show_missing = true
skip_covered = true
