= SH-004: Sheetweise Konfiguration (Per-Sheet Overrides)
:status: Proposed
:owner: Core lib team
:priority: Medium
:target_version: 0.1.0bX
:created: 2025-09-26

== Context
Workbooks enthalten heterogene Blätter: einige sind reine Dimensionstabellen (Variablenkatalog), andere Matrix-/Regelblätter. Nutzer benötigen Overrides pro Blatt (z. B. AutoFilter, Spalten-Typen, Pflichtfelder).

== Goals
*G1.* Möglichkeit, pro Blatt Konfigurationen zu setzen, die globale Defaults überschreiben.

== Acceptance Criteria
- AC1: YAML/Config-Schema:
----
sheets:
variables:
excel:
auto_filter: true
schema:
required: ["id","name"]
unique: ["id"]
rules_matrix:
transforms:
- factory: "…make_crosstab_to_xref_step"
args: {...}
----

- AC2: Runner wendet per-Sheet Konfigs in sinnvoller Reihenfolge an (Schema-Prüfungen vor Transforms; Excel-Optionen beim Persist).
- AC3: Klarer Fehler, wenn referenziertes Blatt fehlt.

== Tests
- Unit: Konfig-Dispatch (Overrides schlagen durch).
- Integration: Kleines Workbook mit 2 Blättern; eines mit spezieller Transform, eines nur mit AutoFilter.
