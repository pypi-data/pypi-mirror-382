= SH-002: Excel Export — AutoFilter in Headerzeilen
:status: Proposed
:owner: Core lib team
:priority: High
:target_version: 0.1.0bX
:created: 2025-09-26

== Context
Anwender möchten beim Pack/Export (Frames → XLSX) automatisch Excel-Filter auf jeder erzeugten Tabelle haben, um sofort filtern/suchen zu können. Momentan werden Filter nicht gesetzt.

== Goals
*G1.* Optionale Aktivierung pro Export: AutoFilter über dem gesamten genutzten Bereich eines Sheets.
*G2.* Konfigurierbar global (Profile) und je Sheet override-bar.

== Non-Goals
- Keine bedingte Formatierung, keine Freeze-Panes in diesem Item (kann Folge-Item sein).

== Acceptance Criteria
- AC1: Neue Option `excel.auto_filter: true|false` (Default: false) auf Runner-/Export-Ebene.
- AC2: Bei `true` setzt der Export auf jedem Blatt `AutoFilter` für den Datenbereich (Headerzeile + Daten).
- AC3: Sheetweise Override möglich: `sheets.<name>.auto_filter: true|false` überschreibt globalen Default.
- AC4: Dokumentation + Beispiel (Screenshot nicht nötig, aber CLI/YAML-Beispiel).
- AC5: Funktioniert mit openpyxl- sowie xlsxwriter-basiertem Export (mindestens eines verbindlich; das andere mit TODO/Warnung versehen, falls nicht sofort machbar).

== Notes (Implementation)
- openpyxl: `ws.auto_filter.ref = ws.dimensions`.
- xlsxwriter: `worksheet.autofilter(first_row, first_col, last_row, last_col)`.

== Tests
- Unit: Workbook im Temp-File öffnen, pro Blatt prüfen, dass AutoFilter gesetzt ist.
- Integration: Pack eines Demo-Framesets mit 2 Blättern; beide mit gesetztem Filter.


